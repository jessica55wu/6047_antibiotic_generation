Fold 0
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': '../../../swansonk/chemprop_ckpt/0406_inhibition_hyperopt.json',
 'cuda': True,
 'data_path': '../../broad2/larger_dataset/0405_inhibition_dedup_binary.csv',
 'dataset_type': 'classification',
 'depth': 5,
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['../../saved_features/0405_broad_inhibition.npz'],
 'features_scaling': False,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 1600,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'no_cache': False,
 'num_folds': 20,
 'num_lrs': 1,
 'quiet': True,
 'save_dir': '../ckpt/0405_broad_inhibition_20folds/fold_0',
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'test': False,
 'test_fold_index': None,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': ['../../saved_features/0405_broad_inhibition.npz'],
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Class sizes
50uM_Inhibition 0: 91.93%, 1: 8.07%
Total size = 2,949 | train size = 2,654 | val size = 295 | test size = 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1600, bias=False)
      (W_h): Linear(in_features=1600, out_features=1600, bias=False)
      (W_o): Linear(in_features=1733, out_features=1600, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,571,401
Moving model to cuda
Epoch 0
Loss = 8.9383e-03, PNorm = 59.4830, GNorm = 0.6105, lr_0 = 1.8491e-04
Loss = 6.0795e-03, PNorm = 59.4997, GNorm = 0.9036, lr_0 = 2.6981e-04
Loss = 5.8315e-03, PNorm = 59.5171, GNorm = 0.5733, lr_0 = 3.5472e-04
Loss = 5.0569e-03, PNorm = 59.5360, GNorm = 0.7659, lr_0 = 4.3962e-04
Loss = 5.1442e-03, PNorm = 59.5626, GNorm = 1.7341, lr_0 = 5.2453e-04
Validation auc = 0.822410
Epoch 1
Loss = 4.1459e-03, PNorm = 59.5959, GNorm = 0.4142, lr_0 = 6.0943e-04
Loss = 5.7717e-03, PNorm = 59.6416, GNorm = 0.3380, lr_0 = 6.9434e-04
Loss = 5.3716e-03, PNorm = 59.6947, GNorm = 0.5287, lr_0 = 7.7925e-04
Loss = 5.1606e-03, PNorm = 59.7722, GNorm = 0.5908, lr_0 = 8.6415e-04
Loss = 6.0251e-03, PNorm = 59.8601, GNorm = 1.7437, lr_0 = 9.4906e-04
Validation auc = 0.861093
Epoch 2
Loss = 5.7948e-03, PNorm = 59.9800, GNorm = 0.4175, lr_0 = 9.9381e-04
Loss = 5.3673e-03, PNorm = 60.1013, GNorm = 0.5703, lr_0 = 9.7851e-04
Loss = 4.8496e-03, PNorm = 60.1914, GNorm = 0.3541, lr_0 = 9.6345e-04
Loss = 5.0573e-03, PNorm = 60.2755, GNorm = 0.3829, lr_0 = 9.4861e-04
Loss = 4.3521e-03, PNorm = 60.3461, GNorm = 0.5384, lr_0 = 9.3401e-04
Validation auc = 0.882673
Epoch 3
Loss = 4.1411e-03, PNorm = 60.4023, GNorm = 0.3415, lr_0 = 9.1963e-04
Loss = 4.5552e-03, PNorm = 60.4936, GNorm = 0.3024, lr_0 = 9.0547e-04
Loss = 3.8854e-03, PNorm = 60.5838, GNorm = 0.4198, lr_0 = 8.9153e-04
Loss = 3.5659e-03, PNorm = 60.6656, GNorm = 0.3477, lr_0 = 8.7780e-04
Loss = 4.0118e-03, PNorm = 60.7568, GNorm = 0.8031, lr_0 = 8.6429e-04
Loss = 4.5455e-03, PNorm = 60.8419, GNorm = 2.1867, lr_0 = 8.5098e-04
Validation auc = 0.892263
Epoch 4
Loss = 3.5923e-03, PNorm = 60.9361, GNorm = 0.8518, lr_0 = 8.3788e-04
Loss = 3.9196e-03, PNorm = 61.0362, GNorm = 0.6620, lr_0 = 8.2498e-04
Loss = 4.1834e-03, PNorm = 61.1315, GNorm = 0.2590, lr_0 = 8.1228e-04
Loss = 3.8812e-03, PNorm = 61.2535, GNorm = 1.4066, lr_0 = 7.9977e-04
Loss = 3.6099e-03, PNorm = 61.3438, GNorm = 0.6062, lr_0 = 7.8746e-04
Validation auc = 0.889066
Epoch 5
Loss = 5.2812e-03, PNorm = 61.4366, GNorm = 1.3157, lr_0 = 7.7533e-04
Loss = 3.2477e-03, PNorm = 61.5392, GNorm = 0.2820, lr_0 = 7.6340e-04
Loss = 3.1102e-03, PNorm = 61.6267, GNorm = 0.7623, lr_0 = 7.5164e-04
Loss = 3.2118e-03, PNorm = 61.6930, GNorm = 0.6435, lr_0 = 7.4007e-04
Loss = 3.8195e-03, PNorm = 61.7682, GNorm = 0.3973, lr_0 = 7.2867e-04
Validation auc = 0.910326
Epoch 6
Loss = 2.6172e-03, PNorm = 61.8687, GNorm = 0.2380, lr_0 = 7.1746e-04
Loss = 3.0531e-03, PNorm = 61.9565, GNorm = 0.3438, lr_0 = 7.0641e-04
Loss = 3.6368e-03, PNorm = 62.0356, GNorm = 1.2110, lr_0 = 6.9553e-04
Loss = 2.6136e-03, PNorm = 62.1140, GNorm = 0.4269, lr_0 = 6.8482e-04
Loss = 3.3962e-03, PNorm = 62.1845, GNorm = 0.9610, lr_0 = 6.7428e-04
Loss = 3.0941e-03, PNorm = 62.2447, GNorm = 0.4734, lr_0 = 6.6390e-04
Validation auc = 0.913523
Epoch 7
Loss = 2.8825e-03, PNorm = 62.3365, GNorm = 0.2679, lr_0 = 6.5368e-04
Loss = 2.6789e-03, PNorm = 62.4246, GNorm = 0.5439, lr_0 = 6.4361e-04
Loss = 2.5365e-03, PNorm = 62.4935, GNorm = 0.2071, lr_0 = 6.3370e-04
Loss = 3.0989e-03, PNorm = 62.5663, GNorm = 0.4060, lr_0 = 6.2395e-04
Loss = 2.6695e-03, PNorm = 62.6457, GNorm = 0.5716, lr_0 = 6.1434e-04
Validation auc = 0.924872
Epoch 8
Loss = 1.9193e-03, PNorm = 62.7355, GNorm = 0.3066, lr_0 = 6.0488e-04
Loss = 3.3637e-03, PNorm = 62.8136, GNorm = 0.3076, lr_0 = 5.9557e-04
Loss = 1.9808e-03, PNorm = 62.9004, GNorm = 0.4671, lr_0 = 5.8640e-04
Loss = 2.1128e-03, PNorm = 62.9634, GNorm = 0.2206, lr_0 = 5.7737e-04
Loss = 3.5450e-03, PNorm = 63.0165, GNorm = 0.8262, lr_0 = 5.6848e-04
Validation auc = 0.926630
Epoch 9
Loss = 2.7767e-03, PNorm = 63.0863, GNorm = 0.5575, lr_0 = 5.5973e-04
Loss = 2.6080e-03, PNorm = 63.1463, GNorm = 0.4931, lr_0 = 5.5111e-04
Loss = 2.9081e-03, PNorm = 63.2031, GNorm = 0.4510, lr_0 = 5.4263e-04
Loss = 2.1529e-03, PNorm = 63.2764, GNorm = 0.4592, lr_0 = 5.3427e-04
Loss = 1.9219e-03, PNorm = 63.3542, GNorm = 0.4997, lr_0 = 5.2605e-04
Loss = 3.4701e-03, PNorm = 63.4210, GNorm = 0.5229, lr_0 = 5.1795e-04
Validation auc = 0.940857
Epoch 10
Loss = 2.8280e-03, PNorm = 63.4921, GNorm = 0.6819, lr_0 = 5.0997e-04
Loss = 2.1798e-03, PNorm = 63.5736, GNorm = 0.4157, lr_0 = 5.0212e-04
Loss = 2.1593e-03, PNorm = 63.6394, GNorm = 0.3781, lr_0 = 4.9439e-04
Loss = 1.8825e-03, PNorm = 63.6908, GNorm = 0.7572, lr_0 = 4.8678e-04
Loss = 2.0348e-03, PNorm = 63.7446, GNorm = 0.3397, lr_0 = 4.7928e-04
Validation auc = 0.945173
Epoch 11
Loss = 1.9598e-03, PNorm = 63.7976, GNorm = 1.4419, lr_0 = 4.7190e-04
Loss = 2.0306e-03, PNorm = 63.8545, GNorm = 0.4970, lr_0 = 4.6464e-04
Loss = 1.8144e-03, PNorm = 63.9069, GNorm = 0.7397, lr_0 = 4.5749e-04
Loss = 1.9054e-03, PNorm = 63.9635, GNorm = 0.7090, lr_0 = 4.5044e-04
Loss = 2.6405e-03, PNorm = 64.0090, GNorm = 0.5463, lr_0 = 4.4351e-04
Validation auc = 0.949808
Epoch 12
Loss = 1.0148e-03, PNorm = 64.0671, GNorm = 0.5879, lr_0 = 4.3668e-04
Loss = 2.5672e-03, PNorm = 64.1228, GNorm = 0.4505, lr_0 = 4.2996e-04
Loss = 2.3000e-03, PNorm = 64.1821, GNorm = 1.1122, lr_0 = 4.2334e-04
Loss = 1.9348e-03, PNorm = 64.2365, GNorm = 0.2806, lr_0 = 4.1682e-04
Loss = 1.3710e-03, PNorm = 64.2847, GNorm = 0.2417, lr_0 = 4.1040e-04
Validation auc = 0.956362
Epoch 13
Loss = 3.7927e-03, PNorm = 64.3185, GNorm = 0.6962, lr_0 = 4.0408e-04
Loss = 1.4194e-03, PNorm = 64.3753, GNorm = 0.4291, lr_0 = 3.9786e-04
Loss = 1.6307e-03, PNorm = 64.4165, GNorm = 0.5793, lr_0 = 3.9173e-04
Loss = 1.5157e-03, PNorm = 64.4631, GNorm = 0.6074, lr_0 = 3.8570e-04
Loss = 1.8449e-03, PNorm = 64.5118, GNorm = 0.4879, lr_0 = 3.7976e-04
Loss = 2.1228e-03, PNorm = 64.5735, GNorm = 0.8665, lr_0 = 3.7392e-04
Validation auc = 0.954284
Epoch 14
Loss = 1.9932e-03, PNorm = 64.6218, GNorm = 0.3127, lr_0 = 3.6816e-04
Loss = 1.3498e-03, PNorm = 64.6799, GNorm = 0.2170, lr_0 = 3.6249e-04
Loss = 1.6749e-03, PNorm = 64.7224, GNorm = 0.2511, lr_0 = 3.5691e-04
Loss = 1.4728e-03, PNorm = 64.7587, GNorm = 0.7982, lr_0 = 3.5142e-04
Loss = 2.4416e-03, PNorm = 64.8068, GNorm = 0.8460, lr_0 = 3.4601e-04
Validation auc = 0.955882
Epoch 15
Loss = 2.0136e-03, PNorm = 64.8501, GNorm = 0.4231, lr_0 = 3.4068e-04
Loss = 1.2361e-03, PNorm = 64.9024, GNorm = 0.2272, lr_0 = 3.3543e-04
Loss = 1.7124e-03, PNorm = 64.9395, GNorm = 0.7834, lr_0 = 3.3027e-04
Loss = 1.9801e-03, PNorm = 64.9774, GNorm = 0.4824, lr_0 = 3.2518e-04
Loss = 9.4481e-04, PNorm = 65.0257, GNorm = 0.5718, lr_0 = 3.2018e-04
Validation auc = 0.961957
Epoch 16
Loss = 1.0321e-03, PNorm = 65.0563, GNorm = 0.3182, lr_0 = 3.1525e-04
Loss = 1.2076e-03, PNorm = 65.1034, GNorm = 0.6904, lr_0 = 3.1039e-04
Loss = 1.7982e-03, PNorm = 65.1457, GNorm = 0.8839, lr_0 = 3.0562e-04
Loss = 1.1639e-03, PNorm = 65.1903, GNorm = 0.5617, lr_0 = 3.0091e-04
Loss = 1.1265e-03, PNorm = 65.2294, GNorm = 1.0936, lr_0 = 2.9628e-04
Loss = 2.0940e-03, PNorm = 65.2657, GNorm = 0.3651, lr_0 = 2.9172e-04
Validation auc = 0.955083
Epoch 17
Loss = 2.0877e-03, PNorm = 65.2949, GNorm = 0.6916, lr_0 = 2.8722e-04
Loss = 1.2890e-03, PNorm = 65.3461, GNorm = 0.8528, lr_0 = 2.8280e-04
Loss = 1.6758e-03, PNorm = 65.3766, GNorm = 0.9401, lr_0 = 2.7845e-04
Loss = 1.5132e-03, PNorm = 65.4116, GNorm = 0.5798, lr_0 = 2.7416e-04
Loss = 1.0326e-03, PNorm = 65.4447, GNorm = 0.1173, lr_0 = 2.6994e-04
Validation auc = 0.953964
Epoch 18
Loss = 1.2853e-03, PNorm = 65.4800, GNorm = 0.8180, lr_0 = 2.6578e-04
Loss = 1.2697e-03, PNorm = 65.5199, GNorm = 0.5300, lr_0 = 2.6169e-04
Loss = 1.3731e-03, PNorm = 65.5507, GNorm = 0.4449, lr_0 = 2.5766e-04
Loss = 1.0110e-03, PNorm = 65.5798, GNorm = 1.0479, lr_0 = 2.5370e-04
Loss = 1.5504e-03, PNorm = 65.6037, GNorm = 0.8165, lr_0 = 2.4979e-04
Validation auc = 0.957641
Epoch 19
Loss = 8.9494e-04, PNorm = 65.6283, GNorm = 0.6695, lr_0 = 2.4594e-04
Loss = 1.4680e-03, PNorm = 65.6565, GNorm = 0.7774, lr_0 = 2.4216e-04
Loss = 1.1752e-03, PNorm = 65.6793, GNorm = 0.6918, lr_0 = 2.3843e-04
Loss = 1.2355e-03, PNorm = 65.7101, GNorm = 0.6022, lr_0 = 2.3476e-04
Loss = 1.2658e-03, PNorm = 65.7314, GNorm = 0.7397, lr_0 = 2.3114e-04
Loss = 1.0033e-03, PNorm = 65.7546, GNorm = 0.2580, lr_0 = 2.2758e-04
Validation auc = 0.954124
Epoch 20
Loss = 1.2891e-03, PNorm = 65.7742, GNorm = 0.5867, lr_0 = 2.2408e-04
Loss = 1.1356e-03, PNorm = 65.7990, GNorm = 1.2743, lr_0 = 2.2063e-04
Loss = 1.2697e-03, PNorm = 65.8227, GNorm = 0.6264, lr_0 = 2.1723e-04
Loss = 1.0064e-03, PNorm = 65.8588, GNorm = 0.8417, lr_0 = 2.1389e-04
Loss = 9.8529e-04, PNorm = 65.8709, GNorm = 1.6355, lr_0 = 2.1060e-04
Validation auc = 0.961317
Epoch 21
Loss = 1.2975e-03, PNorm = 65.8996, GNorm = 0.3341, lr_0 = 2.0735e-04
Loss = 1.5423e-03, PNorm = 65.9096, GNorm = 0.8953, lr_0 = 2.0416e-04
Loss = 1.1874e-03, PNorm = 65.9494, GNorm = 0.1371, lr_0 = 2.0102e-04
Loss = 1.3380e-03, PNorm = 65.9660, GNorm = 0.8935, lr_0 = 1.9792e-04
Loss = 8.1203e-04, PNorm = 65.9848, GNorm = 0.1160, lr_0 = 1.9488e-04
Validation auc = 0.960038
Epoch 22
Loss = 5.7012e-04, PNorm = 66.0026, GNorm = 0.2035, lr_0 = 1.9188e-04
Loss = 1.1460e-03, PNorm = 66.0225, GNorm = 0.6700, lr_0 = 1.8892e-04
Loss = 1.1439e-03, PNorm = 66.0399, GNorm = 0.9010, lr_0 = 1.8601e-04
Loss = 8.7856e-04, PNorm = 66.0555, GNorm = 0.3785, lr_0 = 1.8315e-04
Loss = 9.3059e-04, PNorm = 66.0813, GNorm = 0.3956, lr_0 = 1.8033e-04
Validation auc = 0.957801
Epoch 23
Loss = 5.0958e-04, PNorm = 66.0954, GNorm = 0.4561, lr_0 = 1.7755e-04
Loss = 9.8147e-04, PNorm = 66.1157, GNorm = 0.3366, lr_0 = 1.7482e-04
Loss = 1.2064e-03, PNorm = 66.1268, GNorm = 0.6339, lr_0 = 1.7213e-04
Loss = 1.0895e-03, PNorm = 66.1520, GNorm = 0.2508, lr_0 = 1.6948e-04
Loss = 8.6241e-04, PNorm = 66.1645, GNorm = 0.2606, lr_0 = 1.6687e-04
Loss = 1.0518e-03, PNorm = 66.1812, GNorm = 0.7023, lr_0 = 1.6430e-04
Validation auc = 0.957481
Epoch 24
Loss = 9.9591e-04, PNorm = 66.1893, GNorm = 0.4072, lr_0 = 1.6177e-04
Loss = 9.8506e-04, PNorm = 66.2083, GNorm = 0.0754, lr_0 = 1.5928e-04
Loss = 8.3981e-04, PNorm = 66.2227, GNorm = 0.6782, lr_0 = 1.5683e-04
Loss = 8.8004e-04, PNorm = 66.2350, GNorm = 0.8531, lr_0 = 1.5441e-04
Loss = 7.2120e-04, PNorm = 66.2615, GNorm = 0.8096, lr_0 = 1.5203e-04
Validation auc = 0.947410
Epoch 25
Loss = 4.5435e-04, PNorm = 66.2729, GNorm = 0.2893, lr_0 = 1.4969e-04
Loss = 1.0527e-03, PNorm = 66.2848, GNorm = 0.3679, lr_0 = 1.4739e-04
Loss = 8.7156e-04, PNorm = 66.3020, GNorm = 0.8502, lr_0 = 1.4512e-04
Loss = 5.0194e-04, PNorm = 66.3142, GNorm = 0.2254, lr_0 = 1.4288e-04
Loss = 8.2722e-04, PNorm = 66.3245, GNorm = 0.5635, lr_0 = 1.4069e-04
Validation auc = 0.953325
Epoch 26
Loss = 8.4055e-04, PNorm = 66.3390, GNorm = 0.6898, lr_0 = 1.3852e-04
Loss = 7.5857e-04, PNorm = 66.3479, GNorm = 0.3245, lr_0 = 1.3639e-04
Loss = 6.6468e-04, PNorm = 66.3599, GNorm = 0.1690, lr_0 = 1.3429e-04
Loss = 6.7659e-04, PNorm = 66.3706, GNorm = 0.1201, lr_0 = 1.3222e-04
Loss = 9.4364e-04, PNorm = 66.3778, GNorm = 0.2543, lr_0 = 1.3018e-04
Loss = 9.6513e-04, PNorm = 66.3892, GNorm = 0.3597, lr_0 = 1.2818e-04
Validation auc = 0.947730
Epoch 27
Loss = 7.9975e-04, PNorm = 66.4041, GNorm = 0.3717, lr_0 = 1.2621e-04
Loss = 9.1059e-04, PNorm = 66.4107, GNorm = 0.5259, lr_0 = 1.2426e-04
Loss = 9.0471e-04, PNorm = 66.4275, GNorm = 0.5019, lr_0 = 1.2235e-04
Loss = 7.6013e-04, PNorm = 66.4337, GNorm = 0.3295, lr_0 = 1.2047e-04
Loss = 9.0605e-04, PNorm = 66.4460, GNorm = 0.7101, lr_0 = 1.1861e-04
Validation auc = 0.949169
Epoch 28
Loss = 1.1396e-03, PNorm = 66.4565, GNorm = 0.2746, lr_0 = 1.1678e-04
Loss = 7.8899e-04, PNorm = 66.4699, GNorm = 0.1514, lr_0 = 1.1499e-04
Loss = 7.3870e-04, PNorm = 66.4820, GNorm = 0.2888, lr_0 = 1.1322e-04
Loss = 8.7735e-04, PNorm = 66.4965, GNorm = 0.3760, lr_0 = 1.1147e-04
Loss = 4.5710e-04, PNorm = 66.5022, GNorm = 0.3578, lr_0 = 1.0976e-04
Validation auc = 0.948210
Epoch 29
Loss = 1.8657e-03, PNorm = 66.5087, GNorm = 0.8207, lr_0 = 1.0807e-04
Loss = 6.2942e-04, PNorm = 66.5169, GNorm = 0.4604, lr_0 = 1.0640e-04
Loss = 5.0836e-04, PNorm = 66.5268, GNorm = 0.5620, lr_0 = 1.0476e-04
Loss = 9.6989e-04, PNorm = 66.5343, GNorm = 0.7881, lr_0 = 1.0315e-04
Loss = 3.9580e-04, PNorm = 66.5433, GNorm = 0.0853, lr_0 = 1.0156e-04
Loss = 7.4413e-04, PNorm = 66.5514, GNorm = 0.0925, lr_0 = 1.0000e-04
Validation auc = 0.944054
Model 0 best validation auc = 0.961957 on epoch 15
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test auc = nan
Ensemble test auc = nan
Fold 1
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': '../../../swansonk/chemprop_ckpt/0406_inhibition_hyperopt.json',
 'cuda': True,
 'data_path': '../../broad2/larger_dataset/0405_inhibition_dedup_binary.csv',
 'dataset_type': 'classification',
 'depth': 5,
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_dim': 200,
 'features_generator': None,
 'features_only': False,
 'features_path': ['../../saved_features/0405_broad_inhibition.npz'],
 'features_scaling': False,
 'features_size': 200,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 1600,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'no_cache': False,
 'num_folds': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'output_size': 1,
 'quiet': True,
 'save_dir': '../ckpt/0405_broad_inhibition_20folds/fold_1',
 'save_smiles_splits': False,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'task_names': ['50uM_Inhibition'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 2654,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': ['../../saved_features/0405_broad_inhibition.npz'],
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Class sizes
50uM_Inhibition 0: 91.93%, 1: 8.07%
Total size = 2,949 | train size = 2,654 | val size = 295 | test size = 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1600, bias=False)
      (W_h): Linear(in_features=1600, out_features=1600, bias=False)
      (W_o): Linear(in_features=1733, out_features=1600, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,571,401
Moving model to cuda
Epoch 0
Loss = 8.8915e-03, PNorm = 59.4624, GNorm = 2.4267, lr_0 = 1.8491e-04
Loss = 5.5653e-03, PNorm = 59.4790, GNorm = 1.0680, lr_0 = 2.6981e-04
Loss = 6.1634e-03, PNorm = 59.4977, GNorm = 0.6530, lr_0 = 3.5472e-04
Loss = 5.9610e-03, PNorm = 59.5182, GNorm = 0.4076, lr_0 = 4.3962e-04
Loss = 4.7697e-03, PNorm = 59.5427, GNorm = 0.8842, lr_0 = 5.2453e-04
Validation auc = 0.822878
Epoch 1
Loss = 4.9686e-03, PNorm = 59.5760, GNorm = 0.5827, lr_0 = 6.0943e-04
Loss = 5.7521e-03, PNorm = 59.6247, GNorm = 1.1602, lr_0 = 6.9434e-04
Loss = 5.5183e-03, PNorm = 59.6899, GNorm = 0.5938, lr_0 = 7.7925e-04
Loss = 4.8781e-03, PNorm = 59.7605, GNorm = 1.3701, lr_0 = 8.6415e-04
Loss = 5.2426e-03, PNorm = 59.8397, GNorm = 0.6002, lr_0 = 9.4906e-04
Validation auc = 0.743389
Epoch 2
Loss = 5.3579e-03, PNorm = 59.9316, GNorm = 1.0875, lr_0 = 9.9381e-04
Loss = 4.7677e-03, PNorm = 60.0340, GNorm = 1.7416, lr_0 = 9.7851e-04
Loss = 4.7328e-03, PNorm = 60.1290, GNorm = 0.9751, lr_0 = 9.6345e-04
Loss = 4.5220e-03, PNorm = 60.2294, GNorm = 0.5332, lr_0 = 9.4861e-04
Loss = 3.4808e-03, PNorm = 60.3317, GNorm = 1.2375, lr_0 = 9.3401e-04
Validation auc = 0.794127
Epoch 3
Loss = 4.8428e-03, PNorm = 60.4165, GNorm = 1.8280, lr_0 = 9.1963e-04
Loss = 3.7098e-03, PNorm = 60.5228, GNorm = 0.4263, lr_0 = 9.0547e-04
Loss = 4.1102e-03, PNorm = 60.6117, GNorm = 0.4074, lr_0 = 8.9153e-04
Loss = 3.0430e-03, PNorm = 60.7127, GNorm = 0.3575, lr_0 = 8.7780e-04
Loss = 4.3031e-03, PNorm = 60.7695, GNorm = 0.3179, lr_0 = 8.6429e-04
Loss = 5.0259e-03, PNorm = 60.8472, GNorm = 0.3952, lr_0 = 8.5098e-04
Validation auc = 0.848401
Epoch 4
Loss = 4.2533e-03, PNorm = 60.9345, GNorm = 0.5079, lr_0 = 8.3788e-04
Loss = 3.6142e-03, PNorm = 61.0282, GNorm = 0.4224, lr_0 = 8.2498e-04
Loss = 3.6976e-03, PNorm = 61.1070, GNorm = 0.4230, lr_0 = 8.1228e-04
Loss = 3.4364e-03, PNorm = 61.1838, GNorm = 1.2036, lr_0 = 7.9977e-04
Loss = 3.3547e-03, PNorm = 61.2605, GNorm = 0.5079, lr_0 = 7.8746e-04
Validation auc = 0.886224
Epoch 5
Loss = 2.6767e-03, PNorm = 61.3431, GNorm = 0.4228, lr_0 = 7.7533e-04
Loss = 3.5993e-03, PNorm = 61.4137, GNorm = 0.4038, lr_0 = 7.6340e-04
Loss = 3.4516e-03, PNorm = 61.5254, GNorm = 0.9305, lr_0 = 7.5164e-04
Loss = 3.0205e-03, PNorm = 61.6345, GNorm = 0.2460, lr_0 = 7.4007e-04
Loss = 3.3031e-03, PNorm = 61.7091, GNorm = 0.3788, lr_0 = 7.2867e-04
Validation auc = 0.894219
Epoch 6
Loss = 1.6216e-03, PNorm = 61.7894, GNorm = 0.7519, lr_0 = 7.1746e-04
Loss = 2.7382e-03, PNorm = 61.8624, GNorm = 0.6609, lr_0 = 7.0641e-04
Loss = 2.9910e-03, PNorm = 61.9553, GNorm = 0.4088, lr_0 = 6.9553e-04
Loss = 2.9400e-03, PNorm = 62.0462, GNorm = 0.5460, lr_0 = 6.8482e-04
Loss = 2.8584e-03, PNorm = 62.1248, GNorm = 0.7637, lr_0 = 6.7428e-04
Loss = 3.7474e-03, PNorm = 62.1887, GNorm = 0.5591, lr_0 = 6.6390e-04
Validation auc = 0.904213
Epoch 7
Loss = 2.9914e-03, PNorm = 62.2683, GNorm = 0.9270, lr_0 = 6.5368e-04
Loss = 2.7315e-03, PNorm = 62.3478, GNorm = 0.6801, lr_0 = 6.4361e-04
Loss = 2.1575e-03, PNorm = 62.4258, GNorm = 0.5523, lr_0 = 6.3370e-04
Loss = 3.6041e-03, PNorm = 62.5169, GNorm = 0.8949, lr_0 = 6.2395e-04
Loss = 3.4295e-03, PNorm = 62.6314, GNorm = 0.6133, lr_0 = 6.1434e-04
Validation auc = 0.903905
Epoch 8
Loss = 2.6314e-03, PNorm = 62.7385, GNorm = 0.5464, lr_0 = 6.0488e-04
Loss = 2.7975e-03, PNorm = 62.8400, GNorm = 0.7118, lr_0 = 5.9557e-04
Loss = 3.0519e-03, PNorm = 62.9190, GNorm = 1.1346, lr_0 = 5.8640e-04
Loss = 2.3627e-03, PNorm = 62.9966, GNorm = 1.1166, lr_0 = 5.7737e-04
Loss = 2.0386e-03, PNorm = 63.0592, GNorm = 0.4813, lr_0 = 5.6848e-04
Validation auc = 0.906212
Epoch 9
Loss = 2.4168e-03, PNorm = 63.1232, GNorm = 0.6252, lr_0 = 5.5973e-04
Loss = 2.5437e-03, PNorm = 63.2030, GNorm = 0.7343, lr_0 = 5.5111e-04
Loss = 2.6148e-03, PNorm = 63.2637, GNorm = 0.5624, lr_0 = 5.4263e-04
Loss = 3.1709e-03, PNorm = 63.3126, GNorm = 0.5411, lr_0 = 5.3427e-04
Loss = 2.1158e-03, PNorm = 63.3876, GNorm = 0.5766, lr_0 = 5.2605e-04
Loss = 1.9286e-03, PNorm = 63.4628, GNorm = 0.3475, lr_0 = 5.1795e-04
Validation auc = 0.920510
Epoch 10
Loss = 2.4361e-03, PNorm = 63.5285, GNorm = 0.4244, lr_0 = 5.0997e-04
Loss = 1.8189e-03, PNorm = 63.5930, GNorm = 0.5287, lr_0 = 5.0212e-04
Loss = 2.7558e-03, PNorm = 63.6410, GNorm = 0.6782, lr_0 = 4.9439e-04
Loss = 1.8862e-03, PNorm = 63.7059, GNorm = 0.9262, lr_0 = 4.8678e-04
Loss = 1.9404e-03, PNorm = 63.7514, GNorm = 0.2423, lr_0 = 4.7928e-04
Validation auc = 0.924815
Epoch 11
Loss = 2.0171e-03, PNorm = 63.8080, GNorm = 0.3522, lr_0 = 4.7190e-04
Loss = 2.1150e-03, PNorm = 63.8711, GNorm = 0.6315, lr_0 = 4.6464e-04
Loss = 2.0629e-03, PNorm = 63.9335, GNorm = 0.5756, lr_0 = 4.5749e-04
Loss = 2.1125e-03, PNorm = 63.9754, GNorm = 0.5148, lr_0 = 4.5044e-04
Loss = 2.0935e-03, PNorm = 64.0328, GNorm = 0.5999, lr_0 = 4.4351e-04
Validation auc = 0.915744
Epoch 12
Loss = 1.8352e-03, PNorm = 64.0895, GNorm = 0.2516, lr_0 = 4.3668e-04
Loss = 1.6633e-03, PNorm = 64.1513, GNorm = 0.3595, lr_0 = 4.2996e-04
Loss = 1.9545e-03, PNorm = 64.2006, GNorm = 0.6052, lr_0 = 4.2334e-04
Loss = 1.7976e-03, PNorm = 64.2516, GNorm = 0.3474, lr_0 = 4.1682e-04
Loss = 2.6288e-03, PNorm = 64.2918, GNorm = 0.4899, lr_0 = 4.1040e-04
Validation auc = 0.922202
Epoch 13
Loss = 9.3785e-04, PNorm = 64.3587, GNorm = 0.6190, lr_0 = 4.0408e-04
Loss = 2.1144e-03, PNorm = 64.4141, GNorm = 0.2871, lr_0 = 3.9786e-04
Loss = 1.5132e-03, PNorm = 64.4708, GNorm = 0.5508, lr_0 = 3.9173e-04
Loss = 1.5915e-03, PNorm = 64.5169, GNorm = 0.5954, lr_0 = 3.8570e-04
Loss = 2.7102e-03, PNorm = 64.5482, GNorm = 0.5223, lr_0 = 3.7976e-04
Loss = 1.7182e-03, PNorm = 64.5995, GNorm = 0.4285, lr_0 = 3.7392e-04
Validation auc = 0.915590
Epoch 14
Loss = 1.4512e-03, PNorm = 64.6528, GNorm = 0.6453, lr_0 = 3.6816e-04
Loss = 1.9346e-03, PNorm = 64.6959, GNorm = 0.5840, lr_0 = 3.6249e-04
Loss = 1.7548e-03, PNorm = 64.7408, GNorm = 0.6042, lr_0 = 3.5691e-04
Loss = 1.9773e-03, PNorm = 64.7809, GNorm = 0.4697, lr_0 = 3.5142e-04
Loss = 2.1004e-03, PNorm = 64.8115, GNorm = 0.5476, lr_0 = 3.4601e-04
Validation auc = 0.927429
Epoch 15
Loss = 1.7095e-03, PNorm = 64.8543, GNorm = 0.4050, lr_0 = 3.4068e-04
Loss = 1.7839e-03, PNorm = 64.8976, GNorm = 1.1454, lr_0 = 3.3543e-04
Loss = 1.9320e-03, PNorm = 64.9395, GNorm = 0.9120, lr_0 = 3.3027e-04
Loss = 1.7818e-03, PNorm = 64.9772, GNorm = 0.4682, lr_0 = 3.2518e-04
Loss = 1.4321e-03, PNorm = 65.0201, GNorm = 0.7039, lr_0 = 3.2018e-04
Validation auc = 0.921587
Epoch 16
Loss = 1.4796e-03, PNorm = 65.0593, GNorm = 0.2371, lr_0 = 3.1525e-04
Loss = 1.1076e-03, PNorm = 65.0997, GNorm = 0.3047, lr_0 = 3.1039e-04
Loss = 1.1355e-03, PNorm = 65.1398, GNorm = 0.1908, lr_0 = 3.0562e-04
Loss = 1.9748e-03, PNorm = 65.1678, GNorm = 0.4909, lr_0 = 3.0091e-04
Loss = 1.7956e-03, PNorm = 65.2086, GNorm = 0.2082, lr_0 = 2.9628e-04
Loss = 1.3040e-03, PNorm = 65.2339, GNorm = 0.4007, lr_0 = 2.9172e-04
Validation auc = 0.909902
Epoch 17
Loss = 1.3438e-03, PNorm = 65.2677, GNorm = 0.7357, lr_0 = 2.8722e-04
Loss = 1.4450e-03, PNorm = 65.3045, GNorm = 0.3448, lr_0 = 2.8280e-04
Loss = 1.2666e-03, PNorm = 65.3375, GNorm = 0.6160, lr_0 = 2.7845e-04
Loss = 1.5484e-03, PNorm = 65.3706, GNorm = 0.3891, lr_0 = 2.7416e-04
Loss = 1.2723e-03, PNorm = 65.4049, GNorm = 1.6742, lr_0 = 2.6994e-04
Validation auc = 0.929274
Epoch 18
Loss = 1.2764e-03, PNorm = 65.4219, GNorm = 1.0733, lr_0 = 2.6578e-04
Loss = 1.3115e-03, PNorm = 65.4514, GNorm = 0.3032, lr_0 = 2.6169e-04
Loss = 1.2313e-03, PNorm = 65.4930, GNorm = 0.6376, lr_0 = 2.5766e-04
Loss = 7.2861e-04, PNorm = 65.5244, GNorm = 0.3953, lr_0 = 2.5370e-04
Loss = 2.0704e-03, PNorm = 65.5395, GNorm = 0.6263, lr_0 = 2.4979e-04
Validation auc = 0.919127
Epoch 19
Loss = 1.3572e-03, PNorm = 65.5617, GNorm = 0.4486, lr_0 = 2.4594e-04
Loss = 1.2010e-03, PNorm = 65.5930, GNorm = 0.2772, lr_0 = 2.4216e-04
Loss = 9.3873e-04, PNorm = 65.6237, GNorm = 0.5583, lr_0 = 2.3843e-04
Loss = 1.0441e-03, PNorm = 65.6427, GNorm = 0.5353, lr_0 = 2.3476e-04
Loss = 1.6087e-03, PNorm = 65.6603, GNorm = 0.4264, lr_0 = 2.3114e-04
Loss = 1.4000e-03, PNorm = 65.6811, GNorm = 0.8160, lr_0 = 2.2758e-04
Validation auc = 0.924354
Epoch 20
Loss = 1.6212e-03, PNorm = 65.7102, GNorm = 1.1171, lr_0 = 2.2408e-04
Loss = 1.1495e-03, PNorm = 65.7350, GNorm = 1.2161, lr_0 = 2.2063e-04
Loss = 1.1393e-03, PNorm = 65.7671, GNorm = 1.3062, lr_0 = 2.1723e-04
Loss = 1.0096e-03, PNorm = 65.7865, GNorm = 0.7129, lr_0 = 2.1389e-04
Loss = 1.1476e-03, PNorm = 65.8045, GNorm = 0.2388, lr_0 = 2.1060e-04
Validation auc = 0.924969
Epoch 21
Loss = 6.8037e-04, PNorm = 65.8338, GNorm = 0.5030, lr_0 = 2.0735e-04
Loss = 1.1984e-03, PNorm = 65.8531, GNorm = 0.6976, lr_0 = 2.0416e-04
Loss = 1.0886e-03, PNorm = 65.8733, GNorm = 0.6429, lr_0 = 2.0102e-04
Loss = 9.1214e-04, PNorm = 65.8945, GNorm = 0.3270, lr_0 = 1.9792e-04
Loss = 1.4769e-03, PNorm = 65.9062, GNorm = 0.8107, lr_0 = 1.9488e-04
Validation auc = 0.916820
Epoch 22
Loss = 6.7587e-04, PNorm = 65.9327, GNorm = 0.5040, lr_0 = 1.9188e-04
Loss = 9.1438e-04, PNorm = 65.9512, GNorm = 0.8411, lr_0 = 1.8892e-04
Loss = 9.4797e-04, PNorm = 65.9708, GNorm = 0.2506, lr_0 = 1.8601e-04
Loss = 8.6434e-04, PNorm = 65.9947, GNorm = 0.2223, lr_0 = 1.8315e-04
Loss = 1.3130e-03, PNorm = 66.0110, GNorm = 0.5223, lr_0 = 1.8033e-04
Validation auc = 0.918512
Epoch 23
Loss = 1.1681e-03, PNorm = 66.0344, GNorm = 0.6909, lr_0 = 1.7755e-04
Loss = 7.5244e-04, PNorm = 66.0483, GNorm = 0.3537, lr_0 = 1.7482e-04
Loss = 9.5658e-04, PNorm = 66.0670, GNorm = 0.1678, lr_0 = 1.7213e-04
Loss = 1.1181e-03, PNorm = 66.0762, GNorm = 0.1883, lr_0 = 1.6948e-04
Loss = 9.8181e-04, PNorm = 66.0933, GNorm = 0.0925, lr_0 = 1.6687e-04
Loss = 7.6329e-04, PNorm = 66.1124, GNorm = 0.1521, lr_0 = 1.6430e-04
Validation auc = 0.920203
Epoch 24
Loss = 1.0973e-03, PNorm = 66.1303, GNorm = 0.6372, lr_0 = 1.6177e-04
Loss = 9.0868e-04, PNorm = 66.1390, GNorm = 0.5286, lr_0 = 1.5928e-04
Loss = 9.8566e-04, PNorm = 66.1518, GNorm = 0.4828, lr_0 = 1.5683e-04
Loss = 9.0670e-04, PNorm = 66.1668, GNorm = 0.6084, lr_0 = 1.5441e-04
Loss = 6.9438e-04, PNorm = 66.1868, GNorm = 0.3173, lr_0 = 1.5203e-04
Validation auc = 0.911900
Epoch 25
Loss = 8.8396e-04, PNorm = 66.1950, GNorm = 0.3418, lr_0 = 1.4969e-04
Loss = 7.8955e-04, PNorm = 66.2153, GNorm = 0.0941, lr_0 = 1.4739e-04
Loss = 8.6472e-04, PNorm = 66.2290, GNorm = 0.4545, lr_0 = 1.4512e-04
Loss = 9.2441e-04, PNorm = 66.2363, GNorm = 0.1276, lr_0 = 1.4288e-04
Loss = 8.2575e-04, PNorm = 66.2444, GNorm = 0.8223, lr_0 = 1.4069e-04
Validation auc = 0.915437
Epoch 26
Loss = 5.1207e-04, PNorm = 66.2553, GNorm = 0.3425, lr_0 = 1.3852e-04
Loss = 7.7560e-04, PNorm = 66.2739, GNorm = 0.1728, lr_0 = 1.3639e-04
Loss = 9.9006e-04, PNorm = 66.2876, GNorm = 1.0251, lr_0 = 1.3429e-04
Loss = 7.4725e-04, PNorm = 66.3018, GNorm = 0.6062, lr_0 = 1.3222e-04
Loss = 7.9436e-04, PNorm = 66.3103, GNorm = 0.1906, lr_0 = 1.3018e-04
Loss = 7.2420e-04, PNorm = 66.3211, GNorm = 0.6884, lr_0 = 1.2818e-04
Validation auc = 0.912054
Epoch 27
Loss = 7.5270e-04, PNorm = 66.3301, GNorm = 0.1931, lr_0 = 1.2621e-04
Loss = 7.0793e-04, PNorm = 66.3420, GNorm = 0.9978, lr_0 = 1.2426e-04
Loss = 6.5715e-04, PNorm = 66.3545, GNorm = 0.7723, lr_0 = 1.2235e-04
Loss = 7.8442e-04, PNorm = 66.3644, GNorm = 1.9926, lr_0 = 1.2047e-04
Loss = 8.1139e-04, PNorm = 66.3708, GNorm = 0.2400, lr_0 = 1.1861e-04
Validation auc = 0.910517
Epoch 28
Loss = 3.5908e-04, PNorm = 66.3800, GNorm = 0.1454, lr_0 = 1.1678e-04
Loss = 5.7518e-04, PNorm = 66.3917, GNorm = 0.3496, lr_0 = 1.1499e-04
Loss = 8.8172e-04, PNorm = 66.3950, GNorm = 0.4211, lr_0 = 1.1322e-04
Loss = 6.7365e-04, PNorm = 66.4041, GNorm = 0.4933, lr_0 = 1.1147e-04
Loss = 5.8124e-04, PNorm = 66.4133, GNorm = 0.2836, lr_0 = 1.0976e-04
Validation auc = 0.908979
Epoch 29
Loss = 1.0531e-03, PNorm = 66.4240, GNorm = 1.0455, lr_0 = 1.0807e-04
Loss = 1.0133e-03, PNorm = 66.4319, GNorm = 0.8699, lr_0 = 1.0640e-04
Loss = 5.2061e-04, PNorm = 66.4428, GNorm = 0.1727, lr_0 = 1.0476e-04
Loss = 5.1922e-04, PNorm = 66.4546, GNorm = 0.7677, lr_0 = 1.0315e-04
Loss = 5.0504e-04, PNorm = 66.4674, GNorm = 0.3693, lr_0 = 1.0156e-04
Loss = 7.8951e-04, PNorm = 66.4694, GNorm = 1.0468, lr_0 = 1.0000e-04
Validation auc = 0.915590
Model 0 best validation auc = 0.929274 on epoch 17
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test auc = nan
Ensemble test auc = nan
Fold 2
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': '../../../swansonk/chemprop_ckpt/0406_inhibition_hyperopt.json',
 'cuda': True,
 'data_path': '../../broad2/larger_dataset/0405_inhibition_dedup_binary.csv',
 'dataset_type': 'classification',
 'depth': 5,
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_dim': 200,
 'features_generator': None,
 'features_only': False,
 'features_path': ['../../saved_features/0405_broad_inhibition.npz'],
 'features_scaling': False,
 'features_size': 200,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 1600,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'no_cache': False,
 'num_folds': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'output_size': 1,
 'quiet': True,
 'save_dir': '../ckpt/0405_broad_inhibition_20folds/fold_2',
 'save_smiles_splits': False,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'task_names': ['50uM_Inhibition'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 2654,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': ['../../saved_features/0405_broad_inhibition.npz'],
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Class sizes
50uM_Inhibition 0: 91.93%, 1: 8.07%
Total size = 2,949 | train size = 2,654 | val size = 295 | test size = 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1600, bias=False)
      (W_h): Linear(in_features=1600, out_features=1600, bias=False)
      (W_o): Linear(in_features=1733, out_features=1600, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,571,401
Moving model to cuda
Epoch 0
Loss = 7.6333e-03, PNorm = 59.4808, GNorm = 0.5917, lr_0 = 1.8491e-04
Loss = 6.4133e-03, PNorm = 59.4955, GNorm = 0.7782, lr_0 = 2.6981e-04
Loss = 5.3317e-03, PNorm = 59.5135, GNorm = 0.6886, lr_0 = 3.5472e-04
Loss = 4.5842e-03, PNorm = 59.5384, GNorm = 0.3849, lr_0 = 4.3962e-04
Loss = 5.2721e-03, PNorm = 59.5682, GNorm = 0.4784, lr_0 = 5.2453e-04
Validation auc = 0.796740
Epoch 1
Loss = 4.6525e-03, PNorm = 59.6045, GNorm = 0.6742, lr_0 = 6.0943e-04
Loss = 5.0224e-03, PNorm = 59.6559, GNorm = 0.4877, lr_0 = 6.9434e-04
Loss = 5.2232e-03, PNorm = 59.7193, GNorm = 0.5662, lr_0 = 7.7925e-04
Loss = 4.5994e-03, PNorm = 59.7925, GNorm = 0.5682, lr_0 = 8.6415e-04
Loss = 4.6233e-03, PNorm = 59.8721, GNorm = 0.4885, lr_0 = 9.4906e-04
Validation auc = 0.844096
Epoch 2
Loss = 5.9674e-03, PNorm = 59.9706, GNorm = 0.3369, lr_0 = 9.9381e-04
Loss = 4.6692e-03, PNorm = 60.0978, GNorm = 1.3898, lr_0 = 9.7851e-04
Loss = 3.3957e-03, PNorm = 60.2062, GNorm = 0.9733, lr_0 = 9.6345e-04
Loss = 4.3677e-03, PNorm = 60.3055, GNorm = 0.4437, lr_0 = 9.4861e-04
Loss = 3.6926e-03, PNorm = 60.3977, GNorm = 0.8125, lr_0 = 9.3401e-04
Validation auc = 0.867620
Epoch 3
Loss = 5.7006e-03, PNorm = 60.4785, GNorm = 0.6874, lr_0 = 9.1963e-04
Loss = 5.0145e-03, PNorm = 60.5882, GNorm = 0.6328, lr_0 = 9.0547e-04
Loss = 3.9330e-03, PNorm = 60.7472, GNorm = 0.8032, lr_0 = 8.9153e-04
Loss = 3.5204e-03, PNorm = 60.8729, GNorm = 0.6048, lr_0 = 8.7780e-04
Loss = 3.6684e-03, PNorm = 60.9623, GNorm = 0.3753, lr_0 = 8.6429e-04
Loss = 4.1508e-03, PNorm = 61.0200, GNorm = 0.5274, lr_0 = 8.5098e-04
Validation auc = 0.845633
Epoch 4
Loss = 4.3359e-03, PNorm = 61.0945, GNorm = 0.6380, lr_0 = 8.3788e-04
Loss = 3.5734e-03, PNorm = 61.1585, GNorm = 0.3515, lr_0 = 8.2498e-04
Loss = 3.0067e-03, PNorm = 61.2229, GNorm = 0.7695, lr_0 = 8.1228e-04
Loss = 3.8281e-03, PNorm = 61.2752, GNorm = 0.3872, lr_0 = 7.9977e-04
Loss = 3.0181e-03, PNorm = 61.3599, GNorm = 0.3597, lr_0 = 7.8746e-04
Validation auc = 0.889760
Epoch 5
Loss = 2.7241e-03, PNorm = 61.4218, GNorm = 1.1350, lr_0 = 7.7533e-04
Loss = 3.2386e-03, PNorm = 61.4779, GNorm = 0.5064, lr_0 = 7.6340e-04
Loss = 2.9078e-03, PNorm = 61.5602, GNorm = 0.2662, lr_0 = 7.5164e-04
Loss = 3.0511e-03, PNorm = 61.6374, GNorm = 0.3949, lr_0 = 7.4007e-04
Loss = 3.3010e-03, PNorm = 61.7118, GNorm = 0.3920, lr_0 = 7.2867e-04
Validation auc = 0.893604
Epoch 6
Loss = 4.0410e-03, PNorm = 61.7943, GNorm = 0.4271, lr_0 = 7.1746e-04
Loss = 3.3394e-03, PNorm = 61.8890, GNorm = 0.3317, lr_0 = 7.0641e-04
Loss = 4.0030e-03, PNorm = 61.9853, GNorm = 0.5528, lr_0 = 6.9553e-04
Loss = 2.6127e-03, PNorm = 62.0778, GNorm = 0.3129, lr_0 = 6.8482e-04
Loss = 2.3230e-03, PNorm = 62.1606, GNorm = 0.6924, lr_0 = 6.7428e-04
Loss = 3.1823e-03, PNorm = 62.2326, GNorm = 0.3010, lr_0 = 6.6390e-04
Validation auc = 0.933887
Epoch 7
Loss = 3.1341e-03, PNorm = 62.3223, GNorm = 0.4031, lr_0 = 6.5368e-04
Loss = 2.8172e-03, PNorm = 62.4351, GNorm = 1.4909, lr_0 = 6.4361e-04
Loss = 2.8545e-03, PNorm = 62.5136, GNorm = 0.4094, lr_0 = 6.3370e-04
Loss = 2.8212e-03, PNorm = 62.5827, GNorm = 0.8574, lr_0 = 6.2395e-04
Loss = 2.8494e-03, PNorm = 62.6556, GNorm = 0.5803, lr_0 = 6.1434e-04
Validation auc = 0.935424
Epoch 8
Loss = 2.3846e-03, PNorm = 62.7415, GNorm = 0.5335, lr_0 = 6.0488e-04
Loss = 2.0915e-03, PNorm = 62.8180, GNorm = 0.5691, lr_0 = 5.9557e-04
Loss = 2.6151e-03, PNorm = 62.8861, GNorm = 0.2892, lr_0 = 5.8640e-04
Loss = 2.3304e-03, PNorm = 62.9556, GNorm = 0.2077, lr_0 = 5.7737e-04
Loss = 2.3190e-03, PNorm = 63.0205, GNorm = 0.7093, lr_0 = 5.6848e-04
Validation auc = 0.942036
Epoch 9
Loss = 1.2766e-03, PNorm = 63.0818, GNorm = 0.4371, lr_0 = 5.5973e-04
Loss = 2.5117e-03, PNorm = 63.1407, GNorm = 0.4156, lr_0 = 5.5111e-04
Loss = 2.0886e-03, PNorm = 63.2122, GNorm = 0.9310, lr_0 = 5.4263e-04
Loss = 2.8110e-03, PNorm = 63.2838, GNorm = 0.6501, lr_0 = 5.3427e-04
Loss = 2.6358e-03, PNorm = 63.3781, GNorm = 0.5328, lr_0 = 5.2605e-04
Loss = 2.2897e-03, PNorm = 63.4444, GNorm = 0.4165, lr_0 = 5.1795e-04
Validation auc = 0.949877
Epoch 10
Loss = 2.0868e-03, PNorm = 63.4872, GNorm = 0.2858, lr_0 = 5.0997e-04
Loss = 2.6847e-03, PNorm = 63.5381, GNorm = 0.2756, lr_0 = 5.0212e-04
Loss = 1.6971e-03, PNorm = 63.6090, GNorm = 0.4598, lr_0 = 4.9439e-04
Loss = 2.6914e-03, PNorm = 63.6542, GNorm = 0.6737, lr_0 = 4.8678e-04
Loss = 1.5688e-03, PNorm = 63.7150, GNorm = 0.2579, lr_0 = 4.7928e-04
Validation auc = 0.945726
Epoch 11
Loss = 1.7177e-03, PNorm = 63.7649, GNorm = 0.5591, lr_0 = 4.7190e-04
Loss = 1.3246e-03, PNorm = 63.8102, GNorm = 0.3156, lr_0 = 4.6464e-04
Loss = 2.1839e-03, PNorm = 63.8542, GNorm = 0.3128, lr_0 = 4.5749e-04
Loss = 2.3616e-03, PNorm = 63.9009, GNorm = 0.8345, lr_0 = 4.5044e-04
Loss = 1.4900e-03, PNorm = 63.9613, GNorm = 0.5067, lr_0 = 4.4351e-04
Validation auc = 0.947878
Epoch 12
Loss = 1.5811e-03, PNorm = 64.0069, GNorm = 0.4994, lr_0 = 4.3668e-04
Loss = 1.7396e-03, PNorm = 64.0607, GNorm = 0.7441, lr_0 = 4.2996e-04
Loss = 1.5033e-03, PNorm = 64.1323, GNorm = 0.2766, lr_0 = 4.2334e-04
Loss = 2.2134e-03, PNorm = 64.1775, GNorm = 0.7971, lr_0 = 4.1682e-04
Loss = 1.6667e-03, PNorm = 64.2402, GNorm = 0.5223, lr_0 = 4.1040e-04
Validation auc = 0.944496
Epoch 13
Loss = 2.4793e-03, PNorm = 64.2897, GNorm = 0.5690, lr_0 = 4.0408e-04
Loss = 2.3016e-03, PNorm = 64.3388, GNorm = 0.6721, lr_0 = 3.9786e-04
Loss = 1.4807e-03, PNorm = 64.3948, GNorm = 0.4603, lr_0 = 3.9173e-04
Loss = 1.5919e-03, PNorm = 64.4393, GNorm = 0.5482, lr_0 = 3.8570e-04
Loss = 1.9012e-03, PNorm = 64.4799, GNorm = 0.4415, lr_0 = 3.7976e-04
Loss = 2.1061e-03, PNorm = 64.5164, GNorm = 0.4912, lr_0 = 3.7392e-04
Validation auc = 0.948032
Epoch 14
Loss = 1.2904e-03, PNorm = 64.5595, GNorm = 0.6509, lr_0 = 3.6816e-04
Loss = 1.6649e-03, PNorm = 64.5944, GNorm = 0.5587, lr_0 = 3.6249e-04
Loss = 1.9288e-03, PNorm = 64.6589, GNorm = 0.2907, lr_0 = 3.5691e-04
Loss = 1.8485e-03, PNorm = 64.7048, GNorm = 0.5006, lr_0 = 3.5142e-04
Loss = 1.6617e-03, PNorm = 64.7468, GNorm = 0.5286, lr_0 = 3.4601e-04
Validation auc = 0.950185
Epoch 15
Loss = 1.3707e-03, PNorm = 64.7729, GNorm = 0.2950, lr_0 = 3.4068e-04
Loss = 1.2110e-03, PNorm = 64.8072, GNorm = 1.2136, lr_0 = 3.3543e-04
Loss = 1.9177e-03, PNorm = 64.8411, GNorm = 0.5110, lr_0 = 3.3027e-04
Loss = 1.7729e-03, PNorm = 64.8866, GNorm = 0.4729, lr_0 = 3.2518e-04
Loss = 1.6381e-03, PNorm = 64.9192, GNorm = 0.3501, lr_0 = 3.2018e-04
Validation auc = 0.950800
Epoch 16
Loss = 1.1811e-03, PNorm = 64.9661, GNorm = 0.6231, lr_0 = 3.1525e-04
Loss = 2.0001e-03, PNorm = 64.9893, GNorm = 1.0806, lr_0 = 3.1039e-04
Loss = 1.4976e-03, PNorm = 65.0359, GNorm = 0.6955, lr_0 = 3.0562e-04
Loss = 1.3581e-03, PNorm = 65.0620, GNorm = 0.7409, lr_0 = 3.0091e-04
Loss = 1.4195e-03, PNorm = 65.0918, GNorm = 0.4980, lr_0 = 2.9628e-04
Loss = 1.5626e-03, PNorm = 65.1264, GNorm = 0.6760, lr_0 = 2.9172e-04
Validation auc = 0.953721
Epoch 17
Loss = 1.0071e-03, PNorm = 65.1658, GNorm = 0.8110, lr_0 = 2.8722e-04
Loss = 1.1070e-03, PNorm = 65.1877, GNorm = 0.9161, lr_0 = 2.8280e-04
Loss = 1.0979e-03, PNorm = 65.2156, GNorm = 0.3140, lr_0 = 2.7845e-04
Loss = 1.3354e-03, PNorm = 65.2378, GNorm = 1.1850, lr_0 = 2.7416e-04
Loss = 2.1360e-03, PNorm = 65.2728, GNorm = 0.4969, lr_0 = 2.6994e-04
Validation auc = 0.953875
Epoch 18
Loss = 1.7883e-03, PNorm = 65.2971, GNorm = 1.1726, lr_0 = 2.6578e-04
Loss = 1.1298e-03, PNorm = 65.3333, GNorm = 0.6013, lr_0 = 2.6169e-04
Loss = 1.3441e-03, PNorm = 65.3626, GNorm = 0.5838, lr_0 = 2.5766e-04
Loss = 1.3588e-03, PNorm = 65.3834, GNorm = 0.5565, lr_0 = 2.5370e-04
Loss = 1.0410e-03, PNorm = 65.4092, GNorm = 0.3405, lr_0 = 2.4979e-04
Validation auc = 0.939729
Epoch 19
Loss = 8.8984e-04, PNorm = 65.4247, GNorm = 0.7834, lr_0 = 2.4594e-04
Loss = 1.0706e-03, PNorm = 65.4551, GNorm = 0.6944, lr_0 = 2.4216e-04
Loss = 9.4472e-04, PNorm = 65.4782, GNorm = 0.1216, lr_0 = 2.3843e-04
Loss = 8.4256e-04, PNorm = 65.5025, GNorm = 0.4104, lr_0 = 2.3476e-04
Loss = 1.1047e-03, PNorm = 65.5267, GNorm = 0.5802, lr_0 = 2.3114e-04
Loss = 2.0753e-03, PNorm = 65.5487, GNorm = 1.4537, lr_0 = 2.2758e-04
Validation auc = 0.942036
Epoch 20
Loss = 1.0465e-03, PNorm = 65.5771, GNorm = 0.4812, lr_0 = 2.2408e-04
Loss = 8.1031e-04, PNorm = 65.6071, GNorm = 0.4346, lr_0 = 2.2063e-04
Loss = 1.0309e-03, PNorm = 65.6197, GNorm = 0.3459, lr_0 = 2.1723e-04
Loss = 1.1801e-03, PNorm = 65.6412, GNorm = 0.9455, lr_0 = 2.1389e-04
Loss = 1.3073e-03, PNorm = 65.6547, GNorm = 1.0239, lr_0 = 2.1060e-04
Validation auc = 0.956796
Epoch 21
Loss = 1.0826e-03, PNorm = 65.6832, GNorm = 1.1032, lr_0 = 2.0735e-04
Loss = 1.0678e-03, PNorm = 65.7138, GNorm = 0.2225, lr_0 = 2.0416e-04
Loss = 7.2870e-04, PNorm = 65.7341, GNorm = 0.3669, lr_0 = 2.0102e-04
Loss = 1.2596e-03, PNorm = 65.7511, GNorm = 0.5391, lr_0 = 1.9792e-04
Loss = 1.3522e-03, PNorm = 65.7681, GNorm = 0.8496, lr_0 = 1.9488e-04
Validation auc = 0.953721
Epoch 22
Loss = 7.9427e-04, PNorm = 65.7854, GNorm = 0.3972, lr_0 = 1.9188e-04
Loss = 1.2958e-03, PNorm = 65.8045, GNorm = 0.6249, lr_0 = 1.8892e-04
Loss = 9.4272e-04, PNorm = 65.8252, GNorm = 0.3768, lr_0 = 1.8601e-04
Loss = 6.7090e-04, PNorm = 65.8407, GNorm = 0.4592, lr_0 = 1.8315e-04
Loss = 1.0588e-03, PNorm = 65.8565, GNorm = 0.0865, lr_0 = 1.8033e-04
Validation auc = 0.951107
Epoch 23
Loss = 1.0102e-04, PNorm = 65.8744, GNorm = 0.1172, lr_0 = 1.7755e-04
Loss = 8.6980e-04, PNorm = 65.8883, GNorm = 0.5915, lr_0 = 1.7482e-04
Loss = 8.3071e-04, PNorm = 65.9077, GNorm = 0.5447, lr_0 = 1.7213e-04
Loss = 8.2698e-04, PNorm = 65.9289, GNorm = 0.3565, lr_0 = 1.6948e-04
Loss = 8.9534e-04, PNorm = 65.9422, GNorm = 0.9397, lr_0 = 1.6687e-04
Loss = 8.4925e-04, PNorm = 65.9605, GNorm = 0.1571, lr_0 = 1.6430e-04
Validation auc = 0.958026
Epoch 24
Loss = 1.0486e-03, PNorm = 65.9770, GNorm = 0.7969, lr_0 = 1.6177e-04
Loss = 8.7511e-04, PNorm = 65.9917, GNorm = 0.1291, lr_0 = 1.5928e-04
Loss = 9.6705e-04, PNorm = 66.0075, GNorm = 0.5185, lr_0 = 1.5683e-04
Loss = 7.0176e-04, PNorm = 66.0243, GNorm = 0.3490, lr_0 = 1.5441e-04
Loss = 9.3941e-04, PNorm = 66.0338, GNorm = 0.4534, lr_0 = 1.5203e-04
Validation auc = 0.950800
Epoch 25
Loss = 4.9024e-04, PNorm = 66.0531, GNorm = 0.6218, lr_0 = 1.4969e-04
Loss = 5.0476e-04, PNorm = 66.0687, GNorm = 0.2876, lr_0 = 1.4739e-04
Loss = 6.9621e-04, PNorm = 66.0779, GNorm = 0.5864, lr_0 = 1.4512e-04
Loss = 6.5822e-04, PNorm = 66.0873, GNorm = 0.3062, lr_0 = 1.4288e-04
Loss = 1.1087e-03, PNorm = 66.0980, GNorm = 0.5340, lr_0 = 1.4069e-04
Validation auc = 0.950031
Epoch 26
Loss = 1.3453e-03, PNorm = 66.1135, GNorm = 0.4468, lr_0 = 1.3852e-04
Loss = 1.0321e-03, PNorm = 66.1170, GNorm = 0.0778, lr_0 = 1.3639e-04
Loss = 5.9626e-04, PNorm = 66.1317, GNorm = 0.2477, lr_0 = 1.3429e-04
Loss = 7.1613e-04, PNorm = 66.1467, GNorm = 0.0749, lr_0 = 1.3222e-04
Loss = 6.8405e-04, PNorm = 66.1563, GNorm = 0.2827, lr_0 = 1.3018e-04
Loss = 8.6498e-04, PNorm = 66.1609, GNorm = 0.7776, lr_0 = 1.2818e-04
Validation auc = 0.944342
Epoch 27
Loss = 6.0159e-04, PNorm = 66.1805, GNorm = 0.4722, lr_0 = 1.2621e-04
Loss = 1.0997e-03, PNorm = 66.1908, GNorm = 0.6610, lr_0 = 1.2426e-04
Loss = 5.0732e-04, PNorm = 66.1966, GNorm = 0.4645, lr_0 = 1.2235e-04
Loss = 4.9108e-04, PNorm = 66.2055, GNorm = 0.4282, lr_0 = 1.2047e-04
Loss = 4.1144e-04, PNorm = 66.2165, GNorm = 0.3647, lr_0 = 1.1861e-04
Validation auc = 0.946341
Epoch 28
Loss = 7.5229e-04, PNorm = 66.2212, GNorm = 0.3215, lr_0 = 1.1678e-04
Loss = 8.3773e-04, PNorm = 66.2347, GNorm = 0.0579, lr_0 = 1.1499e-04
Loss = 8.5098e-04, PNorm = 66.2408, GNorm = 0.7508, lr_0 = 1.1322e-04
Loss = 5.7139e-04, PNorm = 66.2507, GNorm = 0.2725, lr_0 = 1.1147e-04
Loss = 6.3951e-04, PNorm = 66.2652, GNorm = 0.6687, lr_0 = 1.0976e-04
Validation auc = 0.955566
Epoch 29
Loss = 1.8331e-04, PNorm = 66.2746, GNorm = 0.0078, lr_0 = 1.0807e-04
Loss = 7.7206e-04, PNorm = 66.2746, GNorm = 0.1847, lr_0 = 1.0640e-04
Loss = 4.5306e-04, PNorm = 66.2837, GNorm = 0.4474, lr_0 = 1.0476e-04
Loss = 9.5301e-04, PNorm = 66.2906, GNorm = 0.1215, lr_0 = 1.0315e-04
Loss = 8.6885e-04, PNorm = 66.2942, GNorm = 0.8960, lr_0 = 1.0156e-04
Loss = 9.9036e-04, PNorm = 66.3014, GNorm = 0.4301, lr_0 = 1.0000e-04
Validation auc = 0.956950
Model 0 best validation auc = 0.958026 on epoch 23
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test auc = nan
Ensemble test auc = nan
Fold 3
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': '../../../swansonk/chemprop_ckpt/0406_inhibition_hyperopt.json',
 'cuda': True,
 'data_path': '../../broad2/larger_dataset/0405_inhibition_dedup_binary.csv',
 'dataset_type': 'classification',
 'depth': 5,
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_dim': 200,
 'features_generator': None,
 'features_only': False,
 'features_path': ['../../saved_features/0405_broad_inhibition.npz'],
 'features_scaling': False,
 'features_size': 200,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 1600,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'no_cache': False,
 'num_folds': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'output_size': 1,
 'quiet': True,
 'save_dir': '../ckpt/0405_broad_inhibition_20folds/fold_3',
 'save_smiles_splits': False,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'task_names': ['50uM_Inhibition'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 2654,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': ['../../saved_features/0405_broad_inhibition.npz'],
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Class sizes
50uM_Inhibition 0: 91.93%, 1: 8.07%
Total size = 2,949 | train size = 2,654 | val size = 295 | test size = 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1600, bias=False)
      (W_h): Linear(in_features=1600, out_features=1600, bias=False)
      (W_o): Linear(in_features=1733, out_features=1600, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,571,401
Moving model to cuda
Epoch 0
Loss = 8.0893e-03, PNorm = 59.4475, GNorm = 1.2365, lr_0 = 1.8491e-04
Loss = 5.7826e-03, PNorm = 59.4637, GNorm = 0.5123, lr_0 = 2.6981e-04
Loss = 5.2788e-03, PNorm = 59.4801, GNorm = 0.3679, lr_0 = 3.5472e-04
Loss = 5.5708e-03, PNorm = 59.5003, GNorm = 0.4696, lr_0 = 4.3962e-04
Loss = 5.0016e-03, PNorm = 59.5336, GNorm = 0.4580, lr_0 = 5.2453e-04
Validation auc = 0.847478
Epoch 1
Loss = 4.8252e-03, PNorm = 59.5738, GNorm = 0.8896, lr_0 = 6.0943e-04
Loss = 4.8761e-03, PNorm = 59.6243, GNorm = 0.3959, lr_0 = 6.9434e-04
Loss = 5.3945e-03, PNorm = 59.6850, GNorm = 0.3997, lr_0 = 7.7925e-04
Loss = 5.1454e-03, PNorm = 59.7512, GNorm = 0.4390, lr_0 = 8.6415e-04
Loss = 5.4030e-03, PNorm = 59.8399, GNorm = 3.7735, lr_0 = 9.4906e-04
Validation auc = 0.857626
Epoch 2
Loss = 4.1386e-03, PNorm = 59.9581, GNorm = 0.7029, lr_0 = 9.9381e-04
Loss = 4.7817e-03, PNorm = 60.0732, GNorm = 0.3692, lr_0 = 9.7851e-04
Loss = 4.4474e-03, PNorm = 60.1662, GNorm = 0.4585, lr_0 = 9.6345e-04
Loss = 5.0417e-03, PNorm = 60.2478, GNorm = 0.3499, lr_0 = 9.4861e-04
Loss = 4.6885e-03, PNorm = 60.3600, GNorm = 0.2860, lr_0 = 9.3401e-04
Validation auc = 0.897909
Epoch 3
Loss = 3.2326e-03, PNorm = 60.4655, GNorm = 0.4908, lr_0 = 9.1963e-04
Loss = 4.2765e-03, PNorm = 60.5523, GNorm = 0.8005, lr_0 = 9.0547e-04
Loss = 4.6149e-03, PNorm = 60.6425, GNorm = 0.9706, lr_0 = 8.9153e-04
Loss = 4.1322e-03, PNorm = 60.7327, GNorm = 0.4987, lr_0 = 8.7780e-04
Loss = 3.6088e-03, PNorm = 60.8246, GNorm = 0.3992, lr_0 = 8.6429e-04
Loss = 4.3424e-03, PNorm = 60.9116, GNorm = 1.2896, lr_0 = 8.5098e-04
Validation auc = 0.851476
Epoch 4
Loss = 3.8965e-03, PNorm = 61.0110, GNorm = 0.4437, lr_0 = 8.3788e-04
Loss = 4.0715e-03, PNorm = 61.1168, GNorm = 0.3226, lr_0 = 8.2498e-04
Loss = 3.5121e-03, PNorm = 61.2125, GNorm = 0.4651, lr_0 = 8.1228e-04
Loss = 3.1126e-03, PNorm = 61.3001, GNorm = 0.4049, lr_0 = 7.9977e-04
Loss = 4.3146e-03, PNorm = 61.3786, GNorm = 0.6302, lr_0 = 7.8746e-04
Validation auc = 0.910517
Epoch 5
Loss = 5.5156e-03, PNorm = 61.4476, GNorm = 0.3245, lr_0 = 7.7533e-04
Loss = 3.9734e-03, PNorm = 61.5306, GNorm = 0.5044, lr_0 = 7.6340e-04
Loss = 2.2088e-03, PNorm = 61.6177, GNorm = 1.1479, lr_0 = 7.5164e-04
Loss = 3.5061e-03, PNorm = 61.6882, GNorm = 0.6418, lr_0 = 7.4007e-04
Loss = 2.6894e-03, PNorm = 61.7633, GNorm = 0.8241, lr_0 = 7.2867e-04
Validation auc = 0.936039
Epoch 6
Loss = 5.6068e-03, PNorm = 61.8421, GNorm = 0.9491, lr_0 = 7.1746e-04
Loss = 3.0253e-03, PNorm = 61.9144, GNorm = 0.4923, lr_0 = 7.0641e-04
Loss = 2.4978e-03, PNorm = 61.9996, GNorm = 0.3693, lr_0 = 6.9553e-04
Loss = 3.0896e-03, PNorm = 62.0681, GNorm = 0.8529, lr_0 = 6.8482e-04
Loss = 3.5077e-03, PNorm = 62.1469, GNorm = 1.0009, lr_0 = 6.7428e-04
Loss = 2.7773e-03, PNorm = 62.2299, GNorm = 0.8634, lr_0 = 6.6390e-04
Validation auc = 0.930197
Epoch 7
Loss = 1.7364e-03, PNorm = 62.3097, GNorm = 0.4144, lr_0 = 6.5368e-04
Loss = 3.0763e-03, PNorm = 62.3734, GNorm = 0.6864, lr_0 = 6.4361e-04
Loss = 3.0091e-03, PNorm = 62.4500, GNorm = 0.8508, lr_0 = 6.3370e-04
Loss = 2.8029e-03, PNorm = 62.5228, GNorm = 0.4160, lr_0 = 6.2395e-04
Loss = 3.0461e-03, PNorm = 62.6046, GNorm = 0.3240, lr_0 = 6.1434e-04
Validation auc = 0.943419
Epoch 8
Loss = 2.9773e-03, PNorm = 62.6575, GNorm = 0.5189, lr_0 = 6.0488e-04
Loss = 2.3062e-03, PNorm = 62.7421, GNorm = 0.2736, lr_0 = 5.9557e-04
Loss = 2.9066e-03, PNorm = 62.8085, GNorm = 0.5170, lr_0 = 5.8640e-04
Loss = 2.6294e-03, PNorm = 62.8750, GNorm = 0.3269, lr_0 = 5.7737e-04
Loss = 2.8375e-03, PNorm = 62.9492, GNorm = 0.5101, lr_0 = 5.6848e-04
Validation auc = 0.919588
Epoch 9
Loss = 2.5042e-03, PNorm = 63.0145, GNorm = 0.4707, lr_0 = 5.5973e-04
Loss = 2.6203e-03, PNorm = 63.0942, GNorm = 0.3840, lr_0 = 5.5111e-04
Loss = 2.1893e-03, PNorm = 63.1625, GNorm = 0.2609, lr_0 = 5.4263e-04
Loss = 1.9994e-03, PNorm = 63.2280, GNorm = 0.7404, lr_0 = 5.3427e-04
Loss = 2.5949e-03, PNorm = 63.2793, GNorm = 1.0627, lr_0 = 5.2605e-04
Loss = 3.1645e-03, PNorm = 63.3273, GNorm = 0.6519, lr_0 = 5.1795e-04
Validation auc = 0.943419
Epoch 10
Loss = 2.4627e-03, PNorm = 63.4075, GNorm = 1.0647, lr_0 = 5.0997e-04
Loss = 2.7593e-03, PNorm = 63.4759, GNorm = 0.6204, lr_0 = 5.0212e-04
Loss = 1.9705e-03, PNorm = 63.5147, GNorm = 0.4391, lr_0 = 4.9439e-04
Loss = 1.6924e-03, PNorm = 63.5717, GNorm = 0.5320, lr_0 = 4.8678e-04
Loss = 2.6389e-03, PNorm = 63.6163, GNorm = 0.2890, lr_0 = 4.7928e-04
Validation auc = 0.941882
Epoch 11
Loss = 1.9069e-03, PNorm = 63.6710, GNorm = 0.2734, lr_0 = 4.7190e-04
Loss = 1.7225e-03, PNorm = 63.7327, GNorm = 0.3777, lr_0 = 4.6464e-04
Loss = 2.2685e-03, PNorm = 63.7845, GNorm = 0.3837, lr_0 = 4.5749e-04
Loss = 2.3490e-03, PNorm = 63.8391, GNorm = 0.2614, lr_0 = 4.5044e-04
Loss = 2.0592e-03, PNorm = 63.8918, GNorm = 0.4210, lr_0 = 4.4351e-04
Validation auc = 0.952952
Epoch 12
Loss = 1.7010e-03, PNorm = 63.9405, GNorm = 0.2763, lr_0 = 4.3668e-04
Loss = 1.9110e-03, PNorm = 63.9942, GNorm = 0.4949, lr_0 = 4.2996e-04
Loss = 2.1050e-03, PNorm = 64.0471, GNorm = 0.6361, lr_0 = 4.2334e-04
Loss = 2.2874e-03, PNorm = 64.1132, GNorm = 0.9094, lr_0 = 4.1682e-04
Loss = 1.5779e-03, PNorm = 64.1685, GNorm = 0.3371, lr_0 = 4.1040e-04
Validation auc = 0.956335
Epoch 13
Loss = 5.5165e-04, PNorm = 64.2285, GNorm = 0.2327, lr_0 = 4.0408e-04
Loss = 1.3463e-03, PNorm = 64.2821, GNorm = 0.4070, lr_0 = 3.9786e-04
Loss = 2.2360e-03, PNorm = 64.3331, GNorm = 0.4651, lr_0 = 3.9173e-04
Loss = 1.6340e-03, PNorm = 64.3844, GNorm = 0.5210, lr_0 = 3.8570e-04
Loss = 2.1538e-03, PNorm = 64.4287, GNorm = 0.4119, lr_0 = 3.7976e-04
Loss = 2.0099e-03, PNorm = 64.4737, GNorm = 0.8451, lr_0 = 3.7392e-04
Validation auc = 0.944803
Epoch 14
Loss = 2.3648e-03, PNorm = 64.5318, GNorm = 0.6866, lr_0 = 3.6816e-04
Loss = 1.3277e-03, PNorm = 64.5937, GNorm = 0.2267, lr_0 = 3.6249e-04
Loss = 1.3114e-03, PNorm = 64.6430, GNorm = 0.5174, lr_0 = 3.5691e-04
Loss = 1.6320e-03, PNorm = 64.6800, GNorm = 0.5536, lr_0 = 3.5142e-04
Loss = 2.1149e-03, PNorm = 64.7119, GNorm = 0.4836, lr_0 = 3.4601e-04
Validation auc = 0.952798
Epoch 15
Loss = 2.0228e-03, PNorm = 64.7520, GNorm = 0.5412, lr_0 = 3.4068e-04
Loss = 2.0862e-03, PNorm = 64.7938, GNorm = 0.7190, lr_0 = 3.3543e-04
Loss = 1.5398e-03, PNorm = 64.8459, GNorm = 0.3877, lr_0 = 3.3027e-04
Loss = 1.1571e-03, PNorm = 64.8931, GNorm = 0.8066, lr_0 = 3.2518e-04
Loss = 9.6040e-04, PNorm = 64.9405, GNorm = 0.4865, lr_0 = 3.2018e-04
Validation auc = 0.952491
Epoch 16
Loss = 1.3638e-03, PNorm = 64.9731, GNorm = 0.5125, lr_0 = 3.1525e-04
Loss = 1.4176e-03, PNorm = 64.9938, GNorm = 0.3736, lr_0 = 3.1039e-04
Loss = 1.4165e-03, PNorm = 65.0361, GNorm = 0.4332, lr_0 = 3.0562e-04
Loss = 1.3143e-03, PNorm = 65.0642, GNorm = 0.3376, lr_0 = 3.0091e-04
Loss = 1.5665e-03, PNorm = 65.1031, GNorm = 0.6543, lr_0 = 2.9628e-04
Loss = 1.7232e-03, PNorm = 65.1389, GNorm = 0.5298, lr_0 = 2.9172e-04
Validation auc = 0.955873
Epoch 17
Loss = 1.1238e-03, PNorm = 65.1705, GNorm = 0.5403, lr_0 = 2.8722e-04
Loss = 1.2568e-03, PNorm = 65.2033, GNorm = 0.3836, lr_0 = 2.8280e-04
Loss = 1.2227e-03, PNorm = 65.2383, GNorm = 0.7666, lr_0 = 2.7845e-04
Loss = 1.2536e-03, PNorm = 65.2733, GNorm = 0.8773, lr_0 = 2.7416e-04
Loss = 1.5959e-03, PNorm = 65.2951, GNorm = 0.9025, lr_0 = 2.6994e-04
Validation auc = 0.947417
Epoch 18
Loss = 1.3299e-03, PNorm = 65.3293, GNorm = 0.3801, lr_0 = 2.6578e-04
Loss = 1.3111e-03, PNorm = 65.3595, GNorm = 0.4006, lr_0 = 2.6169e-04
Loss = 1.1349e-03, PNorm = 65.3978, GNorm = 0.1508, lr_0 = 2.5766e-04
Loss = 1.3738e-03, PNorm = 65.4234, GNorm = 0.8813, lr_0 = 2.5370e-04
Loss = 9.7658e-04, PNorm = 65.4580, GNorm = 0.3029, lr_0 = 2.4979e-04
Validation auc = 0.954643
Epoch 19
Loss = 2.3046e-03, PNorm = 65.4770, GNorm = 1.5936, lr_0 = 2.4594e-04
Loss = 1.4987e-03, PNorm = 65.5169, GNorm = 1.7919, lr_0 = 2.4216e-04
Loss = 1.0642e-03, PNorm = 65.5329, GNorm = 0.7808, lr_0 = 2.3843e-04
Loss = 1.2753e-03, PNorm = 65.5702, GNorm = 0.5163, lr_0 = 2.3476e-04
Loss = 1.0143e-03, PNorm = 65.5883, GNorm = 0.4475, lr_0 = 2.3114e-04
Loss = 1.3095e-03, PNorm = 65.6086, GNorm = 0.5691, lr_0 = 2.2758e-04
Validation auc = 0.949108
Epoch 20
Loss = 1.1202e-03, PNorm = 65.6398, GNorm = 0.7267, lr_0 = 2.2408e-04
Loss = 9.4873e-04, PNorm = 65.6599, GNorm = 0.7774, lr_0 = 2.2063e-04
Loss = 1.6677e-03, PNorm = 65.6813, GNorm = 0.7437, lr_0 = 2.1723e-04
Loss = 1.0169e-03, PNorm = 65.7030, GNorm = 0.6349, lr_0 = 2.1389e-04
Loss = 9.6495e-04, PNorm = 65.7205, GNorm = 0.7421, lr_0 = 2.1060e-04
Validation auc = 0.954336
Epoch 21
Loss = 1.1578e-03, PNorm = 65.7449, GNorm = 0.9831, lr_0 = 2.0735e-04
Loss = 7.3142e-04, PNorm = 65.7670, GNorm = 0.5220, lr_0 = 2.0416e-04
Loss = 8.7253e-04, PNorm = 65.7869, GNorm = 1.0601, lr_0 = 2.0102e-04
Loss = 1.3190e-03, PNorm = 65.8048, GNorm = 0.2011, lr_0 = 1.9792e-04
Loss = 9.6989e-04, PNorm = 65.8309, GNorm = 0.2170, lr_0 = 1.9488e-04
Validation auc = 0.952645
Epoch 22
Loss = 1.0161e-03, PNorm = 65.8462, GNorm = 1.2684, lr_0 = 1.9188e-04
Loss = 7.9596e-04, PNorm = 65.8766, GNorm = 0.2188, lr_0 = 1.8892e-04
Loss = 1.2602e-03, PNorm = 65.8883, GNorm = 0.9293, lr_0 = 1.8601e-04
Loss = 8.3021e-04, PNorm = 65.9225, GNorm = 0.2423, lr_0 = 1.8315e-04
Loss = 1.1869e-03, PNorm = 65.9321, GNorm = 0.9187, lr_0 = 1.8033e-04
Validation auc = 0.952030
Epoch 23
Loss = 6.3394e-04, PNorm = 65.9474, GNorm = 0.6724, lr_0 = 1.7755e-04
Loss = 9.8510e-04, PNorm = 65.9600, GNorm = 0.5443, lr_0 = 1.7482e-04
Loss = 1.1637e-03, PNorm = 65.9810, GNorm = 0.4660, lr_0 = 1.7213e-04
Loss = 7.9283e-04, PNorm = 65.9914, GNorm = 0.6083, lr_0 = 1.6948e-04
Loss = 9.5530e-04, PNorm = 66.0068, GNorm = 1.0570, lr_0 = 1.6687e-04
Loss = 1.1393e-03, PNorm = 66.0228, GNorm = 0.8584, lr_0 = 1.6430e-04
Validation auc = 0.956488
Epoch 24
Loss = 8.6509e-04, PNorm = 66.0381, GNorm = 0.1439, lr_0 = 1.6177e-04
Loss = 6.4571e-04, PNorm = 66.0525, GNorm = 1.2706, lr_0 = 1.5928e-04
Loss = 5.5353e-04, PNorm = 66.0713, GNorm = 0.6213, lr_0 = 1.5683e-04
Loss = 6.6926e-04, PNorm = 66.0860, GNorm = 0.0436, lr_0 = 1.5441e-04
Loss = 1.2022e-03, PNorm = 66.0939, GNorm = 0.4374, lr_0 = 1.5203e-04
Validation auc = 0.950492
Epoch 25
Loss = 6.5572e-04, PNorm = 66.1160, GNorm = 0.2272, lr_0 = 1.4969e-04
Loss = 6.8100e-04, PNorm = 66.1273, GNorm = 0.3671, lr_0 = 1.4739e-04
Loss = 8.4484e-04, PNorm = 66.1429, GNorm = 0.1162, lr_0 = 1.4512e-04
Loss = 1.1293e-03, PNorm = 66.1504, GNorm = 0.2485, lr_0 = 1.4288e-04
Loss = 6.7203e-04, PNorm = 66.1675, GNorm = 0.5785, lr_0 = 1.4069e-04
Validation auc = 0.953721
Epoch 26
Loss = 8.6407e-04, PNorm = 66.1811, GNorm = 0.9583, lr_0 = 1.3852e-04
Loss = 6.0658e-04, PNorm = 66.1921, GNorm = 0.8478, lr_0 = 1.3639e-04
Loss = 6.2642e-04, PNorm = 66.2015, GNorm = 0.4538, lr_0 = 1.3429e-04
Loss = 7.1666e-04, PNorm = 66.2142, GNorm = 0.8446, lr_0 = 1.3222e-04
Loss = 7.4514e-04, PNorm = 66.2226, GNorm = 0.2786, lr_0 = 1.3018e-04
Loss = 9.7462e-04, PNorm = 66.2390, GNorm = 1.2017, lr_0 = 1.2818e-04
Validation auc = 0.956642
Epoch 27
Loss = 3.6966e-04, PNorm = 66.2451, GNorm = 0.5793, lr_0 = 1.2621e-04
Loss = 7.4838e-04, PNorm = 66.2571, GNorm = 0.2673, lr_0 = 1.2426e-04
Loss = 7.6481e-04, PNorm = 66.2632, GNorm = 1.0193, lr_0 = 1.2235e-04
Loss = 7.4354e-04, PNorm = 66.2797, GNorm = 0.2514, lr_0 = 1.2047e-04
Loss = 7.9616e-04, PNorm = 66.2855, GNorm = 0.6857, lr_0 = 1.1861e-04
Validation auc = 0.952798
Epoch 28
Loss = 7.7545e-04, PNorm = 66.2984, GNorm = 0.9154, lr_0 = 1.1678e-04
Loss = 5.8878e-04, PNorm = 66.3138, GNorm = 0.7973, lr_0 = 1.1499e-04
Loss = 5.5955e-04, PNorm = 66.3224, GNorm = 0.5818, lr_0 = 1.1322e-04
Loss = 6.2687e-04, PNorm = 66.3279, GNorm = 0.6420, lr_0 = 1.1147e-04
Loss = 8.3791e-04, PNorm = 66.3421, GNorm = 0.9068, lr_0 = 1.0976e-04
Validation auc = 0.955105
Epoch 29
Loss = 3.8085e-04, PNorm = 66.3495, GNorm = 0.1553, lr_0 = 1.0807e-04
Loss = 7.4155e-04, PNorm = 66.3585, GNorm = 0.4988, lr_0 = 1.0640e-04
Loss = 7.2035e-04, PNorm = 66.3682, GNorm = 0.4759, lr_0 = 1.0476e-04
Loss = 5.8008e-04, PNorm = 66.3730, GNorm = 0.5292, lr_0 = 1.0315e-04
Loss = 4.4496e-04, PNorm = 66.3810, GNorm = 0.4054, lr_0 = 1.0156e-04
Loss = 6.3263e-04, PNorm = 66.3871, GNorm = 1.0276, lr_0 = 1.0000e-04
Validation auc = 0.950646
Model 0 best validation auc = 0.956642 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test auc = nan
Ensemble test auc = nan
Fold 4
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': '../../../swansonk/chemprop_ckpt/0406_inhibition_hyperopt.json',
 'cuda': True,
 'data_path': '../../broad2/larger_dataset/0405_inhibition_dedup_binary.csv',
 'dataset_type': 'classification',
 'depth': 5,
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_dim': 200,
 'features_generator': None,
 'features_only': False,
 'features_path': ['../../saved_features/0405_broad_inhibition.npz'],
 'features_scaling': False,
 'features_size': 200,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 1600,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'no_cache': False,
 'num_folds': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'output_size': 1,
 'quiet': True,
 'save_dir': '../ckpt/0405_broad_inhibition_20folds/fold_4',
 'save_smiles_splits': False,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'task_names': ['50uM_Inhibition'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 2654,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': ['../../saved_features/0405_broad_inhibition.npz'],
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Class sizes
50uM_Inhibition 0: 91.93%, 1: 8.07%
Total size = 2,949 | train size = 2,654 | val size = 295 | test size = 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1600, bias=False)
      (W_h): Linear(in_features=1600, out_features=1600, bias=False)
      (W_o): Linear(in_features=1733, out_features=1600, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,571,401
Moving model to cuda
Epoch 0
Loss = 6.4175e-03, PNorm = 59.4508, GNorm = 0.9609, lr_0 = 1.8491e-04
Loss = 6.1689e-03, PNorm = 59.4645, GNorm = 0.5038, lr_0 = 2.6981e-04
Loss = 5.2481e-03, PNorm = 59.4864, GNorm = 0.4343, lr_0 = 3.5472e-04
Loss = 4.6450e-03, PNorm = 59.5117, GNorm = 0.4323, lr_0 = 4.3962e-04
Loss = 5.9819e-03, PNorm = 59.5477, GNorm = 5.0405, lr_0 = 5.2453e-04
Validation auc = 0.792844
Epoch 1
Loss = 5.7737e-03, PNorm = 59.6125, GNorm = 0.3529, lr_0 = 6.0943e-04
Loss = 5.7713e-03, PNorm = 59.6880, GNorm = 0.4119, lr_0 = 6.9434e-04
Loss = 4.4158e-03, PNorm = 59.7517, GNorm = 0.5179, lr_0 = 7.7925e-04
Loss = 4.3862e-03, PNorm = 59.8114, GNorm = 0.4931, lr_0 = 8.6415e-04
Loss = 4.6353e-03, PNorm = 59.8803, GNorm = 0.4261, lr_0 = 9.4906e-04
Validation auc = 0.825771
Epoch 2
Loss = 3.5378e-03, PNorm = 59.9702, GNorm = 0.3289, lr_0 = 9.9381e-04
Loss = 5.4373e-03, PNorm = 60.0396, GNorm = 0.3524, lr_0 = 9.7851e-04
Loss = 4.1947e-03, PNorm = 60.1207, GNorm = 0.4891, lr_0 = 9.6345e-04
Loss = 4.5562e-03, PNorm = 60.1841, GNorm = 0.7687, lr_0 = 9.4861e-04
Loss = 4.0697e-03, PNorm = 60.2666, GNorm = 0.4431, lr_0 = 9.3401e-04
Validation auc = 0.832772
Epoch 3
Loss = 4.5685e-03, PNorm = 60.3366, GNorm = 0.8183, lr_0 = 9.1963e-04
Loss = 3.4467e-03, PNorm = 60.4198, GNorm = 0.2979, lr_0 = 9.0547e-04
Loss = 4.9888e-03, PNorm = 60.4765, GNorm = 0.4199, lr_0 = 8.9153e-04
Loss = 4.0951e-03, PNorm = 60.5555, GNorm = 0.6055, lr_0 = 8.7780e-04
Loss = 4.1088e-03, PNorm = 60.6394, GNorm = 0.2876, lr_0 = 8.6429e-04
Loss = 3.9223e-03, PNorm = 60.7086, GNorm = 0.5536, lr_0 = 8.5098e-04
Validation auc = 0.797900
Epoch 4
Loss = 3.8349e-03, PNorm = 60.8081, GNorm = 1.1508, lr_0 = 8.3788e-04
Loss = 3.6931e-03, PNorm = 60.9184, GNorm = 0.2117, lr_0 = 8.2498e-04
Loss = 5.0114e-03, PNorm = 61.0091, GNorm = 0.5336, lr_0 = 8.1228e-04
Loss = 3.7966e-03, PNorm = 61.1099, GNorm = 0.2867, lr_0 = 7.9977e-04
Loss = 3.2297e-03, PNorm = 61.1921, GNorm = 0.6281, lr_0 = 7.8746e-04
Validation auc = 0.853513
Epoch 5
Loss = 3.7280e-03, PNorm = 61.2663, GNorm = 0.6985, lr_0 = 7.7533e-04
Loss = 3.4550e-03, PNorm = 61.3415, GNorm = 0.4323, lr_0 = 7.6340e-04
Loss = 3.3163e-03, PNorm = 61.4256, GNorm = 0.2912, lr_0 = 7.5164e-04
Loss = 2.4458e-03, PNorm = 61.5171, GNorm = 0.4839, lr_0 = 7.4007e-04
Loss = 3.2725e-03, PNorm = 61.6035, GNorm = 0.6877, lr_0 = 7.2867e-04
Validation auc = 0.848976
Epoch 6
Loss = 2.6835e-03, PNorm = 61.6816, GNorm = 0.3067, lr_0 = 7.1746e-04
Loss = 2.9204e-03, PNorm = 61.7845, GNorm = 0.3162, lr_0 = 7.0641e-04
Loss = 2.8080e-03, PNorm = 61.8701, GNorm = 0.3728, lr_0 = 6.9553e-04
Loss = 2.6606e-03, PNorm = 61.9409, GNorm = 0.6917, lr_0 = 6.8482e-04
Loss = 3.1037e-03, PNorm = 62.0187, GNorm = 0.8800, lr_0 = 6.7428e-04
Loss = 3.7642e-03, PNorm = 62.0988, GNorm = 0.4493, lr_0 = 6.6390e-04
Validation auc = 0.862458
Epoch 7
Loss = 3.4874e-03, PNorm = 62.1911, GNorm = 0.4693, lr_0 = 6.5368e-04
Loss = 2.1481e-03, PNorm = 62.2852, GNorm = 0.4193, lr_0 = 6.4361e-04
Loss = 2.2970e-03, PNorm = 62.3524, GNorm = 0.8701, lr_0 = 6.3370e-04
Loss = 3.3752e-03, PNorm = 62.4408, GNorm = 0.3442, lr_0 = 6.2395e-04
Loss = 2.5036e-03, PNorm = 62.5281, GNorm = 0.5527, lr_0 = 6.1434e-04
Validation auc = 0.878014
Epoch 8
Loss = 2.4752e-03, PNorm = 62.5978, GNorm = 0.2869, lr_0 = 6.0488e-04
Loss = 2.7076e-03, PNorm = 62.6768, GNorm = 0.5223, lr_0 = 5.9557e-04
Loss = 2.1854e-03, PNorm = 62.7492, GNorm = 0.5437, lr_0 = 5.8640e-04
Loss = 2.9776e-03, PNorm = 62.8260, GNorm = 0.3855, lr_0 = 5.7737e-04
Loss = 2.3720e-03, PNorm = 62.9085, GNorm = 0.3907, lr_0 = 5.6848e-04
Validation auc = 0.888903
Epoch 9
Loss = 2.7500e-03, PNorm = 62.9833, GNorm = 0.3801, lr_0 = 5.5973e-04
Loss = 1.9245e-03, PNorm = 63.0610, GNorm = 0.6291, lr_0 = 5.5111e-04
Loss = 2.7508e-03, PNorm = 63.1479, GNorm = 0.3532, lr_0 = 5.4263e-04
Loss = 1.9123e-03, PNorm = 63.2311, GNorm = 0.4574, lr_0 = 5.3427e-04
Loss = 2.8916e-03, PNorm = 63.2958, GNorm = 0.3528, lr_0 = 5.2605e-04
Loss = 2.1365e-03, PNorm = 63.3688, GNorm = 0.3437, lr_0 = 5.1795e-04
Validation auc = 0.891626
Epoch 10
Loss = 2.1563e-03, PNorm = 63.4483, GNorm = 0.5532, lr_0 = 5.0997e-04
Loss = 2.6205e-03, PNorm = 63.5119, GNorm = 0.3977, lr_0 = 5.0212e-04
Loss = 1.7401e-03, PNorm = 63.5828, GNorm = 0.2773, lr_0 = 4.9439e-04
Loss = 2.0654e-03, PNorm = 63.6308, GNorm = 0.4023, lr_0 = 4.8678e-04
Loss = 2.2582e-03, PNorm = 63.6990, GNorm = 0.7454, lr_0 = 4.7928e-04
Validation auc = 0.888644
Epoch 11
Loss = 3.1414e-03, PNorm = 63.7776, GNorm = 0.5204, lr_0 = 4.7190e-04
Loss = 2.3143e-03, PNorm = 63.8634, GNorm = 0.6839, lr_0 = 4.6464e-04
Loss = 2.0676e-03, PNorm = 63.9260, GNorm = 0.1946, lr_0 = 4.5749e-04
Loss = 1.8463e-03, PNorm = 63.9857, GNorm = 0.4208, lr_0 = 4.5044e-04
Loss = 1.6668e-03, PNorm = 64.0302, GNorm = 0.2612, lr_0 = 4.4351e-04
Validation auc = 0.886959
Epoch 12
Loss = 1.5574e-03, PNorm = 64.0903, GNorm = 0.0997, lr_0 = 4.3668e-04
Loss = 1.9798e-03, PNorm = 64.1491, GNorm = 0.2692, lr_0 = 4.2996e-04
Loss = 1.9366e-03, PNorm = 64.2111, GNorm = 0.3908, lr_0 = 4.2334e-04
Loss = 1.3740e-03, PNorm = 64.2723, GNorm = 0.7668, lr_0 = 4.1682e-04
Loss = 2.3373e-03, PNorm = 64.3232, GNorm = 0.4316, lr_0 = 4.1040e-04
Validation auc = 0.901607
Epoch 13
Loss = 5.1125e-04, PNorm = 64.3716, GNorm = 0.3200, lr_0 = 4.0408e-04
Loss = 1.9827e-03, PNorm = 64.4129, GNorm = 0.3618, lr_0 = 3.9786e-04
Loss = 1.7034e-03, PNorm = 64.4560, GNorm = 0.5022, lr_0 = 3.9173e-04
Loss = 1.6006e-03, PNorm = 64.5077, GNorm = 0.6135, lr_0 = 3.8570e-04
Loss = 1.4073e-03, PNorm = 64.5579, GNorm = 1.5171, lr_0 = 3.7976e-04
Loss = 1.7789e-03, PNorm = 64.6032, GNorm = 0.4525, lr_0 = 3.7392e-04
Validation auc = 0.877495
Epoch 14
Loss = 1.5532e-03, PNorm = 64.6536, GNorm = 0.4905, lr_0 = 3.6816e-04
Loss = 1.4878e-03, PNorm = 64.7193, GNorm = 0.5801, lr_0 = 3.6249e-04
Loss = 2.2013e-03, PNorm = 64.7755, GNorm = 0.5299, lr_0 = 3.5691e-04
Loss = 1.5748e-03, PNorm = 64.8239, GNorm = 0.6526, lr_0 = 3.5142e-04
Loss = 2.1215e-03, PNorm = 64.8582, GNorm = 0.4672, lr_0 = 3.4601e-04
Validation auc = 0.918071
Epoch 15
Loss = 1.6658e-03, PNorm = 64.9057, GNorm = 0.6962, lr_0 = 3.4068e-04
Loss = 1.5270e-03, PNorm = 64.9409, GNorm = 0.3923, lr_0 = 3.3543e-04
Loss = 1.4031e-03, PNorm = 64.9832, GNorm = 0.3515, lr_0 = 3.3027e-04
Loss = 1.1698e-03, PNorm = 65.0190, GNorm = 0.8709, lr_0 = 3.2518e-04
Loss = 1.7568e-03, PNorm = 65.0567, GNorm = 0.9157, lr_0 = 3.2018e-04
Validation auc = 0.897070
Epoch 16
Loss = 1.5112e-03, PNorm = 65.0985, GNorm = 0.2262, lr_0 = 3.1525e-04
Loss = 1.3896e-03, PNorm = 65.1296, GNorm = 0.4750, lr_0 = 3.1039e-04
Loss = 1.0543e-03, PNorm = 65.1639, GNorm = 0.7763, lr_0 = 3.0562e-04
Loss = 8.9716e-04, PNorm = 65.1934, GNorm = 0.1459, lr_0 = 3.0091e-04
Loss = 1.0923e-03, PNorm = 65.2237, GNorm = 0.2832, lr_0 = 2.9628e-04
Loss = 2.5559e-03, PNorm = 65.2430, GNorm = 0.7467, lr_0 = 2.9172e-04
Validation auc = 0.897459
Epoch 17
Loss = 1.2792e-03, PNorm = 65.2933, GNorm = 0.1950, lr_0 = 2.8722e-04
Loss = 1.3905e-03, PNorm = 65.3322, GNorm = 0.7968, lr_0 = 2.8280e-04
Loss = 1.5143e-03, PNorm = 65.3602, GNorm = 0.8380, lr_0 = 2.7845e-04
Loss = 1.1767e-03, PNorm = 65.3926, GNorm = 0.0914, lr_0 = 2.7416e-04
Loss = 1.4517e-03, PNorm = 65.4187, GNorm = 0.2082, lr_0 = 2.6994e-04
Validation auc = 0.903293
Epoch 18
Loss = 7.5911e-04, PNorm = 65.4458, GNorm = 0.6098, lr_0 = 2.6578e-04
Loss = 1.1125e-03, PNorm = 65.4734, GNorm = 0.4990, lr_0 = 2.6169e-04
Loss = 7.5371e-04, PNorm = 65.4964, GNorm = 0.5899, lr_0 = 2.5766e-04
Loss = 1.4331e-03, PNorm = 65.5211, GNorm = 0.3661, lr_0 = 2.5370e-04
Loss = 1.6588e-03, PNorm = 65.5484, GNorm = 0.4218, lr_0 = 2.4979e-04
Validation auc = 0.886700
Epoch 19
Loss = 9.9947e-04, PNorm = 65.5738, GNorm = 0.2692, lr_0 = 2.4594e-04
Loss = 1.0399e-03, PNorm = 65.6055, GNorm = 0.5005, lr_0 = 2.4216e-04
Loss = 1.4857e-03, PNorm = 65.6338, GNorm = 0.0554, lr_0 = 2.3843e-04
Loss = 1.0098e-03, PNorm = 65.6519, GNorm = 0.3792, lr_0 = 2.3476e-04
Loss = 1.4464e-03, PNorm = 65.6712, GNorm = 0.5168, lr_0 = 2.3114e-04
Loss = 9.2790e-04, PNorm = 65.6931, GNorm = 0.3836, lr_0 = 2.2758e-04
Validation auc = 0.907441
Epoch 20
Loss = 1.1025e-03, PNorm = 65.7211, GNorm = 0.1780, lr_0 = 2.2408e-04
Loss = 1.0883e-03, PNorm = 65.7463, GNorm = 0.4033, lr_0 = 2.2063e-04
Loss = 5.7375e-04, PNorm = 65.7632, GNorm = 0.1238, lr_0 = 2.1723e-04
Loss = 9.1384e-04, PNorm = 65.7833, GNorm = 0.6848, lr_0 = 2.1389e-04
Loss = 1.7544e-03, PNorm = 65.7952, GNorm = 1.0965, lr_0 = 2.1060e-04
Validation auc = 0.889551
Epoch 21
Loss = 1.1218e-03, PNorm = 65.8220, GNorm = 0.7314, lr_0 = 2.0735e-04
Loss = 1.1337e-03, PNorm = 65.8568, GNorm = 0.7052, lr_0 = 2.0416e-04
Loss = 9.5622e-04, PNorm = 65.8783, GNorm = 0.5702, lr_0 = 2.0102e-04
Loss = 1.0331e-03, PNorm = 65.9151, GNorm = 0.1460, lr_0 = 1.9792e-04
Loss = 1.2279e-03, PNorm = 65.9314, GNorm = 0.5641, lr_0 = 1.9488e-04
Validation auc = 0.911330
Epoch 22
Loss = 5.9160e-04, PNorm = 65.9565, GNorm = 0.2870, lr_0 = 1.9188e-04
Loss = 9.4879e-04, PNorm = 65.9772, GNorm = 0.2227, lr_0 = 1.8892e-04
Loss = 1.1600e-03, PNorm = 65.9905, GNorm = 1.1616, lr_0 = 1.8601e-04
Loss = 1.2264e-03, PNorm = 66.0082, GNorm = 0.7307, lr_0 = 1.8315e-04
Loss = 1.0931e-03, PNorm = 66.0215, GNorm = 1.0620, lr_0 = 1.8033e-04
Validation auc = 0.915349
Epoch 23
Loss = 1.2433e-03, PNorm = 66.0368, GNorm = 0.7250, lr_0 = 1.7755e-04
Loss = 5.9833e-04, PNorm = 66.0563, GNorm = 0.8894, lr_0 = 1.7482e-04
Loss = 1.0615e-03, PNorm = 66.0755, GNorm = 0.7797, lr_0 = 1.7213e-04
Loss = 9.4229e-04, PNorm = 66.0966, GNorm = 0.5130, lr_0 = 1.6948e-04
Loss = 6.8465e-04, PNorm = 66.1122, GNorm = 0.3982, lr_0 = 1.6687e-04
Loss = 8.4440e-04, PNorm = 66.1273, GNorm = 0.2058, lr_0 = 1.6430e-04
Validation auc = 0.920016
Epoch 24
Loss = 6.3816e-04, PNorm = 66.1388, GNorm = 0.1565, lr_0 = 1.6177e-04
Loss = 8.3491e-04, PNorm = 66.1520, GNorm = 0.7188, lr_0 = 1.5928e-04
Loss = 8.2076e-04, PNorm = 66.1648, GNorm = 0.6015, lr_0 = 1.5683e-04
Loss = 8.3272e-04, PNorm = 66.1805, GNorm = 0.0420, lr_0 = 1.5441e-04
Loss = 9.2084e-04, PNorm = 66.1957, GNorm = 0.4700, lr_0 = 1.5203e-04
Validation auc = 0.905108
Epoch 25
Loss = 4.3429e-04, PNorm = 66.2095, GNorm = 0.5008, lr_0 = 1.4969e-04
Loss = 8.1928e-04, PNorm = 66.2170, GNorm = 0.9239, lr_0 = 1.4739e-04
Loss = 1.3357e-03, PNorm = 66.2278, GNorm = 0.2123, lr_0 = 1.4512e-04
Loss = 1.0654e-03, PNorm = 66.2523, GNorm = 0.1770, lr_0 = 1.4288e-04
Loss = 8.3302e-04, PNorm = 66.2647, GNorm = 0.6179, lr_0 = 1.4069e-04
Validation auc = 0.908089
Epoch 26
Loss = 4.7681e-04, PNorm = 66.2795, GNorm = 0.0971, lr_0 = 1.3852e-04
Loss = 6.8296e-04, PNorm = 66.2902, GNorm = 0.3803, lr_0 = 1.3639e-04
Loss = 7.7077e-04, PNorm = 66.3019, GNorm = 0.3300, lr_0 = 1.3429e-04
Loss = 5.6787e-04, PNorm = 66.3151, GNorm = 0.2036, lr_0 = 1.3222e-04
Loss = 6.7175e-04, PNorm = 66.3242, GNorm = 0.1048, lr_0 = 1.3018e-04
Loss = 1.1387e-03, PNorm = 66.3326, GNorm = 0.4836, lr_0 = 1.2818e-04
Validation auc = 0.905885
Epoch 27
Loss = 4.9239e-04, PNorm = 66.3485, GNorm = 0.1012, lr_0 = 1.2621e-04
Loss = 4.6595e-04, PNorm = 66.3604, GNorm = 0.2113, lr_0 = 1.2426e-04
Loss = 1.0211e-03, PNorm = 66.3701, GNorm = 1.6455, lr_0 = 1.2235e-04
Loss = 9.8983e-04, PNorm = 66.3753, GNorm = 0.7066, lr_0 = 1.2047e-04
Loss = 6.4781e-04, PNorm = 66.3899, GNorm = 0.1731, lr_0 = 1.1861e-04
Validation auc = 0.907700
Epoch 28
Loss = 1.3645e-03, PNorm = 66.3928, GNorm = 0.9190, lr_0 = 1.1678e-04
Loss = 4.8733e-04, PNorm = 66.4050, GNorm = 0.0417, lr_0 = 1.1499e-04
Loss = 7.2228e-04, PNorm = 66.4144, GNorm = 0.6298, lr_0 = 1.1322e-04
Loss = 5.7594e-04, PNorm = 66.4199, GNorm = 0.4785, lr_0 = 1.1147e-04
Loss = 7.7569e-04, PNorm = 66.4274, GNorm = 1.0723, lr_0 = 1.0976e-04
Validation auc = 0.909904
Epoch 29
Loss = 2.9548e-04, PNorm = 66.4401, GNorm = 0.5258, lr_0 = 1.0807e-04
Loss = 6.0198e-04, PNorm = 66.4460, GNorm = 0.2378, lr_0 = 1.0640e-04
Loss = 6.2274e-04, PNorm = 66.4573, GNorm = 0.2257, lr_0 = 1.0476e-04
Loss = 5.5543e-04, PNorm = 66.4692, GNorm = 0.1737, lr_0 = 1.0315e-04
Loss = 9.2898e-04, PNorm = 66.4750, GNorm = 0.3734, lr_0 = 1.0156e-04
Loss = 6.3920e-04, PNorm = 66.4851, GNorm = 0.4944, lr_0 = 1.0000e-04
Validation auc = 0.909645
Model 0 best validation auc = 0.920016 on epoch 23
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test auc = nan
Ensemble test auc = nan
Fold 5
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': '../../../swansonk/chemprop_ckpt/0406_inhibition_hyperopt.json',
 'cuda': True,
 'data_path': '../../broad2/larger_dataset/0405_inhibition_dedup_binary.csv',
 'dataset_type': 'classification',
 'depth': 5,
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_dim': 200,
 'features_generator': None,
 'features_only': False,
 'features_path': ['../../saved_features/0405_broad_inhibition.npz'],
 'features_scaling': False,
 'features_size': 200,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 1600,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'no_cache': False,
 'num_folds': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'output_size': 1,
 'quiet': True,
 'save_dir': '../ckpt/0405_broad_inhibition_20folds/fold_5',
 'save_smiles_splits': False,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'task_names': ['50uM_Inhibition'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 2654,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': ['../../saved_features/0405_broad_inhibition.npz'],
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Class sizes
50uM_Inhibition 0: 91.93%, 1: 8.07%
Total size = 2,949 | train size = 2,654 | val size = 295 | test size = 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1600, bias=False)
      (W_h): Linear(in_features=1600, out_features=1600, bias=False)
      (W_o): Linear(in_features=1733, out_features=1600, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,571,401
Moving model to cuda
Epoch 0
Loss = 7.8033e-03, PNorm = 59.4538, GNorm = 0.7462, lr_0 = 1.8491e-04
Loss = 5.9113e-03, PNorm = 59.4678, GNorm = 0.4082, lr_0 = 2.6981e-04
Loss = 5.0083e-03, PNorm = 59.4838, GNorm = 0.7469, lr_0 = 3.5472e-04
Loss = 6.0211e-03, PNorm = 59.5062, GNorm = 0.7385, lr_0 = 4.3962e-04
Loss = 4.1895e-03, PNorm = 59.5372, GNorm = 0.8559, lr_0 = 5.2453e-04
Validation auc = 0.735075
Epoch 1
Loss = 5.5580e-03, PNorm = 59.5708, GNorm = 1.3144, lr_0 = 6.0943e-04
Loss = 5.7920e-03, PNorm = 59.6184, GNorm = 0.4268, lr_0 = 6.9434e-04
Loss = 4.6405e-03, PNorm = 59.6812, GNorm = 0.2467, lr_0 = 7.7925e-04
Loss = 4.7472e-03, PNorm = 59.7465, GNorm = 0.6450, lr_0 = 8.6415e-04
Loss = 4.2152e-03, PNorm = 59.8340, GNorm = 0.2599, lr_0 = 9.4906e-04
Validation auc = 0.782615
Epoch 2
Loss = 4.0668e-03, PNorm = 59.9323, GNorm = 0.5104, lr_0 = 9.9381e-04
Loss = 4.6446e-03, PNorm = 60.0343, GNorm = 0.3910, lr_0 = 9.7851e-04
Loss = 4.1737e-03, PNorm = 60.1333, GNorm = 0.5571, lr_0 = 9.6345e-04
Loss = 4.5764e-03, PNorm = 60.2168, GNorm = 0.4704, lr_0 = 9.4861e-04
Loss = 3.5535e-03, PNorm = 60.3125, GNorm = 0.3253, lr_0 = 9.3401e-04
Validation auc = 0.819928
Epoch 3
Loss = 3.9966e-03, PNorm = 60.3980, GNorm = 0.8002, lr_0 = 9.1963e-04
Loss = 3.6846e-03, PNorm = 60.4897, GNorm = 0.4456, lr_0 = 9.0547e-04
Loss = 4.0539e-03, PNorm = 60.5828, GNorm = 0.4053, lr_0 = 8.9153e-04
Loss = 3.7504e-03, PNorm = 60.6797, GNorm = 0.3319, lr_0 = 8.7780e-04
Loss = 2.9458e-03, PNorm = 60.7724, GNorm = 0.3595, lr_0 = 8.6429e-04
Loss = 3.8356e-03, PNorm = 60.8703, GNorm = 1.7339, lr_0 = 8.5098e-04
Validation auc = 0.809425
Epoch 4
Loss = 4.1451e-03, PNorm = 60.9655, GNorm = 0.3599, lr_0 = 8.3788e-04
Loss = 4.3332e-03, PNorm = 61.0720, GNorm = 0.4858, lr_0 = 8.2498e-04
Loss = 3.1497e-03, PNorm = 61.1753, GNorm = 0.1886, lr_0 = 8.1228e-04
Loss = 3.2104e-03, PNorm = 61.2710, GNorm = 0.9448, lr_0 = 7.9977e-04
Loss = 3.0339e-03, PNorm = 61.3614, GNorm = 1.2543, lr_0 = 7.8746e-04
Validation auc = 0.831675
Epoch 5
Loss = 3.2490e-03, PNorm = 61.4432, GNorm = 0.3830, lr_0 = 7.7533e-04
Loss = 2.6196e-03, PNorm = 61.5315, GNorm = 0.8266, lr_0 = 7.6340e-04
Loss = 3.3369e-03, PNorm = 61.6062, GNorm = 0.3396, lr_0 = 7.5164e-04
Loss = 2.5478e-03, PNorm = 61.7006, GNorm = 0.3370, lr_0 = 7.4007e-04
Loss = 3.1563e-03, PNorm = 61.7775, GNorm = 1.2396, lr_0 = 7.2867e-04
Validation auc = 0.856965
Epoch 6
Loss = 3.4219e-03, PNorm = 61.8863, GNorm = 1.0188, lr_0 = 7.1746e-04
Loss = 2.7966e-03, PNorm = 61.9824, GNorm = 0.2858, lr_0 = 7.0641e-04
Loss = 2.0951e-03, PNorm = 62.0758, GNorm = 0.4487, lr_0 = 6.9553e-04
Loss = 2.5689e-03, PNorm = 62.1527, GNorm = 0.7428, lr_0 = 6.8482e-04
Loss = 3.2691e-03, PNorm = 62.2239, GNorm = 0.3413, lr_0 = 6.7428e-04
Loss = 2.8668e-03, PNorm = 62.3094, GNorm = 0.2383, lr_0 = 6.6390e-04
Validation auc = 0.885849
Epoch 7
Loss = 2.4008e-03, PNorm = 62.3928, GNorm = 0.4046, lr_0 = 6.5368e-04
Loss = 2.2253e-03, PNorm = 62.4779, GNorm = 0.5482, lr_0 = 6.4361e-04
Loss = 2.5899e-03, PNorm = 62.5635, GNorm = 0.6299, lr_0 = 6.3370e-04
Loss = 2.8349e-03, PNorm = 62.6440, GNorm = 0.2828, lr_0 = 6.2395e-04
Loss = 2.7921e-03, PNorm = 62.7177, GNorm = 0.8180, lr_0 = 6.1434e-04
Validation auc = 0.908237
Epoch 8
Loss = 2.2147e-03, PNorm = 62.7769, GNorm = 0.4846, lr_0 = 6.0488e-04
Loss = 2.1252e-03, PNorm = 62.8607, GNorm = 0.3164, lr_0 = 5.9557e-04
Loss = 2.1579e-03, PNorm = 62.9402, GNorm = 0.2449, lr_0 = 5.8640e-04
Loss = 2.1760e-03, PNorm = 63.0048, GNorm = 1.2771, lr_0 = 5.7737e-04
Loss = 2.8772e-03, PNorm = 63.0541, GNorm = 0.4031, lr_0 = 5.6848e-04
Validation auc = 0.848535
Epoch 9
Loss = 3.7650e-03, PNorm = 63.1349, GNorm = 0.3539, lr_0 = 5.5973e-04
Loss = 2.1167e-03, PNorm = 63.1998, GNorm = 0.7311, lr_0 = 5.5111e-04
Loss = 2.3053e-03, PNorm = 63.2707, GNorm = 0.5416, lr_0 = 5.4263e-04
Loss = 1.7272e-03, PNorm = 63.3394, GNorm = 0.2317, lr_0 = 5.3427e-04
Loss = 1.7531e-03, PNorm = 63.3893, GNorm = 1.0843, lr_0 = 5.2605e-04
Loss = 2.0166e-03, PNorm = 63.4453, GNorm = 0.3036, lr_0 = 5.1795e-04
Validation auc = 0.885434
Epoch 10
Loss = 1.8918e-03, PNorm = 63.5151, GNorm = 0.1760, lr_0 = 5.0997e-04
Loss = 1.9616e-03, PNorm = 63.5710, GNorm = 0.6897, lr_0 = 5.0212e-04
Loss = 2.5685e-03, PNorm = 63.6343, GNorm = 0.4743, lr_0 = 4.9439e-04
Loss = 2.0198e-03, PNorm = 63.6989, GNorm = 0.4219, lr_0 = 4.8678e-04
Loss = 1.4078e-03, PNorm = 63.7639, GNorm = 1.0059, lr_0 = 4.7928e-04
Validation auc = 0.885434
Epoch 11
Loss = 1.7214e-03, PNorm = 63.8112, GNorm = 2.2433, lr_0 = 4.7190e-04
Loss = 2.2433e-03, PNorm = 63.8585, GNorm = 0.4383, lr_0 = 4.6464e-04
Loss = 1.4801e-03, PNorm = 63.9274, GNorm = 0.5129, lr_0 = 4.5749e-04
Loss = 1.9413e-03, PNorm = 63.9714, GNorm = 0.7111, lr_0 = 4.5044e-04
Loss = 1.6520e-03, PNorm = 64.0273, GNorm = 0.2509, lr_0 = 4.4351e-04
Validation auc = 0.890685
Epoch 12
Loss = 2.1141e-03, PNorm = 64.0648, GNorm = 1.2436, lr_0 = 4.3668e-04
Loss = 1.7066e-03, PNorm = 64.1193, GNorm = 0.3443, lr_0 = 4.2996e-04
Loss = 1.6983e-03, PNorm = 64.1722, GNorm = 0.7908, lr_0 = 4.2334e-04
Loss = 1.5111e-03, PNorm = 64.2213, GNorm = 0.4971, lr_0 = 4.1682e-04
Loss = 1.5952e-03, PNorm = 64.2567, GNorm = 0.4436, lr_0 = 4.1040e-04
Validation auc = 0.885296
Epoch 13
Loss = 3.5246e-03, PNorm = 64.2952, GNorm = 0.8358, lr_0 = 4.0408e-04
Loss = 9.7583e-04, PNorm = 64.3561, GNorm = 0.5316, lr_0 = 3.9786e-04
Loss = 1.8493e-03, PNorm = 64.3927, GNorm = 0.8755, lr_0 = 3.9173e-04
Loss = 1.4291e-03, PNorm = 64.4440, GNorm = 0.8295, lr_0 = 3.8570e-04
Loss = 9.0612e-04, PNorm = 64.4867, GNorm = 0.5888, lr_0 = 3.7976e-04
Loss = 1.5911e-03, PNorm = 64.5178, GNorm = 0.2475, lr_0 = 3.7392e-04
Validation auc = 0.877280
Epoch 14
Loss = 1.5370e-03, PNorm = 64.5570, GNorm = 0.3877, lr_0 = 3.6816e-04
Loss = 1.2473e-03, PNorm = 64.5966, GNorm = 0.7345, lr_0 = 3.6249e-04
Loss = 1.3702e-03, PNorm = 64.6356, GNorm = 0.6174, lr_0 = 3.5691e-04
Loss = 8.2140e-04, PNorm = 64.6760, GNorm = 0.3589, lr_0 = 3.5142e-04
Loss = 1.2084e-03, PNorm = 64.7115, GNorm = 1.0271, lr_0 = 3.4601e-04
Validation auc = 0.872305
Epoch 15
Loss = 9.6141e-04, PNorm = 64.7526, GNorm = 0.4789, lr_0 = 3.4068e-04
Loss = 2.0233e-03, PNorm = 64.7981, GNorm = 0.5887, lr_0 = 3.3543e-04
Loss = 1.1704e-03, PNorm = 64.8434, GNorm = 0.6764, lr_0 = 3.3027e-04
Loss = 1.2564e-03, PNorm = 64.8904, GNorm = 0.2144, lr_0 = 3.2518e-04
Loss = 1.2576e-03, PNorm = 64.9283, GNorm = 0.2839, lr_0 = 3.2018e-04
Validation auc = 0.880597
Epoch 16
Loss = 5.2081e-04, PNorm = 64.9643, GNorm = 0.3575, lr_0 = 3.1525e-04
Loss = 1.1893e-03, PNorm = 64.9973, GNorm = 0.1345, lr_0 = 3.1039e-04
Loss = 1.0539e-03, PNorm = 65.0283, GNorm = 0.2996, lr_0 = 3.0562e-04
Loss = 1.2812e-03, PNorm = 65.0560, GNorm = 1.0671, lr_0 = 3.0091e-04
Loss = 1.9691e-03, PNorm = 65.0948, GNorm = 0.9044, lr_0 = 2.9628e-04
Loss = 1.4091e-03, PNorm = 65.1367, GNorm = 0.4828, lr_0 = 2.9172e-04
Validation auc = 0.860697
Epoch 17
Loss = 1.1674e-03, PNorm = 65.1782, GNorm = 0.1861, lr_0 = 2.8722e-04
Loss = 1.2757e-03, PNorm = 65.2116, GNorm = 0.2947, lr_0 = 2.8280e-04
Loss = 1.0508e-03, PNorm = 65.2441, GNorm = 0.5014, lr_0 = 2.7845e-04
Loss = 5.9766e-04, PNorm = 65.2738, GNorm = 0.4327, lr_0 = 2.7416e-04
Loss = 9.0677e-04, PNorm = 65.2937, GNorm = 0.6101, lr_0 = 2.6994e-04
Validation auc = 0.877971
Epoch 18
Loss = 5.1525e-04, PNorm = 65.3215, GNorm = 0.2715, lr_0 = 2.6578e-04
Loss = 6.7433e-04, PNorm = 65.3466, GNorm = 0.1359, lr_0 = 2.6169e-04
Loss = 7.5102e-04, PNorm = 65.3693, GNorm = 0.3361, lr_0 = 2.5766e-04
Loss = 1.1545e-03, PNorm = 65.3945, GNorm = 0.2845, lr_0 = 2.5370e-04
Loss = 1.4020e-03, PNorm = 65.4194, GNorm = 1.1316, lr_0 = 2.4979e-04
Validation auc = 0.873825
Epoch 19
Loss = 1.0988e-03, PNorm = 65.4506, GNorm = 0.5858, lr_0 = 2.4594e-04
Loss = 1.0385e-03, PNorm = 65.4746, GNorm = 0.6564, lr_0 = 2.4216e-04
Loss = 8.6962e-04, PNorm = 65.5040, GNorm = 0.9273, lr_0 = 2.3843e-04
Loss = 8.2060e-04, PNorm = 65.5230, GNorm = 0.3431, lr_0 = 2.3476e-04
Loss = 9.1636e-04, PNorm = 65.5464, GNorm = 0.4931, lr_0 = 2.3114e-04
Loss = 9.8880e-04, PNorm = 65.5709, GNorm = 0.1339, lr_0 = 2.2758e-04
Validation auc = 0.872305
Epoch 20
Loss = 6.7574e-04, PNorm = 65.5907, GNorm = 0.2148, lr_0 = 2.2408e-04
Loss = 7.5785e-04, PNorm = 65.6135, GNorm = 0.2838, lr_0 = 2.2063e-04
Loss = 7.5947e-04, PNorm = 65.6287, GNorm = 0.5807, lr_0 = 2.1723e-04
Loss = 8.9632e-04, PNorm = 65.6517, GNorm = 0.4718, lr_0 = 2.1389e-04
Loss = 1.2417e-03, PNorm = 65.6679, GNorm = 0.8539, lr_0 = 2.1060e-04
Validation auc = 0.864704
Epoch 21
Loss = 1.2465e-03, PNorm = 65.6900, GNorm = 0.6593, lr_0 = 2.0735e-04
Loss = 7.0563e-04, PNorm = 65.7132, GNorm = 0.6064, lr_0 = 2.0416e-04
Loss = 5.9561e-04, PNorm = 65.7392, GNorm = 0.1378, lr_0 = 2.0102e-04
Loss = 6.1810e-04, PNorm = 65.7548, GNorm = 1.1770, lr_0 = 1.9792e-04
Loss = 5.1336e-04, PNorm = 65.7665, GNorm = 0.0888, lr_0 = 1.9488e-04
Validation auc = 0.858762
Epoch 22
Loss = 4.2177e-04, PNorm = 65.7861, GNorm = 0.0713, lr_0 = 1.9188e-04
Loss = 5.9339e-04, PNorm = 65.8054, GNorm = 0.7745, lr_0 = 1.8892e-04
Loss = 6.0898e-04, PNorm = 65.8232, GNorm = 0.2402, lr_0 = 1.8601e-04
Loss = 7.3578e-04, PNorm = 65.8397, GNorm = 0.4908, lr_0 = 1.8315e-04
Loss = 9.3054e-04, PNorm = 65.8548, GNorm = 0.4723, lr_0 = 1.8033e-04
Validation auc = 0.860973
Epoch 23
Loss = 2.7692e-03, PNorm = 65.8711, GNorm = 0.8989, lr_0 = 1.7755e-04
Loss = 6.6966e-04, PNorm = 65.8818, GNorm = 0.1634, lr_0 = 1.7482e-04
Loss = 5.0904e-04, PNorm = 65.9018, GNorm = 0.9227, lr_0 = 1.7213e-04
Loss = 5.8008e-04, PNorm = 65.9151, GNorm = 1.0793, lr_0 = 1.6948e-04
Loss = 7.5929e-04, PNorm = 65.9268, GNorm = 0.5389, lr_0 = 1.6687e-04
Loss = 4.8386e-04, PNorm = 65.9436, GNorm = 0.0460, lr_0 = 1.6430e-04
Validation auc = 0.875484
Epoch 24
Loss = 5.4070e-04, PNorm = 65.9548, GNorm = 0.5119, lr_0 = 1.6177e-04
Loss = 6.4833e-04, PNorm = 65.9741, GNorm = 0.1329, lr_0 = 1.5928e-04
Loss = 5.3713e-04, PNorm = 65.9837, GNorm = 0.6864, lr_0 = 1.5683e-04
Loss = 8.9547e-04, PNorm = 65.9984, GNorm = 1.2190, lr_0 = 1.5441e-04
Loss = 5.9909e-04, PNorm = 66.0086, GNorm = 0.4851, lr_0 = 1.5203e-04
Validation auc = 0.870232
Epoch 25
Loss = 8.5251e-04, PNorm = 66.0198, GNorm = 0.4690, lr_0 = 1.4969e-04
Loss = 7.0039e-04, PNorm = 66.0326, GNorm = 0.7553, lr_0 = 1.4739e-04
Loss = 3.4078e-04, PNorm = 66.0462, GNorm = 0.3111, lr_0 = 1.4512e-04
Loss = 6.8014e-04, PNorm = 66.0525, GNorm = 0.1872, lr_0 = 1.4288e-04
Loss = 8.6567e-04, PNorm = 66.0636, GNorm = 0.6489, lr_0 = 1.4069e-04
Validation auc = 0.864013
Epoch 26
Loss = 3.8861e-04, PNorm = 66.0755, GNorm = 0.4594, lr_0 = 1.3852e-04
Loss = 4.0894e-04, PNorm = 66.0836, GNorm = 0.4943, lr_0 = 1.3639e-04
Loss = 6.9207e-04, PNorm = 66.0930, GNorm = 0.1182, lr_0 = 1.3429e-04
Loss = 6.3492e-04, PNorm = 66.1042, GNorm = 0.0493, lr_0 = 1.3222e-04
Loss = 5.2428e-04, PNorm = 66.1146, GNorm = 0.3947, lr_0 = 1.3018e-04
Loss = 3.9209e-04, PNorm = 66.1237, GNorm = 0.1232, lr_0 = 1.2818e-04
Validation auc = 0.863184
Epoch 27
Loss = 4.7992e-04, PNorm = 66.1295, GNorm = 0.0366, lr_0 = 1.2621e-04
Loss = 6.5856e-04, PNorm = 66.1329, GNorm = 0.1319, lr_0 = 1.2426e-04
Loss = 7.4362e-04, PNorm = 66.1426, GNorm = 0.5578, lr_0 = 1.2235e-04
Loss = 5.8422e-04, PNorm = 66.1473, GNorm = 0.0500, lr_0 = 1.2047e-04
Loss = 5.6453e-04, PNorm = 66.1574, GNorm = 0.6513, lr_0 = 1.1861e-04
Validation auc = 0.862493
Epoch 28
Loss = 3.4701e-04, PNorm = 66.1670, GNorm = 0.5796, lr_0 = 1.1678e-04
Loss = 5.6694e-04, PNorm = 66.1719, GNorm = 0.7641, lr_0 = 1.1499e-04
Loss = 3.8781e-04, PNorm = 66.1781, GNorm = 0.2158, lr_0 = 1.1322e-04
Loss = 2.1095e-04, PNorm = 66.1869, GNorm = 0.2046, lr_0 = 1.1147e-04
Loss = 5.7576e-04, PNorm = 66.1920, GNorm = 0.1936, lr_0 = 1.0976e-04
Validation auc = 0.862078
Epoch 29
Loss = 2.6865e-04, PNorm = 66.1971, GNorm = 0.1467, lr_0 = 1.0807e-04
Loss = 2.5455e-04, PNorm = 66.2066, GNorm = 0.2712, lr_0 = 1.0640e-04
Loss = 3.3979e-04, PNorm = 66.2123, GNorm = 0.0592, lr_0 = 1.0476e-04
Loss = 4.3355e-04, PNorm = 66.2190, GNorm = 0.1118, lr_0 = 1.0315e-04
Loss = 6.1586e-04, PNorm = 66.2279, GNorm = 0.5754, lr_0 = 1.0156e-04
Loss = 6.2858e-04, PNorm = 66.2342, GNorm = 0.6970, lr_0 = 1.0000e-04
Validation auc = 0.860420
Model 0 best validation auc = 0.908237 on epoch 7
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test auc = nan
Ensemble test auc = nan
Fold 6
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': '../../../swansonk/chemprop_ckpt/0406_inhibition_hyperopt.json',
 'cuda': True,
 'data_path': '../../broad2/larger_dataset/0405_inhibition_dedup_binary.csv',
 'dataset_type': 'classification',
 'depth': 5,
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_dim': 200,
 'features_generator': None,
 'features_only': False,
 'features_path': ['../../saved_features/0405_broad_inhibition.npz'],
 'features_scaling': False,
 'features_size': 200,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 1600,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'no_cache': False,
 'num_folds': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'output_size': 1,
 'quiet': True,
 'save_dir': '../ckpt/0405_broad_inhibition_20folds/fold_6',
 'save_smiles_splits': False,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'task_names': ['50uM_Inhibition'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 2654,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': ['../../saved_features/0405_broad_inhibition.npz'],
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Class sizes
50uM_Inhibition 0: 91.93%, 1: 8.07%
Total size = 2,949 | train size = 2,654 | val size = 295 | test size = 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1600, bias=False)
      (W_h): Linear(in_features=1600, out_features=1600, bias=False)
      (W_o): Linear(in_features=1733, out_features=1600, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,571,401
Moving model to cuda
Epoch 0
Loss = 6.9544e-03, PNorm = 59.4722, GNorm = 0.7151, lr_0 = 1.8491e-04
Loss = 6.3196e-03, PNorm = 59.4899, GNorm = 0.9682, lr_0 = 2.6981e-04
Loss = 3.7515e-03, PNorm = 59.5104, GNorm = 0.3890, lr_0 = 3.5472e-04
Loss = 5.2563e-03, PNorm = 59.5359, GNorm = 0.6245, lr_0 = 4.3962e-04
Loss = 6.0098e-03, PNorm = 59.5610, GNorm = 0.5195, lr_0 = 5.2453e-04
Validation auc = 0.734088
Epoch 1
Loss = 4.5808e-03, PNorm = 59.5949, GNorm = 0.4473, lr_0 = 6.0943e-04
Loss = 5.3479e-03, PNorm = 59.6418, GNorm = 1.1592, lr_0 = 6.9434e-04
Loss = 4.7714e-03, PNorm = 59.7084, GNorm = 1.0292, lr_0 = 7.7925e-04
Loss = 5.0110e-03, PNorm = 59.7952, GNorm = 0.3730, lr_0 = 8.6415e-04
Loss = 5.1441e-03, PNorm = 59.8904, GNorm = 0.5345, lr_0 = 9.4906e-04
Validation auc = 0.834717
Epoch 2
Loss = 4.1207e-03, PNorm = 59.9665, GNorm = 1.1017, lr_0 = 9.9381e-04
Loss = 4.6977e-03, PNorm = 60.0382, GNorm = 0.7597, lr_0 = 9.7851e-04
Loss = 4.4623e-03, PNorm = 60.1206, GNorm = 0.5916, lr_0 = 9.6345e-04
Loss = 3.8481e-03, PNorm = 60.2075, GNorm = 0.4502, lr_0 = 9.4861e-04
Loss = 4.3466e-03, PNorm = 60.3133, GNorm = 0.3808, lr_0 = 9.3401e-04
Validation auc = 0.830943
Epoch 3
Loss = 1.9385e-03, PNorm = 60.4136, GNorm = 0.2485, lr_0 = 9.1963e-04
Loss = 4.0702e-03, PNorm = 60.5175, GNorm = 0.4337, lr_0 = 9.0547e-04
Loss = 3.5529e-03, PNorm = 60.6176, GNorm = 1.3607, lr_0 = 8.9153e-04
Loss = 3.7447e-03, PNorm = 60.6993, GNorm = 0.8825, lr_0 = 8.7780e-04
Loss = 4.4039e-03, PNorm = 60.8007, GNorm = 0.4847, lr_0 = 8.6429e-04
Loss = 4.2864e-03, PNorm = 60.8953, GNorm = 0.4684, lr_0 = 8.5098e-04
Validation auc = 0.855346
Epoch 4
Loss = 3.6142e-03, PNorm = 60.9753, GNorm = 1.1618, lr_0 = 8.3788e-04
Loss = 3.4787e-03, PNorm = 61.0569, GNorm = 0.5897, lr_0 = 8.2498e-04
Loss = 3.6937e-03, PNorm = 61.1528, GNorm = 0.4894, lr_0 = 8.1228e-04
Loss = 3.2612e-03, PNorm = 61.2580, GNorm = 0.4752, lr_0 = 7.9977e-04
Loss = 3.8916e-03, PNorm = 61.3671, GNorm = 0.9307, lr_0 = 7.8746e-04
Validation auc = 0.906792
Epoch 5
Loss = 3.8308e-03, PNorm = 61.4809, GNorm = 0.3441, lr_0 = 7.7533e-04
Loss = 3.4929e-03, PNorm = 61.6139, GNorm = 0.4634, lr_0 = 7.6340e-04
Loss = 3.0317e-03, PNorm = 61.7565, GNorm = 0.4688, lr_0 = 7.5164e-04
Loss = 3.5217e-03, PNorm = 61.8764, GNorm = 0.4325, lr_0 = 7.4007e-04
Loss = 3.4602e-03, PNorm = 61.9834, GNorm = 0.7024, lr_0 = 7.2867e-04
Validation auc = 0.897484
Epoch 6
Loss = 2.9381e-03, PNorm = 62.0809, GNorm = 0.8253, lr_0 = 7.1746e-04
Loss = 3.0694e-03, PNorm = 62.1990, GNorm = 0.6380, lr_0 = 7.0641e-04
Loss = 2.7488e-03, PNorm = 62.2856, GNorm = 0.6193, lr_0 = 6.9553e-04
Loss = 2.1378e-03, PNorm = 62.3725, GNorm = 0.4359, lr_0 = 6.8482e-04
Loss = 3.5689e-03, PNorm = 62.4372, GNorm = 0.5819, lr_0 = 6.7428e-04
Loss = 2.4894e-03, PNorm = 62.5395, GNorm = 0.2902, lr_0 = 6.6390e-04
Validation auc = 0.924277
Epoch 7
Loss = 2.1186e-03, PNorm = 62.6354, GNorm = 0.4647, lr_0 = 6.5368e-04
Loss = 2.5131e-03, PNorm = 62.7142, GNorm = 0.3489, lr_0 = 6.4361e-04
Loss = 3.5247e-03, PNorm = 62.7927, GNorm = 0.5291, lr_0 = 6.3370e-04
Loss = 2.4298e-03, PNorm = 62.8941, GNorm = 0.6668, lr_0 = 6.2395e-04
Loss = 3.1078e-03, PNorm = 62.9590, GNorm = 0.3261, lr_0 = 6.1434e-04
Validation auc = 0.916478
Epoch 8
Loss = 1.6238e-03, PNorm = 63.0351, GNorm = 0.3240, lr_0 = 6.0488e-04
Loss = 3.6979e-03, PNorm = 63.0926, GNorm = 0.3029, lr_0 = 5.9557e-04
Loss = 2.2234e-03, PNorm = 63.1706, GNorm = 0.6266, lr_0 = 5.8640e-04
Loss = 2.7139e-03, PNorm = 63.2511, GNorm = 0.5988, lr_0 = 5.7737e-04
Loss = 2.1086e-03, PNorm = 63.3301, GNorm = 0.7947, lr_0 = 5.6848e-04
Validation auc = 0.934088
Epoch 9
Loss = 3.4289e-03, PNorm = 63.3874, GNorm = 0.3422, lr_0 = 5.5973e-04
Loss = 1.5395e-03, PNorm = 63.4569, GNorm = 0.5731, lr_0 = 5.5111e-04
Loss = 2.2204e-03, PNorm = 63.5139, GNorm = 0.6168, lr_0 = 5.4263e-04
Loss = 1.9784e-03, PNorm = 63.5848, GNorm = 0.3919, lr_0 = 5.3427e-04
Loss = 2.7856e-03, PNorm = 63.6555, GNorm = 0.8866, lr_0 = 5.2605e-04
Loss = 2.1257e-03, PNorm = 63.7394, GNorm = 1.1250, lr_0 = 5.1795e-04
Validation auc = 0.926918
Epoch 10
Loss = 2.2626e-03, PNorm = 63.8021, GNorm = 0.4887, lr_0 = 5.0997e-04
Loss = 2.2369e-03, PNorm = 63.8737, GNorm = 0.3892, lr_0 = 5.0212e-04
Loss = 1.8007e-03, PNorm = 63.9378, GNorm = 0.3592, lr_0 = 4.9439e-04
Loss = 1.8282e-03, PNorm = 63.9989, GNorm = 0.5408, lr_0 = 4.8678e-04
Loss = 2.2423e-03, PNorm = 64.0564, GNorm = 0.3283, lr_0 = 4.7928e-04
Validation auc = 0.917233
Epoch 11
Loss = 2.3122e-03, PNorm = 64.1245, GNorm = 0.2166, lr_0 = 4.7190e-04
Loss = 1.8656e-03, PNorm = 64.1982, GNorm = 0.4247, lr_0 = 4.6464e-04
Loss = 2.4509e-03, PNorm = 64.2593, GNorm = 0.8699, lr_0 = 4.5749e-04
Loss = 1.9612e-03, PNorm = 64.3341, GNorm = 0.5159, lr_0 = 4.5044e-04
Loss = 1.9886e-03, PNorm = 64.3907, GNorm = 1.0868, lr_0 = 4.4351e-04
Validation auc = 0.927044
Epoch 12
Loss = 1.4491e-03, PNorm = 64.4572, GNorm = 0.3093, lr_0 = 4.3668e-04
Loss = 1.4667e-03, PNorm = 64.5149, GNorm = 0.5765, lr_0 = 4.2996e-04
Loss = 1.4092e-03, PNorm = 64.5606, GNorm = 0.2468, lr_0 = 4.2334e-04
Loss = 2.5314e-03, PNorm = 64.6204, GNorm = 0.2418, lr_0 = 4.1682e-04
Loss = 1.7719e-03, PNorm = 64.6772, GNorm = 0.2467, lr_0 = 4.1040e-04
Validation auc = 0.942767
Epoch 13
Loss = 1.4203e-03, PNorm = 64.7273, GNorm = 0.3048, lr_0 = 4.0408e-04
Loss = 1.7443e-03, PNorm = 64.7816, GNorm = 0.4907, lr_0 = 3.9786e-04
Loss = 1.4383e-03, PNorm = 64.8326, GNorm = 0.5420, lr_0 = 3.9173e-04
Loss = 1.4662e-03, PNorm = 64.8834, GNorm = 0.3692, lr_0 = 3.8570e-04
Loss = 1.9386e-03, PNorm = 64.9555, GNorm = 0.6522, lr_0 = 3.7976e-04
Loss = 1.7061e-03, PNorm = 64.9969, GNorm = 0.3924, lr_0 = 3.7392e-04
Validation auc = 0.950063
Epoch 14
Loss = 1.4129e-03, PNorm = 65.0649, GNorm = 0.2844, lr_0 = 3.6816e-04
Loss = 1.2683e-03, PNorm = 65.1002, GNorm = 0.3120, lr_0 = 3.6249e-04
Loss = 1.8219e-03, PNorm = 65.1365, GNorm = 0.6792, lr_0 = 3.5691e-04
Loss = 1.4231e-03, PNorm = 65.1798, GNorm = 0.4845, lr_0 = 3.5142e-04
Loss = 1.8115e-03, PNorm = 65.2126, GNorm = 0.8313, lr_0 = 3.4601e-04
Validation auc = 0.949560
Epoch 15
Loss = 1.1360e-03, PNorm = 65.2626, GNorm = 0.8021, lr_0 = 3.4068e-04
Loss = 1.3728e-03, PNorm = 65.2925, GNorm = 0.5055, lr_0 = 3.3543e-04
Loss = 2.0340e-03, PNorm = 65.3383, GNorm = 0.5425, lr_0 = 3.3027e-04
Loss = 1.2645e-03, PNorm = 65.3799, GNorm = 0.2699, lr_0 = 3.2518e-04
Loss = 1.3966e-03, PNorm = 65.4116, GNorm = 0.7009, lr_0 = 3.2018e-04
Validation auc = 0.945912
Epoch 16
Loss = 2.2330e-03, PNorm = 65.4637, GNorm = 0.3845, lr_0 = 3.1525e-04
Loss = 1.0905e-03, PNorm = 65.5095, GNorm = 0.5033, lr_0 = 3.1039e-04
Loss = 9.8395e-04, PNorm = 65.5365, GNorm = 0.2286, lr_0 = 3.0562e-04
Loss = 1.5760e-03, PNorm = 65.5720, GNorm = 0.8739, lr_0 = 3.0091e-04
Loss = 1.5750e-03, PNorm = 65.6088, GNorm = 0.4638, lr_0 = 2.9628e-04
Loss = 1.7145e-03, PNorm = 65.6533, GNorm = 1.0380, lr_0 = 2.9172e-04
Validation auc = 0.949811
Epoch 17
Loss = 7.1616e-04, PNorm = 65.6838, GNorm = 0.2983, lr_0 = 2.8722e-04
Loss = 1.6156e-03, PNorm = 65.7043, GNorm = 0.7192, lr_0 = 2.8280e-04
Loss = 7.8513e-04, PNorm = 65.7423, GNorm = 0.1887, lr_0 = 2.7845e-04
Loss = 1.6312e-03, PNorm = 65.7658, GNorm = 0.3277, lr_0 = 2.7416e-04
Loss = 1.5796e-03, PNorm = 65.8022, GNorm = 0.7487, lr_0 = 2.6994e-04
Validation auc = 0.944151
Epoch 18
Loss = 1.1286e-03, PNorm = 65.8399, GNorm = 0.3223, lr_0 = 2.6578e-04
Loss = 8.6882e-04, PNorm = 65.8786, GNorm = 0.3018, lr_0 = 2.6169e-04
Loss = 1.3532e-03, PNorm = 65.9149, GNorm = 1.2869, lr_0 = 2.5766e-04
Loss = 1.4026e-03, PNorm = 65.9292, GNorm = 0.5419, lr_0 = 2.5370e-04
Loss = 1.2695e-03, PNorm = 65.9584, GNorm = 0.6227, lr_0 = 2.4979e-04
Validation auc = 0.949686
Epoch 19
Loss = 7.2823e-04, PNorm = 65.9844, GNorm = 0.3429, lr_0 = 2.4594e-04
Loss = 1.0073e-03, PNorm = 66.0298, GNorm = 0.2005, lr_0 = 2.4216e-04
Loss = 2.0060e-03, PNorm = 66.0490, GNorm = 0.3156, lr_0 = 2.3843e-04
Loss = 1.4883e-03, PNorm = 66.0828, GNorm = 0.6991, lr_0 = 2.3476e-04
Loss = 7.6136e-04, PNorm = 66.1092, GNorm = 0.4079, lr_0 = 2.3114e-04
Loss = 1.2901e-03, PNorm = 66.1320, GNorm = 0.1188, lr_0 = 2.2758e-04
Validation auc = 0.945660
Epoch 20
Loss = 8.1251e-04, PNorm = 66.1543, GNorm = 0.5976, lr_0 = 2.2408e-04
Loss = 9.6145e-04, PNorm = 66.1868, GNorm = 0.4157, lr_0 = 2.2063e-04
Loss = 1.4372e-03, PNorm = 66.2020, GNorm = 0.1737, lr_0 = 2.1723e-04
Loss = 1.1157e-03, PNorm = 66.2336, GNorm = 0.4660, lr_0 = 2.1389e-04
Loss = 1.2360e-03, PNorm = 66.2590, GNorm = 0.8016, lr_0 = 2.1060e-04
Validation auc = 0.952453
Epoch 21
Loss = 1.5989e-03, PNorm = 66.2894, GNorm = 0.7244, lr_0 = 2.0735e-04
Loss = 8.6469e-04, PNorm = 66.3112, GNorm = 0.3784, lr_0 = 2.0416e-04
Loss = 1.0696e-03, PNorm = 66.3379, GNorm = 0.5450, lr_0 = 2.0102e-04
Loss = 7.5950e-04, PNorm = 66.3535, GNorm = 0.1939, lr_0 = 1.9792e-04
Loss = 7.7168e-04, PNorm = 66.3717, GNorm = 0.4926, lr_0 = 1.9488e-04
Validation auc = 0.949057
Epoch 22
Loss = 9.4898e-04, PNorm = 66.3918, GNorm = 0.4706, lr_0 = 1.9188e-04
Loss = 5.7208e-04, PNorm = 66.4133, GNorm = 0.0890, lr_0 = 1.8892e-04
Loss = 9.2802e-04, PNorm = 66.4285, GNorm = 1.6606, lr_0 = 1.8601e-04
Loss = 1.1964e-03, PNorm = 66.4433, GNorm = 0.9146, lr_0 = 1.8315e-04
Loss = 9.6092e-04, PNorm = 66.4735, GNorm = 0.4071, lr_0 = 1.8033e-04
Validation auc = 0.946792
Epoch 23
Loss = 7.2691e-04, PNorm = 66.4869, GNorm = 0.3389, lr_0 = 1.7755e-04
Loss = 7.7536e-04, PNorm = 66.5043, GNorm = 0.3534, lr_0 = 1.7482e-04
Loss = 1.1101e-03, PNorm = 66.5209, GNorm = 0.3924, lr_0 = 1.7213e-04
Loss = 5.0628e-04, PNorm = 66.5400, GNorm = 0.1847, lr_0 = 1.6948e-04
Loss = 9.3986e-04, PNorm = 66.5560, GNorm = 0.5508, lr_0 = 1.6687e-04
Loss = 6.7114e-04, PNorm = 66.5734, GNorm = 0.4679, lr_0 = 1.6430e-04
Validation auc = 0.954465
Epoch 24
Loss = 7.2994e-04, PNorm = 66.5937, GNorm = 0.3995, lr_0 = 1.6177e-04
Loss = 7.3059e-04, PNorm = 66.6057, GNorm = 0.9053, lr_0 = 1.5928e-04
Loss = 5.4037e-04, PNorm = 66.6155, GNorm = 0.9267, lr_0 = 1.5683e-04
Loss = 6.5817e-04, PNorm = 66.6336, GNorm = 0.3174, lr_0 = 1.5441e-04
Loss = 1.3599e-03, PNorm = 66.6527, GNorm = 0.4986, lr_0 = 1.5203e-04
Validation auc = 0.949434
Epoch 25
Loss = 5.0999e-04, PNorm = 66.6629, GNorm = 0.5465, lr_0 = 1.4969e-04
Loss = 5.1425e-04, PNorm = 66.6702, GNorm = 0.6268, lr_0 = 1.4739e-04
Loss = 7.5944e-04, PNorm = 66.6825, GNorm = 0.6690, lr_0 = 1.4512e-04
Loss = 6.6738e-04, PNorm = 66.6948, GNorm = 0.2330, lr_0 = 1.4288e-04
Loss = 9.2336e-04, PNorm = 66.7193, GNorm = 0.9616, lr_0 = 1.4069e-04
Validation auc = 0.956730
Epoch 26
Loss = 9.8054e-04, PNorm = 66.7263, GNorm = 0.8883, lr_0 = 1.3852e-04
Loss = 6.1400e-04, PNorm = 66.7422, GNorm = 0.5715, lr_0 = 1.3639e-04
Loss = 4.0548e-04, PNorm = 66.7611, GNorm = 0.8690, lr_0 = 1.3429e-04
Loss = 6.4623e-04, PNorm = 66.7701, GNorm = 0.1105, lr_0 = 1.3222e-04
Loss = 5.3636e-04, PNorm = 66.7807, GNorm = 1.4744, lr_0 = 1.3018e-04
Loss = 1.0639e-03, PNorm = 66.7892, GNorm = 0.2233, lr_0 = 1.2818e-04
Validation auc = 0.948302
Epoch 27
Loss = 8.0341e-04, PNorm = 66.7987, GNorm = 0.7080, lr_0 = 1.2621e-04
Loss = 8.7655e-04, PNorm = 66.8151, GNorm = 0.1930, lr_0 = 1.2426e-04
Loss = 5.6675e-04, PNorm = 66.8286, GNorm = 0.5348, lr_0 = 1.2235e-04
Loss = 5.8918e-04, PNorm = 66.8400, GNorm = 0.3490, lr_0 = 1.2047e-04
Loss = 4.0029e-04, PNorm = 66.8513, GNorm = 0.5480, lr_0 = 1.1861e-04
Validation auc = 0.950566
Epoch 28
Loss = 7.4373e-04, PNorm = 66.8606, GNorm = 0.1973, lr_0 = 1.1678e-04
Loss = 6.6682e-04, PNorm = 66.8648, GNorm = 0.4710, lr_0 = 1.1499e-04
Loss = 5.9232e-04, PNorm = 66.8760, GNorm = 0.6917, lr_0 = 1.1322e-04
Loss = 4.3583e-04, PNorm = 66.8891, GNorm = 0.4225, lr_0 = 1.1147e-04
Loss = 4.9220e-04, PNorm = 66.8962, GNorm = 0.5965, lr_0 = 1.0976e-04
Validation auc = 0.946038
Epoch 29
Loss = 8.5318e-04, PNorm = 66.9018, GNorm = 0.5181, lr_0 = 1.0807e-04
Loss = 3.1204e-04, PNorm = 66.9078, GNorm = 0.1789, lr_0 = 1.0640e-04
Loss = 6.9677e-04, PNorm = 66.9171, GNorm = 0.2202, lr_0 = 1.0476e-04
Loss = 4.4874e-04, PNorm = 66.9227, GNorm = 0.7022, lr_0 = 1.0315e-04
Loss = 1.0215e-03, PNorm = 66.9319, GNorm = 0.6780, lr_0 = 1.0156e-04
Loss = 6.0563e-04, PNorm = 66.9382, GNorm = 1.1240, lr_0 = 1.0000e-04
Validation auc = 0.944906
Model 0 best validation auc = 0.956730 on epoch 25
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test auc = nan
Ensemble test auc = nan
Fold 7
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': '../../../swansonk/chemprop_ckpt/0406_inhibition_hyperopt.json',
 'cuda': True,
 'data_path': '../../broad2/larger_dataset/0405_inhibition_dedup_binary.csv',
 'dataset_type': 'classification',
 'depth': 5,
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_dim': 200,
 'features_generator': None,
 'features_only': False,
 'features_path': ['../../saved_features/0405_broad_inhibition.npz'],
 'features_scaling': False,
 'features_size': 200,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 1600,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'no_cache': False,
 'num_folds': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'output_size': 1,
 'quiet': True,
 'save_dir': '../ckpt/0405_broad_inhibition_20folds/fold_7',
 'save_smiles_splits': False,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'task_names': ['50uM_Inhibition'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 2654,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': ['../../saved_features/0405_broad_inhibition.npz'],
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Class sizes
50uM_Inhibition 0: 91.93%, 1: 8.07%
Total size = 2,949 | train size = 2,654 | val size = 295 | test size = 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1600, bias=False)
      (W_h): Linear(in_features=1600, out_features=1600, bias=False)
      (W_o): Linear(in_features=1733, out_features=1600, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,571,401
Moving model to cuda
Epoch 0
Loss = 8.2157e-03, PNorm = 59.4512, GNorm = 1.4044, lr_0 = 1.8491e-04
Loss = 6.3564e-03, PNorm = 59.4693, GNorm = 0.7440, lr_0 = 2.6981e-04
Loss = 5.8474e-03, PNorm = 59.4898, GNorm = 0.4830, lr_0 = 3.5472e-04
Loss = 4.8027e-03, PNorm = 59.5111, GNorm = 0.7573, lr_0 = 4.3962e-04
Loss = 6.0603e-03, PNorm = 59.5310, GNorm = 0.4786, lr_0 = 5.2453e-04
Validation auc = 0.791965
Epoch 1
Loss = 4.2133e-03, PNorm = 59.5642, GNorm = 1.1410, lr_0 = 6.0943e-04
Loss = 6.5520e-03, PNorm = 59.6110, GNorm = 1.4576, lr_0 = 6.9434e-04
Loss = 5.3145e-03, PNorm = 59.6700, GNorm = 0.5700, lr_0 = 7.7925e-04
Loss = 4.7860e-03, PNorm = 59.7346, GNorm = 1.1535, lr_0 = 8.6415e-04
Loss = 4.6958e-03, PNorm = 59.7958, GNorm = 0.6366, lr_0 = 9.4906e-04
Validation auc = 0.847155
Epoch 2
Loss = 4.2728e-03, PNorm = 59.8836, GNorm = 1.3698, lr_0 = 9.9381e-04
Loss = 4.2065e-03, PNorm = 59.9833, GNorm = 0.3609, lr_0 = 9.7851e-04
Loss = 4.7259e-03, PNorm = 60.0711, GNorm = 0.6814, lr_0 = 9.6345e-04
Loss = 4.2931e-03, PNorm = 60.1630, GNorm = 0.8828, lr_0 = 9.4861e-04
Loss = 4.4057e-03, PNorm = 60.2556, GNorm = 0.3046, lr_0 = 9.3401e-04
Validation auc = 0.894910
Epoch 3
Loss = 3.2745e-03, PNorm = 60.3486, GNorm = 0.9039, lr_0 = 9.1963e-04
Loss = 2.9993e-03, PNorm = 60.4412, GNorm = 0.6001, lr_0 = 9.0547e-04
Loss = 4.0517e-03, PNorm = 60.5133, GNorm = 0.6512, lr_0 = 8.9153e-04
Loss = 3.5755e-03, PNorm = 60.5805, GNorm = 0.6227, lr_0 = 8.7780e-04
Loss = 3.8465e-03, PNorm = 60.6512, GNorm = 1.0913, lr_0 = 8.6429e-04
Loss = 4.9448e-03, PNorm = 60.7218, GNorm = 0.3975, lr_0 = 8.5098e-04
Validation auc = 0.922219
Epoch 4
Loss = 3.5785e-03, PNorm = 60.8266, GNorm = 0.2779, lr_0 = 8.3788e-04
Loss = 3.7890e-03, PNorm = 60.9271, GNorm = 0.8869, lr_0 = 8.2498e-04
Loss = 4.4742e-03, PNorm = 61.0246, GNorm = 0.7175, lr_0 = 8.1228e-04
Loss = 3.4642e-03, PNorm = 61.1353, GNorm = 0.3086, lr_0 = 7.9977e-04
Loss = 2.9431e-03, PNorm = 61.2424, GNorm = 0.7707, lr_0 = 7.8746e-04
Validation auc = 0.928796
Epoch 5
Loss = 3.0452e-03, PNorm = 61.3160, GNorm = 1.1812, lr_0 = 7.7533e-04
Loss = 2.2591e-03, PNorm = 61.3860, GNorm = 0.8921, lr_0 = 7.6340e-04
Loss = 3.9735e-03, PNorm = 61.4518, GNorm = 0.3906, lr_0 = 7.5164e-04
Loss = 3.0725e-03, PNorm = 61.5246, GNorm = 0.3627, lr_0 = 7.4007e-04
Loss = 3.5410e-03, PNorm = 61.6116, GNorm = 0.2522, lr_0 = 7.2867e-04
Validation auc = 0.909637
Epoch 6
Loss = 3.7913e-03, PNorm = 61.6895, GNorm = 0.5881, lr_0 = 7.1746e-04
Loss = 2.9094e-03, PNorm = 61.8016, GNorm = 0.3162, lr_0 = 7.0641e-04
Loss = 3.2946e-03, PNorm = 61.8849, GNorm = 1.8379, lr_0 = 6.9553e-04
Loss = 3.7435e-03, PNorm = 61.9593, GNorm = 0.4564, lr_0 = 6.8482e-04
Loss = 3.5192e-03, PNorm = 62.0363, GNorm = 0.4422, lr_0 = 6.7428e-04
Loss = 2.3068e-03, PNorm = 62.1231, GNorm = 0.2454, lr_0 = 6.6390e-04
Validation auc = 0.953103
Epoch 7
Loss = 3.1584e-03, PNorm = 62.1983, GNorm = 0.8253, lr_0 = 6.5368e-04
Loss = 2.9467e-03, PNorm = 62.2702, GNorm = 0.3109, lr_0 = 6.4361e-04
Loss = 2.8056e-03, PNorm = 62.3451, GNorm = 0.8702, lr_0 = 6.3370e-04
Loss = 2.3074e-03, PNorm = 62.4204, GNorm = 0.5289, lr_0 = 6.2395e-04
Loss = 2.7971e-03, PNorm = 62.5087, GNorm = 0.4515, lr_0 = 6.1434e-04
Validation auc = 0.891907
Epoch 8
Loss = 2.9076e-03, PNorm = 62.5782, GNorm = 1.1067, lr_0 = 6.0488e-04
Loss = 3.0081e-03, PNorm = 62.6602, GNorm = 0.4597, lr_0 = 5.9557e-04
Loss = 1.6870e-03, PNorm = 62.7350, GNorm = 0.1863, lr_0 = 5.8640e-04
Loss = 3.5176e-03, PNorm = 62.7938, GNorm = 0.3693, lr_0 = 5.7737e-04
Loss = 2.4495e-03, PNorm = 62.8637, GNorm = 0.5634, lr_0 = 5.6848e-04
Validation auc = 0.962253
Epoch 9
Loss = 2.2014e-03, PNorm = 62.9289, GNorm = 0.4526, lr_0 = 5.5973e-04
Loss = 2.3336e-03, PNorm = 63.0014, GNorm = 0.6947, lr_0 = 5.5111e-04
Loss = 2.4444e-03, PNorm = 63.0673, GNorm = 0.6648, lr_0 = 5.4263e-04
Loss = 2.3130e-03, PNorm = 63.1331, GNorm = 0.2502, lr_0 = 5.3427e-04
Loss = 2.4837e-03, PNorm = 63.1981, GNorm = 0.4705, lr_0 = 5.2605e-04
Loss = 2.5667e-03, PNorm = 63.2617, GNorm = 0.4771, lr_0 = 5.1795e-04
Validation auc = 0.959966
Epoch 10
Loss = 2.2790e-03, PNorm = 63.3395, GNorm = 0.4439, lr_0 = 5.0997e-04
Loss = 1.8845e-03, PNorm = 63.4033, GNorm = 0.6065, lr_0 = 5.0212e-04
Loss = 2.6427e-03, PNorm = 63.4581, GNorm = 0.4515, lr_0 = 4.9439e-04
Loss = 2.3011e-03, PNorm = 63.5302, GNorm = 0.3456, lr_0 = 4.8678e-04
Loss = 2.7459e-03, PNorm = 63.5985, GNorm = 0.3848, lr_0 = 4.7928e-04
Validation auc = 0.964970
Epoch 11
Loss = 2.4417e-03, PNorm = 63.6601, GNorm = 0.2987, lr_0 = 4.7190e-04
Loss = 2.6873e-03, PNorm = 63.7123, GNorm = 0.7361, lr_0 = 4.6464e-04
Loss = 1.3817e-03, PNorm = 63.7828, GNorm = 0.2895, lr_0 = 4.5749e-04
Loss = 1.5764e-03, PNorm = 63.8341, GNorm = 0.6202, lr_0 = 4.5044e-04
Loss = 2.6814e-03, PNorm = 63.8789, GNorm = 0.6595, lr_0 = 4.4351e-04
Validation auc = 0.969259
Epoch 12
Loss = 1.4094e-03, PNorm = 63.9345, GNorm = 0.3515, lr_0 = 4.3668e-04
Loss = 1.8123e-03, PNorm = 63.9918, GNorm = 0.7879, lr_0 = 4.2996e-04
Loss = 2.6465e-03, PNorm = 64.0463, GNorm = 1.2706, lr_0 = 4.2334e-04
Loss = 1.8956e-03, PNorm = 64.1073, GNorm = 0.3207, lr_0 = 4.1682e-04
Loss = 1.7201e-03, PNorm = 64.1620, GNorm = 0.4159, lr_0 = 4.1040e-04
Validation auc = 0.970403
Epoch 13
Loss = 1.0099e-03, PNorm = 64.2031, GNorm = 0.3414, lr_0 = 4.0408e-04
Loss = 1.7217e-03, PNorm = 64.2634, GNorm = 0.2091, lr_0 = 3.9786e-04
Loss = 2.6872e-03, PNorm = 64.2999, GNorm = 0.6636, lr_0 = 3.9173e-04
Loss = 1.7607e-03, PNorm = 64.3569, GNorm = 0.3217, lr_0 = 3.8570e-04
Loss = 1.6745e-03, PNorm = 64.4067, GNorm = 0.6596, lr_0 = 3.7976e-04
Loss = 1.3722e-03, PNorm = 64.4575, GNorm = 0.2560, lr_0 = 3.7392e-04
Validation auc = 0.971261
Epoch 14
Loss = 2.2973e-03, PNorm = 64.4908, GNorm = 0.3924, lr_0 = 3.6816e-04
Loss = 1.7491e-03, PNorm = 64.5395, GNorm = 0.1666, lr_0 = 3.6249e-04
Loss = 1.5556e-03, PNorm = 64.5826, GNorm = 0.2747, lr_0 = 3.5691e-04
Loss = 2.0142e-03, PNorm = 64.6310, GNorm = 0.6569, lr_0 = 3.5142e-04
Loss = 1.9514e-03, PNorm = 64.6688, GNorm = 0.3281, lr_0 = 3.4601e-04
Validation auc = 0.963254
Epoch 15
Loss = 1.6209e-03, PNorm = 64.7139, GNorm = 0.1439, lr_0 = 3.4068e-04
Loss = 1.2901e-03, PNorm = 64.7491, GNorm = 0.2924, lr_0 = 3.3543e-04
Loss = 2.2453e-03, PNorm = 64.7927, GNorm = 0.4814, lr_0 = 3.3027e-04
Loss = 1.9010e-03, PNorm = 64.8358, GNorm = 0.5174, lr_0 = 3.2518e-04
Loss = 1.5580e-03, PNorm = 64.8834, GNorm = 0.3820, lr_0 = 3.2018e-04
Validation auc = 0.972977
Epoch 16
Loss = 1.2148e-03, PNorm = 64.9230, GNorm = 0.4922, lr_0 = 3.1525e-04
Loss = 1.3511e-03, PNorm = 64.9512, GNorm = 0.2792, lr_0 = 3.1039e-04
Loss = 1.7569e-03, PNorm = 64.9892, GNorm = 0.5984, lr_0 = 3.0562e-04
Loss = 1.6109e-03, PNorm = 65.0155, GNorm = 0.2662, lr_0 = 3.0091e-04
Loss = 1.5583e-03, PNorm = 65.0543, GNorm = 0.4099, lr_0 = 2.9628e-04
Loss = 1.5656e-03, PNorm = 65.0841, GNorm = 0.5971, lr_0 = 2.9172e-04
Validation auc = 0.967401
Epoch 17
Loss = 1.3469e-03, PNorm = 65.1191, GNorm = 0.5958, lr_0 = 2.8722e-04
Loss = 1.6467e-03, PNorm = 65.1514, GNorm = 0.2614, lr_0 = 2.8280e-04
Loss = 1.5884e-03, PNorm = 65.1737, GNorm = 0.2316, lr_0 = 2.7845e-04
Loss = 1.2049e-03, PNorm = 65.2077, GNorm = 0.6518, lr_0 = 2.7416e-04
Loss = 1.5085e-03, PNorm = 65.2411, GNorm = 0.7837, lr_0 = 2.6994e-04
Validation auc = 0.968687
Epoch 18
Loss = 1.1494e-03, PNorm = 65.2745, GNorm = 0.3899, lr_0 = 2.6578e-04
Loss = 1.3166e-03, PNorm = 65.3190, GNorm = 0.8456, lr_0 = 2.6169e-04
Loss = 1.5252e-03, PNorm = 65.3471, GNorm = 0.5512, lr_0 = 2.5766e-04
Loss = 1.4632e-03, PNorm = 65.3925, GNorm = 0.5485, lr_0 = 2.5370e-04
Loss = 1.7495e-03, PNorm = 65.4141, GNorm = 0.9401, lr_0 = 2.4979e-04
Validation auc = 0.973549
Epoch 19
Loss = 9.5826e-04, PNorm = 65.4461, GNorm = 0.2925, lr_0 = 2.4594e-04
Loss = 1.6092e-03, PNorm = 65.4703, GNorm = 0.3394, lr_0 = 2.4216e-04
Loss = 1.2468e-03, PNorm = 65.5011, GNorm = 0.9200, lr_0 = 2.3843e-04
Loss = 1.5553e-03, PNorm = 65.5353, GNorm = 0.4586, lr_0 = 2.3476e-04
Loss = 8.9866e-04, PNorm = 65.5625, GNorm = 0.1220, lr_0 = 2.3114e-04
Loss = 7.8331e-04, PNorm = 65.5850, GNorm = 0.5415, lr_0 = 2.2758e-04
Validation auc = 0.957535
Epoch 20
Loss = 1.3792e-03, PNorm = 65.5968, GNorm = 0.7050, lr_0 = 2.2408e-04
Loss = 7.2178e-04, PNorm = 65.6302, GNorm = 0.1688, lr_0 = 2.2063e-04
Loss = 1.3004e-03, PNorm = 65.6493, GNorm = 0.5300, lr_0 = 2.1723e-04
Loss = 1.3843e-03, PNorm = 65.6712, GNorm = 0.4959, lr_0 = 2.1389e-04
Loss = 1.1103e-03, PNorm = 65.7004, GNorm = 1.0701, lr_0 = 2.1060e-04
Validation auc = 0.961538
Epoch 21
Loss = 7.5441e-04, PNorm = 65.7092, GNorm = 0.1463, lr_0 = 2.0735e-04
Loss = 1.2109e-03, PNorm = 65.7333, GNorm = 0.4273, lr_0 = 2.0416e-04
Loss = 1.1374e-03, PNorm = 65.7548, GNorm = 0.2838, lr_0 = 2.0102e-04
Loss = 9.7509e-04, PNorm = 65.7723, GNorm = 0.1951, lr_0 = 1.9792e-04
Loss = 1.5425e-03, PNorm = 65.7915, GNorm = 0.3553, lr_0 = 1.9488e-04
Validation auc = 0.971976
Epoch 22
Loss = 1.1140e-03, PNorm = 65.8067, GNorm = 0.2059, lr_0 = 1.9188e-04
Loss = 9.9441e-04, PNorm = 65.8271, GNorm = 0.3146, lr_0 = 1.8892e-04
Loss = 9.2834e-04, PNorm = 65.8470, GNorm = 0.6980, lr_0 = 1.8601e-04
Loss = 8.6865e-04, PNorm = 65.8610, GNorm = 0.8994, lr_0 = 1.8315e-04
Loss = 1.0251e-03, PNorm = 65.8766, GNorm = 0.1562, lr_0 = 1.8033e-04
Validation auc = 0.970403
Epoch 23
Loss = 4.8246e-04, PNorm = 65.8916, GNorm = 0.2419, lr_0 = 1.7755e-04
Loss = 1.2866e-03, PNorm = 65.9118, GNorm = 1.0706, lr_0 = 1.7482e-04
Loss = 9.6120e-04, PNorm = 65.9351, GNorm = 0.5651, lr_0 = 1.7213e-04
Loss = 1.0450e-03, PNorm = 65.9514, GNorm = 0.7670, lr_0 = 1.6948e-04
Loss = 7.0161e-04, PNorm = 65.9720, GNorm = 0.9763, lr_0 = 1.6687e-04
Loss = 1.1218e-03, PNorm = 65.9854, GNorm = 0.1533, lr_0 = 1.6430e-04
Validation auc = 0.964398
Epoch 24
Loss = 7.8693e-04, PNorm = 66.0001, GNorm = 1.1889, lr_0 = 1.6177e-04
Loss = 9.0299e-04, PNorm = 66.0190, GNorm = 0.0994, lr_0 = 1.5928e-04
Loss = 1.0204e-03, PNorm = 66.0282, GNorm = 0.1973, lr_0 = 1.5683e-04
Loss = 8.9118e-04, PNorm = 66.0456, GNorm = 0.2497, lr_0 = 1.5441e-04
Loss = 1.1370e-03, PNorm = 66.0588, GNorm = 0.6268, lr_0 = 1.5203e-04
Validation auc = 0.966686
Epoch 25
Loss = 8.1157e-04, PNorm = 66.0729, GNorm = 0.2490, lr_0 = 1.4969e-04
Loss = 1.0590e-03, PNorm = 66.0802, GNorm = 0.4214, lr_0 = 1.4739e-04
Loss = 9.4089e-04, PNorm = 66.1018, GNorm = 1.2894, lr_0 = 1.4512e-04
Loss = 5.4078e-04, PNorm = 66.1124, GNorm = 0.1300, lr_0 = 1.4288e-04
Loss = 1.3451e-03, PNorm = 66.1286, GNorm = 0.1310, lr_0 = 1.4069e-04
Validation auc = 0.973692
Epoch 26
Loss = 5.7435e-04, PNorm = 66.1423, GNorm = 0.4061, lr_0 = 1.3852e-04
Loss = 9.0754e-04, PNorm = 66.1521, GNorm = 0.4081, lr_0 = 1.3639e-04
Loss = 8.5599e-04, PNorm = 66.1729, GNorm = 0.6069, lr_0 = 1.3429e-04
Loss = 9.8138e-04, PNorm = 66.1823, GNorm = 1.1618, lr_0 = 1.3222e-04
Loss = 9.1715e-04, PNorm = 66.1923, GNorm = 0.8025, lr_0 = 1.3018e-04
Loss = 5.2645e-04, PNorm = 66.2067, GNorm = 0.0914, lr_0 = 1.2818e-04
Validation auc = 0.970546
Epoch 27
Loss = 5.4064e-04, PNorm = 66.2145, GNorm = 0.4009, lr_0 = 1.2621e-04
Loss = 8.4676e-04, PNorm = 66.2226, GNorm = 0.5545, lr_0 = 1.2426e-04
Loss = 8.3317e-04, PNorm = 66.2340, GNorm = 0.0599, lr_0 = 1.2235e-04
Loss = 1.0984e-03, PNorm = 66.2408, GNorm = 1.4794, lr_0 = 1.2047e-04
Loss = 9.4733e-04, PNorm = 66.2591, GNorm = 1.9616, lr_0 = 1.1861e-04
Validation auc = 0.975122
Epoch 28
Loss = 8.4524e-04, PNorm = 66.2653, GNorm = 0.2479, lr_0 = 1.1678e-04
Loss = 9.1978e-04, PNorm = 66.2794, GNorm = 0.7340, lr_0 = 1.1499e-04
Loss = 8.3713e-04, PNorm = 66.2848, GNorm = 0.3821, lr_0 = 1.1322e-04
Loss = 5.9865e-04, PNorm = 66.2953, GNorm = 0.4507, lr_0 = 1.1147e-04
Loss = 8.4499e-04, PNorm = 66.3062, GNorm = 0.8741, lr_0 = 1.0976e-04
Validation auc = 0.970975
Epoch 29
Loss = 9.9509e-04, PNorm = 66.3135, GNorm = 0.2365, lr_0 = 1.0807e-04
Loss = 7.0281e-04, PNorm = 66.3209, GNorm = 0.9306, lr_0 = 1.0640e-04
Loss = 5.8730e-04, PNorm = 66.3261, GNorm = 0.1700, lr_0 = 1.0476e-04
Loss = 6.2272e-04, PNorm = 66.3362, GNorm = 0.8436, lr_0 = 1.0315e-04
Loss = 7.9590e-04, PNorm = 66.3435, GNorm = 0.8311, lr_0 = 1.0156e-04
Loss = 6.3675e-04, PNorm = 66.3498, GNorm = 0.5058, lr_0 = 1.0000e-04
Validation auc = 0.970975
Model 0 best validation auc = 0.975122 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test auc = nan
Ensemble test auc = nan
Fold 8
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': '../../../swansonk/chemprop_ckpt/0406_inhibition_hyperopt.json',
 'cuda': True,
 'data_path': '../../broad2/larger_dataset/0405_inhibition_dedup_binary.csv',
 'dataset_type': 'classification',
 'depth': 5,
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_dim': 200,
 'features_generator': None,
 'features_only': False,
 'features_path': ['../../saved_features/0405_broad_inhibition.npz'],
 'features_scaling': False,
 'features_size': 200,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 1600,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'no_cache': False,
 'num_folds': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'output_size': 1,
 'quiet': True,
 'save_dir': '../ckpt/0405_broad_inhibition_20folds/fold_8',
 'save_smiles_splits': False,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'task_names': ['50uM_Inhibition'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 2654,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': ['../../saved_features/0405_broad_inhibition.npz'],
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Class sizes
50uM_Inhibition 0: 91.93%, 1: 8.07%
Total size = 2,949 | train size = 2,654 | val size = 295 | test size = 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1600, bias=False)
      (W_h): Linear(in_features=1600, out_features=1600, bias=False)
      (W_o): Linear(in_features=1733, out_features=1600, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,571,401
Moving model to cuda
Epoch 0
Loss = 9.3559e-03, PNorm = 59.4657, GNorm = 2.7053, lr_0 = 1.8491e-04
Loss = 6.5966e-03, PNorm = 59.4827, GNorm = 0.5874, lr_0 = 2.6981e-04
Loss = 6.4513e-03, PNorm = 59.5042, GNorm = 0.3688, lr_0 = 3.5472e-04
Loss = 6.3063e-03, PNorm = 59.5238, GNorm = 0.4815, lr_0 = 4.3962e-04
Loss = 4.5904e-03, PNorm = 59.5460, GNorm = 1.2224, lr_0 = 5.2453e-04
Validation auc = 0.804136
Epoch 1
Loss = 4.9603e-03, PNorm = 59.5670, GNorm = 0.4890, lr_0 = 6.0943e-04
Loss = 6.1264e-03, PNorm = 59.5987, GNorm = 0.6702, lr_0 = 6.9434e-04
Loss = 4.4397e-03, PNorm = 59.6518, GNorm = 0.6299, lr_0 = 7.7925e-04
Loss = 6.0460e-03, PNorm = 59.7248, GNorm = 0.3520, lr_0 = 8.6415e-04
Loss = 4.2493e-03, PNorm = 59.8057, GNorm = 0.3853, lr_0 = 9.4906e-04
Validation auc = 0.812478
Epoch 2
Loss = 5.1455e-03, PNorm = 59.8956, GNorm = 1.0246, lr_0 = 9.9381e-04
Loss = 4.1443e-03, PNorm = 59.9868, GNorm = 1.5063, lr_0 = 9.7851e-04
Loss = 4.3021e-03, PNorm = 60.0774, GNorm = 1.9640, lr_0 = 9.6345e-04
Loss = 4.5341e-03, PNorm = 60.1667, GNorm = 0.4180, lr_0 = 9.4861e-04
Loss = 3.8435e-03, PNorm = 60.2745, GNorm = 1.2694, lr_0 = 9.3401e-04
Validation auc = 0.812826
Epoch 3
Loss = 3.9510e-03, PNorm = 60.3621, GNorm = 0.4295, lr_0 = 9.1963e-04
Loss = 3.6661e-03, PNorm = 60.4533, GNorm = 0.4507, lr_0 = 9.0547e-04
Loss = 3.7586e-03, PNorm = 60.5476, GNorm = 0.7447, lr_0 = 8.9153e-04
Loss = 3.7233e-03, PNorm = 60.6564, GNorm = 0.8473, lr_0 = 8.7780e-04
Loss = 4.5716e-03, PNorm = 60.7653, GNorm = 0.3442, lr_0 = 8.6429e-04
Loss = 3.8831e-03, PNorm = 60.8759, GNorm = 0.6288, lr_0 = 8.5098e-04
Validation auc = 0.849670
Epoch 4
Loss = 2.8768e-03, PNorm = 60.9733, GNorm = 0.4879, lr_0 = 8.3788e-04
Loss = 4.1659e-03, PNorm = 61.0755, GNorm = 0.7720, lr_0 = 8.2498e-04
Loss = 3.5135e-03, PNorm = 61.1595, GNorm = 0.5219, lr_0 = 8.1228e-04
Loss = 3.2510e-03, PNorm = 61.2427, GNorm = 0.3118, lr_0 = 7.9977e-04
Loss = 3.2264e-03, PNorm = 61.3221, GNorm = 0.3121, lr_0 = 7.8746e-04
Validation auc = 0.846368
Epoch 5
Loss = 2.8915e-03, PNorm = 61.4082, GNorm = 0.4626, lr_0 = 7.7533e-04
Loss = 3.2381e-03, PNorm = 61.4983, GNorm = 2.1792, lr_0 = 7.6340e-04
Loss = 3.6552e-03, PNorm = 61.5698, GNorm = 0.5196, lr_0 = 7.5164e-04
Loss = 3.5578e-03, PNorm = 61.6598, GNorm = 0.7311, lr_0 = 7.4007e-04
Loss = 3.5277e-03, PNorm = 61.7457, GNorm = 0.8798, lr_0 = 7.2867e-04
Validation auc = 0.854188
Epoch 6
Loss = 3.8213e-03, PNorm = 61.8235, GNorm = 0.5155, lr_0 = 7.1746e-04
Loss = 2.8134e-03, PNorm = 61.9043, GNorm = 0.3848, lr_0 = 7.0641e-04
Loss = 2.9236e-03, PNorm = 61.9856, GNorm = 1.4482, lr_0 = 6.9553e-04
Loss = 2.8651e-03, PNorm = 62.0637, GNorm = 0.8903, lr_0 = 6.8482e-04
Loss = 3.0373e-03, PNorm = 62.1462, GNorm = 0.3215, lr_0 = 6.7428e-04
Loss = 3.4085e-03, PNorm = 62.2109, GNorm = 0.3858, lr_0 = 6.6390e-04
Validation auc = 0.882343
Epoch 7
Loss = 3.0707e-03, PNorm = 62.2867, GNorm = 0.4076, lr_0 = 6.5368e-04
Loss = 2.6248e-03, PNorm = 62.3727, GNorm = 0.3645, lr_0 = 6.4361e-04
Loss = 2.1292e-03, PNorm = 62.4433, GNorm = 0.3945, lr_0 = 6.3370e-04
Loss = 2.6653e-03, PNorm = 62.5198, GNorm = 1.2485, lr_0 = 6.2395e-04
Loss = 2.8415e-03, PNorm = 62.5982, GNorm = 0.7543, lr_0 = 6.1434e-04
Validation auc = 0.893987
Epoch 8
Loss = 3.4248e-03, PNorm = 62.6800, GNorm = 0.3346, lr_0 = 6.0488e-04
Loss = 2.4438e-03, PNorm = 62.7535, GNorm = 0.3714, lr_0 = 5.9557e-04
Loss = 2.3344e-03, PNorm = 62.8253, GNorm = 0.5824, lr_0 = 5.8640e-04
Loss = 2.8542e-03, PNorm = 62.8886, GNorm = 0.8795, lr_0 = 5.7737e-04
Loss = 2.4729e-03, PNorm = 62.9673, GNorm = 0.3950, lr_0 = 5.6848e-04
Validation auc = 0.902155
Epoch 9
Loss = 1.3768e-03, PNorm = 63.0345, GNorm = 0.2770, lr_0 = 5.5973e-04
Loss = 1.7555e-03, PNorm = 63.0972, GNorm = 0.5359, lr_0 = 5.5111e-04
Loss = 2.1955e-03, PNorm = 63.1448, GNorm = 0.5269, lr_0 = 5.4263e-04
Loss = 2.2520e-03, PNorm = 63.1924, GNorm = 0.2466, lr_0 = 5.3427e-04
Loss = 3.0094e-03, PNorm = 63.2325, GNorm = 0.3970, lr_0 = 5.2605e-04
Loss = 2.2990e-03, PNorm = 63.3001, GNorm = 0.7149, lr_0 = 5.1795e-04
Validation auc = 0.907890
Epoch 10
Loss = 2.2553e-03, PNorm = 63.3651, GNorm = 0.6069, lr_0 = 5.0997e-04
Loss = 2.5991e-03, PNorm = 63.4253, GNorm = 1.0419, lr_0 = 5.0212e-04
Loss = 1.5841e-03, PNorm = 63.4900, GNorm = 0.7734, lr_0 = 4.9439e-04
Loss = 1.8501e-03, PNorm = 63.5424, GNorm = 1.1320, lr_0 = 4.8678e-04
Loss = 2.8848e-03, PNorm = 63.5931, GNorm = 1.4131, lr_0 = 4.7928e-04
Validation auc = 0.898332
Epoch 11
Loss = 2.0611e-03, PNorm = 63.6590, GNorm = 0.5732, lr_0 = 4.7190e-04
Loss = 2.0910e-03, PNorm = 63.7270, GNorm = 0.4442, lr_0 = 4.6464e-04
Loss = 2.4309e-03, PNorm = 63.7716, GNorm = 0.4572, lr_0 = 4.5749e-04
Loss = 1.7600e-03, PNorm = 63.8314, GNorm = 0.7451, lr_0 = 4.5044e-04
Loss = 2.0440e-03, PNorm = 63.8760, GNorm = 0.3253, lr_0 = 4.4351e-04
Validation auc = 0.913278
Epoch 12
Loss = 1.0311e-03, PNorm = 63.9355, GNorm = 0.5831, lr_0 = 4.3668e-04
Loss = 1.3740e-03, PNorm = 63.9850, GNorm = 0.5170, lr_0 = 4.2996e-04
Loss = 1.7860e-03, PNorm = 64.0317, GNorm = 0.4888, lr_0 = 4.2334e-04
Loss = 2.6775e-03, PNorm = 64.0793, GNorm = 0.6925, lr_0 = 4.1682e-04
Loss = 2.2259e-03, PNorm = 64.1270, GNorm = 0.5536, lr_0 = 4.1040e-04
Validation auc = 0.909281
Epoch 13
Loss = 8.6807e-04, PNorm = 64.1845, GNorm = 0.3412, lr_0 = 4.0408e-04
Loss = 9.9141e-04, PNorm = 64.2355, GNorm = 0.1679, lr_0 = 3.9786e-04
Loss = 1.9229e-03, PNorm = 64.2641, GNorm = 0.2212, lr_0 = 3.9173e-04
Loss = 2.1560e-03, PNorm = 64.3085, GNorm = 0.4679, lr_0 = 3.8570e-04
Loss = 1.6571e-03, PNorm = 64.3607, GNorm = 0.5104, lr_0 = 3.7976e-04
Loss = 2.4395e-03, PNorm = 64.4039, GNorm = 0.3658, lr_0 = 3.7392e-04
Validation auc = 0.919013
Epoch 14
Loss = 1.3812e-03, PNorm = 64.4439, GNorm = 0.3092, lr_0 = 3.6816e-04
Loss = 2.0603e-03, PNorm = 64.4953, GNorm = 0.6156, lr_0 = 3.6249e-04
Loss = 2.1466e-03, PNorm = 64.5344, GNorm = 0.5773, lr_0 = 3.5691e-04
Loss = 1.5313e-03, PNorm = 64.5831, GNorm = 0.2937, lr_0 = 3.5142e-04
Loss = 1.6249e-03, PNorm = 64.6246, GNorm = 0.2906, lr_0 = 3.4601e-04
Validation auc = 0.916058
Epoch 15
Loss = 1.0727e-03, PNorm = 64.6697, GNorm = 0.2340, lr_0 = 3.4068e-04
Loss = 1.7342e-03, PNorm = 64.7056, GNorm = 0.5892, lr_0 = 3.3543e-04
Loss = 2.0851e-03, PNorm = 64.7584, GNorm = 0.6099, lr_0 = 3.3027e-04
Loss = 1.2069e-03, PNorm = 64.7894, GNorm = 0.5001, lr_0 = 3.2518e-04
Loss = 1.4230e-03, PNorm = 64.8360, GNorm = 0.6464, lr_0 = 3.2018e-04
Validation auc = 0.906500
Epoch 16
Loss = 1.8089e-03, PNorm = 64.8627, GNorm = 0.2464, lr_0 = 3.1525e-04
Loss = 1.3669e-03, PNorm = 64.9026, GNorm = 0.5275, lr_0 = 3.1039e-04
Loss = 1.8442e-03, PNorm = 64.9356, GNorm = 0.5505, lr_0 = 3.0562e-04
Loss = 1.5695e-03, PNorm = 64.9813, GNorm = 0.5285, lr_0 = 3.0091e-04
Loss = 1.2550e-03, PNorm = 65.0165, GNorm = 0.1703, lr_0 = 2.9628e-04
Loss = 1.1614e-03, PNorm = 65.0552, GNorm = 0.2018, lr_0 = 2.9172e-04
Validation auc = 0.912061
Epoch 17
Loss = 1.5156e-03, PNorm = 65.0727, GNorm = 0.4950, lr_0 = 2.8722e-04
Loss = 1.0967e-03, PNorm = 65.1164, GNorm = 0.2885, lr_0 = 2.8280e-04
Loss = 1.8349e-03, PNorm = 65.1434, GNorm = 0.5682, lr_0 = 2.7845e-04
Loss = 1.2387e-03, PNorm = 65.1904, GNorm = 0.1516, lr_0 = 2.7416e-04
Loss = 1.7028e-03, PNorm = 65.2112, GNorm = 0.3135, lr_0 = 2.6994e-04
Validation auc = 0.918144
Epoch 18
Loss = 7.1928e-04, PNorm = 65.2515, GNorm = 0.1104, lr_0 = 2.6578e-04
Loss = 1.6587e-03, PNorm = 65.2682, GNorm = 0.3786, lr_0 = 2.6169e-04
Loss = 1.2519e-03, PNorm = 65.3012, GNorm = 0.1888, lr_0 = 2.5766e-04
Loss = 1.4169e-03, PNorm = 65.3251, GNorm = 0.3357, lr_0 = 2.5370e-04
Loss = 9.8591e-04, PNorm = 65.3566, GNorm = 0.1911, lr_0 = 2.4979e-04
Validation auc = 0.911192
Epoch 19
Loss = 1.6530e-03, PNorm = 65.3745, GNorm = 0.6134, lr_0 = 2.4594e-04
Loss = 1.1961e-03, PNorm = 65.4160, GNorm = 0.4798, lr_0 = 2.4216e-04
Loss = 1.5056e-03, PNorm = 65.4427, GNorm = 0.6753, lr_0 = 2.3843e-04
Loss = 1.1961e-03, PNorm = 65.4753, GNorm = 0.5129, lr_0 = 2.3476e-04
Loss = 1.0466e-03, PNorm = 65.4945, GNorm = 0.2739, lr_0 = 2.3114e-04
Loss = 9.2279e-04, PNorm = 65.5165, GNorm = 0.4494, lr_0 = 2.2758e-04
Validation auc = 0.925443
Epoch 20
Loss = 1.1067e-03, PNorm = 65.5384, GNorm = 0.9091, lr_0 = 2.2408e-04
Loss = 9.4489e-04, PNorm = 65.5616, GNorm = 0.9083, lr_0 = 2.2063e-04
Loss = 1.2268e-03, PNorm = 65.5869, GNorm = 1.2188, lr_0 = 2.1723e-04
Loss = 8.6883e-04, PNorm = 65.6134, GNorm = 0.6230, lr_0 = 2.1389e-04
Loss = 1.6482e-03, PNorm = 65.6295, GNorm = 0.9114, lr_0 = 2.1060e-04
Validation auc = 0.921446
Epoch 21
Loss = 1.1349e-03, PNorm = 65.6596, GNorm = 1.2508, lr_0 = 2.0735e-04
Loss = 9.5800e-04, PNorm = 65.6841, GNorm = 0.6660, lr_0 = 2.0416e-04
Loss = 1.1075e-03, PNorm = 65.6978, GNorm = 0.2965, lr_0 = 2.0102e-04
Loss = 1.0361e-03, PNorm = 65.7256, GNorm = 0.5216, lr_0 = 1.9792e-04
Loss = 1.3318e-03, PNorm = 65.7379, GNorm = 0.7889, lr_0 = 1.9488e-04
Validation auc = 0.921098
Epoch 22
Loss = 6.2218e-04, PNorm = 65.7659, GNorm = 0.4771, lr_0 = 1.9188e-04
Loss = 1.2538e-03, PNorm = 65.7890, GNorm = 0.5912, lr_0 = 1.8892e-04
Loss = 1.2058e-03, PNorm = 65.8134, GNorm = 0.3995, lr_0 = 1.8601e-04
Loss = 1.0304e-03, PNorm = 65.8353, GNorm = 0.5514, lr_0 = 1.8315e-04
Loss = 7.5012e-04, PNorm = 65.8538, GNorm = 0.5765, lr_0 = 1.8033e-04
Validation auc = 0.922836
Epoch 23
Loss = 1.6530e-03, PNorm = 65.8695, GNorm = 0.6819, lr_0 = 1.7755e-04
Loss = 6.3939e-04, PNorm = 65.8813, GNorm = 0.1837, lr_0 = 1.7482e-04
Loss = 1.3359e-03, PNorm = 65.9000, GNorm = 1.1614, lr_0 = 1.7213e-04
Loss = 9.7671e-04, PNorm = 65.9232, GNorm = 1.3516, lr_0 = 1.6948e-04
Loss = 7.8866e-04, PNorm = 65.9320, GNorm = 0.5225, lr_0 = 1.6687e-04
Loss = 8.4775e-04, PNorm = 65.9469, GNorm = 0.6546, lr_0 = 1.6430e-04
Validation auc = 0.925096
Epoch 24
Loss = 6.3064e-04, PNorm = 65.9653, GNorm = 0.6110, lr_0 = 1.6177e-04
Loss = 7.1846e-04, PNorm = 65.9724, GNorm = 0.6697, lr_0 = 1.5928e-04
Loss = 9.6284e-04, PNorm = 65.9865, GNorm = 0.7290, lr_0 = 1.5683e-04
Loss = 9.4346e-04, PNorm = 65.9956, GNorm = 0.3368, lr_0 = 1.5441e-04
Loss = 1.1369e-03, PNorm = 66.0102, GNorm = 0.6652, lr_0 = 1.5203e-04
Validation auc = 0.923879
Epoch 25
Loss = 1.1739e-03, PNorm = 66.0246, GNorm = 0.4785, lr_0 = 1.4969e-04
Loss = 7.3706e-04, PNorm = 66.0425, GNorm = 0.5482, lr_0 = 1.4739e-04
Loss = 6.0572e-04, PNorm = 66.0578, GNorm = 0.4129, lr_0 = 1.4512e-04
Loss = 8.5115e-04, PNorm = 66.0684, GNorm = 0.4833, lr_0 = 1.4288e-04
Loss = 5.2930e-04, PNorm = 66.0810, GNorm = 0.2162, lr_0 = 1.4069e-04
Validation auc = 0.919708
Epoch 26
Loss = 8.4016e-04, PNorm = 66.0888, GNorm = 0.7267, lr_0 = 1.3852e-04
Loss = 5.7323e-04, PNorm = 66.1023, GNorm = 0.2965, lr_0 = 1.3639e-04
Loss = 8.0380e-04, PNorm = 66.1186, GNorm = 0.3445, lr_0 = 1.3429e-04
Loss = 5.7788e-04, PNorm = 66.1284, GNorm = 0.1316, lr_0 = 1.3222e-04
Loss = 6.1341e-04, PNorm = 66.1395, GNorm = 0.6927, lr_0 = 1.3018e-04
Loss = 1.1295e-03, PNorm = 66.1451, GNorm = 1.7283, lr_0 = 1.2818e-04
Validation auc = 0.927007
Epoch 27
Loss = 4.5048e-04, PNorm = 66.1593, GNorm = 0.4231, lr_0 = 1.2621e-04
Loss = 8.0411e-04, PNorm = 66.1637, GNorm = 0.2979, lr_0 = 1.2426e-04
Loss = 9.0481e-04, PNorm = 66.1751, GNorm = 0.3434, lr_0 = 1.2235e-04
Loss = 8.1442e-04, PNorm = 66.1881, GNorm = 0.0526, lr_0 = 1.2047e-04
Loss = 5.1782e-04, PNorm = 66.1952, GNorm = 0.1222, lr_0 = 1.1861e-04
Validation auc = 0.924574
Epoch 28
Loss = 3.4670e-04, PNorm = 66.2060, GNorm = 0.6288, lr_0 = 1.1678e-04
Loss = 7.6569e-04, PNorm = 66.2125, GNorm = 0.8596, lr_0 = 1.1499e-04
Loss = 9.9560e-04, PNorm = 66.2159, GNorm = 0.7044, lr_0 = 1.1322e-04
Loss = 7.6928e-04, PNorm = 66.2250, GNorm = 0.6746, lr_0 = 1.1147e-04
Loss = 7.2556e-04, PNorm = 66.2342, GNorm = 0.1395, lr_0 = 1.0976e-04
Validation auc = 0.924574
Epoch 29
Loss = 2.7748e-04, PNorm = 66.2433, GNorm = 0.4810, lr_0 = 1.0807e-04
Loss = 5.2863e-04, PNorm = 66.2544, GNorm = 0.1005, lr_0 = 1.0640e-04
Loss = 6.8144e-04, PNorm = 66.2591, GNorm = 0.8350, lr_0 = 1.0476e-04
Loss = 5.2908e-04, PNorm = 66.2679, GNorm = 0.5604, lr_0 = 1.0315e-04
Loss = 5.4288e-04, PNorm = 66.2720, GNorm = 0.2641, lr_0 = 1.0156e-04
Loss = 1.2314e-03, PNorm = 66.2819, GNorm = 0.2214, lr_0 = 1.0000e-04
Validation auc = 0.925965
Model 0 best validation auc = 0.927007 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test auc = nan
Ensemble test auc = nan
Fold 9
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': '../../../swansonk/chemprop_ckpt/0406_inhibition_hyperopt.json',
 'cuda': True,
 'data_path': '../../broad2/larger_dataset/0405_inhibition_dedup_binary.csv',
 'dataset_type': 'classification',
 'depth': 5,
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_dim': 200,
 'features_generator': None,
 'features_only': False,
 'features_path': ['../../saved_features/0405_broad_inhibition.npz'],
 'features_scaling': False,
 'features_size': 200,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 1600,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'no_cache': False,
 'num_folds': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'output_size': 1,
 'quiet': True,
 'save_dir': '../ckpt/0405_broad_inhibition_20folds/fold_9',
 'save_smiles_splits': False,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'task_names': ['50uM_Inhibition'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 2654,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': ['../../saved_features/0405_broad_inhibition.npz'],
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Class sizes
50uM_Inhibition 0: 91.93%, 1: 8.07%
Total size = 2,949 | train size = 2,654 | val size = 295 | test size = 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1600, bias=False)
      (W_h): Linear(in_features=1600, out_features=1600, bias=False)
      (W_o): Linear(in_features=1733, out_features=1600, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,571,401
Moving model to cuda
Epoch 0
Loss = 8.5142e-03, PNorm = 59.4308, GNorm = 0.7597, lr_0 = 1.8491e-04
Loss = 5.5528e-03, PNorm = 59.4463, GNorm = 0.7339, lr_0 = 2.6981e-04
Loss = 5.9439e-03, PNorm = 59.4639, GNorm = 1.4363, lr_0 = 3.5472e-04
Loss = 5.8058e-03, PNorm = 59.4850, GNorm = 1.5163, lr_0 = 4.3962e-04
Loss = 5.0092e-03, PNorm = 59.5092, GNorm = 0.3324, lr_0 = 5.2453e-04
Validation auc = 0.832639
Epoch 1
Loss = 5.1351e-03, PNorm = 59.5348, GNorm = 0.7869, lr_0 = 6.0943e-04
Loss = 5.9150e-03, PNorm = 59.5724, GNorm = 0.9781, lr_0 = 6.9434e-04
Loss = 4.1039e-03, PNorm = 59.6325, GNorm = 0.1968, lr_0 = 7.7925e-04
Loss = 6.0832e-03, PNorm = 59.7013, GNorm = 0.3814, lr_0 = 8.6415e-04
Loss = 5.8948e-03, PNorm = 59.7911, GNorm = 0.5369, lr_0 = 9.4906e-04
Validation auc = 0.919616
Epoch 2
Loss = 5.4432e-03, PNorm = 59.8944, GNorm = 0.4386, lr_0 = 9.9381e-04
Loss = 5.3156e-03, PNorm = 59.9794, GNorm = 0.3156, lr_0 = 9.7851e-04
Loss = 4.7553e-03, PNorm = 60.0682, GNorm = 1.0173, lr_0 = 9.6345e-04
Loss = 4.0006e-03, PNorm = 60.1832, GNorm = 0.3381, lr_0 = 9.4861e-04
Loss = 4.9070e-03, PNorm = 60.2692, GNorm = 0.3167, lr_0 = 9.3401e-04
Validation auc = 0.961369
Epoch 3
Loss = 4.4146e-03, PNorm = 60.3497, GNorm = 0.3424, lr_0 = 9.1963e-04
Loss = 4.4198e-03, PNorm = 60.4136, GNorm = 0.3721, lr_0 = 9.0547e-04
Loss = 4.9243e-03, PNorm = 60.4791, GNorm = 0.8558, lr_0 = 8.9153e-04
Loss = 4.4473e-03, PNorm = 60.5651, GNorm = 0.8428, lr_0 = 8.7780e-04
Loss = 4.7676e-03, PNorm = 60.6455, GNorm = 0.2818, lr_0 = 8.6429e-04
Loss = 3.0151e-03, PNorm = 60.7400, GNorm = 0.8089, lr_0 = 8.5098e-04
Validation auc = 0.952348
Epoch 4
Loss = 4.5775e-03, PNorm = 60.8161, GNorm = 0.4863, lr_0 = 8.3788e-04
Loss = 4.5481e-03, PNorm = 60.9188, GNorm = 0.6243, lr_0 = 8.2498e-04
Loss = 4.0962e-03, PNorm = 61.0219, GNorm = 0.2899, lr_0 = 8.1228e-04
Loss = 4.6818e-03, PNorm = 61.1006, GNorm = 0.3365, lr_0 = 7.9977e-04
Loss = 3.0539e-03, PNorm = 61.1881, GNorm = 0.6827, lr_0 = 7.8746e-04
Validation auc = 0.967731
Epoch 5
Loss = 3.0764e-03, PNorm = 61.2579, GNorm = 0.3488, lr_0 = 7.7533e-04
Loss = 3.1975e-03, PNorm = 61.3270, GNorm = 0.3930, lr_0 = 7.6340e-04
Loss = 4.3384e-03, PNorm = 61.3968, GNorm = 1.4151, lr_0 = 7.5164e-04
Loss = 4.6848e-03, PNorm = 61.4893, GNorm = 0.3356, lr_0 = 7.4007e-04
Loss = 3.6747e-03, PNorm = 61.5960, GNorm = 0.4277, lr_0 = 7.2867e-04
Validation auc = 0.974208
Epoch 6
Loss = 3.7779e-03, PNorm = 61.6802, GNorm = 0.4200, lr_0 = 7.1746e-04
Loss = 2.9620e-03, PNorm = 61.7674, GNorm = 0.3375, lr_0 = 7.0641e-04
Loss = 2.8967e-03, PNorm = 61.8616, GNorm = 0.5009, lr_0 = 6.9553e-04
Loss = 4.4777e-03, PNorm = 61.9467, GNorm = 0.7214, lr_0 = 6.8482e-04
Loss = 2.7189e-03, PNorm = 62.0334, GNorm = 0.2124, lr_0 = 6.7428e-04
Loss = 3.0238e-03, PNorm = 62.1154, GNorm = 0.2877, lr_0 = 6.6390e-04
Validation auc = 0.975827
Epoch 7
Loss = 2.8363e-03, PNorm = 62.1889, GNorm = 0.2933, lr_0 = 6.5368e-04
Loss = 3.2421e-03, PNorm = 62.2726, GNorm = 0.3485, lr_0 = 6.4361e-04
Loss = 2.2509e-03, PNorm = 62.3629, GNorm = 0.6066, lr_0 = 6.3370e-04
Loss = 3.2590e-03, PNorm = 62.4297, GNorm = 0.3972, lr_0 = 6.2395e-04
Loss = 2.6699e-03, PNorm = 62.5191, GNorm = 0.4167, lr_0 = 6.1434e-04
Validation auc = 0.982420
Epoch 8
Loss = 2.2340e-03, PNorm = 62.6126, GNorm = 0.8027, lr_0 = 6.0488e-04
Loss = 2.7078e-03, PNorm = 62.6741, GNorm = 0.5752, lr_0 = 5.9557e-04
Loss = 2.3930e-03, PNorm = 62.7499, GNorm = 0.2783, lr_0 = 5.8640e-04
Loss = 2.6824e-03, PNorm = 62.8119, GNorm = 1.0029, lr_0 = 5.7737e-04
Loss = 3.0804e-03, PNorm = 62.8711, GNorm = 0.6094, lr_0 = 5.6848e-04
Validation auc = 0.981610
Epoch 9
Loss = 3.5678e-03, PNorm = 62.9479, GNorm = 0.5427, lr_0 = 5.5973e-04
Loss = 2.7426e-03, PNorm = 63.0335, GNorm = 0.4171, lr_0 = 5.5111e-04
Loss = 2.4577e-03, PNorm = 63.1278, GNorm = 0.8928, lr_0 = 5.4263e-04
Loss = 2.3729e-03, PNorm = 63.2002, GNorm = 0.2582, lr_0 = 5.3427e-04
Loss = 2.2723e-03, PNorm = 63.2761, GNorm = 0.4795, lr_0 = 5.2605e-04
Loss = 2.4709e-03, PNorm = 63.3391, GNorm = 0.3693, lr_0 = 5.1795e-04
Validation auc = 0.983229
Epoch 10
Loss = 2.1428e-03, PNorm = 63.3980, GNorm = 0.2145, lr_0 = 5.0997e-04
Loss = 2.3417e-03, PNorm = 63.4504, GNorm = 0.5248, lr_0 = 5.0212e-04
Loss = 2.6467e-03, PNorm = 63.5003, GNorm = 0.5653, lr_0 = 4.9439e-04
Loss = 1.8715e-03, PNorm = 63.5653, GNorm = 0.2548, lr_0 = 4.8678e-04
Loss = 1.6380e-03, PNorm = 63.6276, GNorm = 0.3719, lr_0 = 4.7928e-04
Validation auc = 0.974902
Epoch 11
Loss = 2.2974e-03, PNorm = 63.6853, GNorm = 0.5781, lr_0 = 4.7190e-04
Loss = 2.4250e-03, PNorm = 63.7537, GNorm = 0.3878, lr_0 = 4.6464e-04
Loss = 1.9614e-03, PNorm = 63.8173, GNorm = 0.5722, lr_0 = 4.5749e-04
Loss = 2.3911e-03, PNorm = 63.8730, GNorm = 0.3659, lr_0 = 4.5044e-04
Loss = 1.5493e-03, PNorm = 63.9197, GNorm = 0.4040, lr_0 = 4.4351e-04
Validation auc = 0.984155
Epoch 12
Loss = 2.4290e-03, PNorm = 63.9623, GNorm = 0.7773, lr_0 = 4.3668e-04
Loss = 2.3482e-03, PNorm = 64.0245, GNorm = 0.6986, lr_0 = 4.2996e-04
Loss = 2.0868e-03, PNorm = 64.0737, GNorm = 1.2016, lr_0 = 4.2334e-04
Loss = 1.8761e-03, PNorm = 64.1384, GNorm = 0.6788, lr_0 = 4.1682e-04
Loss = 1.7103e-03, PNorm = 64.1859, GNorm = 0.5703, lr_0 = 4.1040e-04
Validation auc = 0.984039
Epoch 13
Loss = 4.4416e-04, PNorm = 64.2375, GNorm = 0.2761, lr_0 = 4.0408e-04
Loss = 2.0825e-03, PNorm = 64.2833, GNorm = 0.6280, lr_0 = 3.9786e-04
Loss = 1.6301e-03, PNorm = 64.3308, GNorm = 0.2833, lr_0 = 3.9173e-04
Loss = 1.6826e-03, PNorm = 64.3773, GNorm = 0.4439, lr_0 = 3.8570e-04
Loss = 2.5018e-03, PNorm = 64.4287, GNorm = 0.7582, lr_0 = 3.7976e-04
Loss = 1.8819e-03, PNorm = 64.4781, GNorm = 0.3412, lr_0 = 3.7392e-04
Validation auc = 0.984386
Epoch 14
Loss = 1.5104e-03, PNorm = 64.5224, GNorm = 0.3201, lr_0 = 3.6816e-04
Loss = 1.7834e-03, PNorm = 64.5715, GNorm = 0.3562, lr_0 = 3.6249e-04
Loss = 1.5943e-03, PNorm = 64.6219, GNorm = 0.5293, lr_0 = 3.5691e-04
Loss = 1.6672e-03, PNorm = 64.6671, GNorm = 0.8088, lr_0 = 3.5142e-04
Loss = 2.2454e-03, PNorm = 64.7072, GNorm = 0.5718, lr_0 = 3.4601e-04
Validation auc = 0.986352
Epoch 15
Loss = 2.3545e-03, PNorm = 64.7494, GNorm = 0.7110, lr_0 = 3.4068e-04
Loss = 1.1477e-03, PNorm = 64.7972, GNorm = 0.1737, lr_0 = 3.3543e-04
Loss = 1.3209e-03, PNorm = 64.8419, GNorm = 0.2353, lr_0 = 3.3027e-04
Loss = 1.8276e-03, PNorm = 64.8750, GNorm = 0.9324, lr_0 = 3.2518e-04
Loss = 2.0309e-03, PNorm = 64.9068, GNorm = 0.6223, lr_0 = 3.2018e-04
Validation auc = 0.988434
Epoch 16
Loss = 1.9079e-03, PNorm = 64.9545, GNorm = 0.4844, lr_0 = 3.1525e-04
Loss = 1.5826e-03, PNorm = 64.9930, GNorm = 0.4524, lr_0 = 3.1039e-04
Loss = 1.1056e-03, PNorm = 65.0278, GNorm = 0.2916, lr_0 = 3.0562e-04
Loss = 2.0943e-03, PNorm = 65.0636, GNorm = 0.4649, lr_0 = 3.0091e-04
Loss = 1.1370e-03, PNorm = 65.0981, GNorm = 0.2937, lr_0 = 2.9628e-04
Loss = 1.2795e-03, PNorm = 65.1364, GNorm = 0.6496, lr_0 = 2.9172e-04
Validation auc = 0.988550
Epoch 17
Loss = 1.0924e-03, PNorm = 65.1830, GNorm = 0.3248, lr_0 = 2.8722e-04
Loss = 1.2588e-03, PNorm = 65.2071, GNorm = 0.4003, lr_0 = 2.8280e-04
Loss = 1.2093e-03, PNorm = 65.2506, GNorm = 0.4779, lr_0 = 2.7845e-04
Loss = 1.5757e-03, PNorm = 65.2760, GNorm = 0.4717, lr_0 = 2.7416e-04
Loss = 1.7083e-03, PNorm = 65.3056, GNorm = 0.6845, lr_0 = 2.6994e-04
Validation auc = 0.989822
Epoch 18
Loss = 1.1728e-03, PNorm = 65.3328, GNorm = 0.2968, lr_0 = 2.6578e-04
Loss = 1.4220e-03, PNorm = 65.3669, GNorm = 0.5183, lr_0 = 2.6169e-04
Loss = 1.5555e-03, PNorm = 65.4006, GNorm = 0.3047, lr_0 = 2.5766e-04
Loss = 1.2302e-03, PNorm = 65.4295, GNorm = 0.5199, lr_0 = 2.5370e-04
Loss = 9.5633e-04, PNorm = 65.4634, GNorm = 0.7612, lr_0 = 2.4979e-04
Validation auc = 0.985774
Epoch 19
Loss = 1.1779e-03, PNorm = 65.4853, GNorm = 0.5950, lr_0 = 2.4594e-04
Loss = 1.4106e-03, PNorm = 65.5106, GNorm = 0.4462, lr_0 = 2.4216e-04
Loss = 9.2439e-04, PNorm = 65.5469, GNorm = 0.5806, lr_0 = 2.3843e-04
Loss = 9.4221e-04, PNorm = 65.5687, GNorm = 0.7881, lr_0 = 2.3476e-04
Loss = 1.2208e-03, PNorm = 65.5963, GNorm = 1.4968, lr_0 = 2.3114e-04
Loss = 1.2276e-03, PNorm = 65.6138, GNorm = 0.5640, lr_0 = 2.2758e-04
Validation auc = 0.985195
Epoch 20
Loss = 1.5712e-03, PNorm = 65.6448, GNorm = 0.3050, lr_0 = 2.2408e-04
Loss = 1.0872e-03, PNorm = 65.6726, GNorm = 1.3373, lr_0 = 2.2063e-04
Loss = 1.0253e-03, PNorm = 65.7018, GNorm = 0.1604, lr_0 = 2.1723e-04
Loss = 9.6918e-04, PNorm = 65.7233, GNorm = 0.6584, lr_0 = 2.1389e-04
Loss = 1.5068e-03, PNorm = 65.7348, GNorm = 1.8427, lr_0 = 2.1060e-04
Validation auc = 0.989012
Epoch 21
Loss = 9.9501e-04, PNorm = 65.7676, GNorm = 0.3274, lr_0 = 2.0735e-04
Loss = 8.8491e-04, PNorm = 65.7861, GNorm = 0.5759, lr_0 = 2.0416e-04
Loss = 8.8437e-04, PNorm = 65.8070, GNorm = 0.2961, lr_0 = 2.0102e-04
Loss = 1.2035e-03, PNorm = 65.8238, GNorm = 0.4695, lr_0 = 1.9792e-04
Loss = 1.3131e-03, PNorm = 65.8396, GNorm = 0.5867, lr_0 = 1.9488e-04
Validation auc = 0.987046
Epoch 22
Loss = 1.2172e-03, PNorm = 65.8682, GNorm = 1.0675, lr_0 = 1.9188e-04
Loss = 7.9226e-04, PNorm = 65.8907, GNorm = 0.6906, lr_0 = 1.8892e-04
Loss = 8.8481e-04, PNorm = 65.9127, GNorm = 0.0645, lr_0 = 1.8601e-04
Loss = 7.7472e-04, PNorm = 65.9389, GNorm = 0.3729, lr_0 = 1.8315e-04
Loss = 1.4131e-03, PNorm = 65.9467, GNorm = 0.7300, lr_0 = 1.8033e-04
Validation auc = 0.987856
Epoch 23
Loss = 9.8164e-04, PNorm = 65.9726, GNorm = 0.4677, lr_0 = 1.7755e-04
Loss = 1.2527e-03, PNorm = 65.9916, GNorm = 0.1626, lr_0 = 1.7482e-04
Loss = 8.0441e-04, PNorm = 66.0080, GNorm = 0.3301, lr_0 = 1.7213e-04
Loss = 1.2103e-03, PNorm = 66.0321, GNorm = 1.0792, lr_0 = 1.6948e-04
Loss = 9.1293e-04, PNorm = 66.0438, GNorm = 0.8286, lr_0 = 1.6687e-04
Loss = 7.8888e-04, PNorm = 66.0592, GNorm = 0.4066, lr_0 = 1.6430e-04
Validation auc = 0.987624
Epoch 24
Loss = 7.6791e-04, PNorm = 66.0714, GNorm = 0.4403, lr_0 = 1.6177e-04
Loss = 1.0029e-03, PNorm = 66.0863, GNorm = 0.9225, lr_0 = 1.5928e-04
Loss = 1.0100e-03, PNorm = 66.1075, GNorm = 0.5507, lr_0 = 1.5683e-04
Loss = 8.9757e-04, PNorm = 66.1259, GNorm = 0.9522, lr_0 = 1.5441e-04
Loss = 6.8703e-04, PNorm = 66.1367, GNorm = 0.4409, lr_0 = 1.5203e-04
Validation auc = 0.988318
Epoch 25
Loss = 8.1351e-04, PNorm = 66.1530, GNorm = 0.8154, lr_0 = 1.4969e-04
Loss = 5.5942e-04, PNorm = 66.1688, GNorm = 0.5779, lr_0 = 1.4739e-04
Loss = 8.4082e-04, PNorm = 66.1786, GNorm = 0.6574, lr_0 = 1.4512e-04
Loss = 9.3338e-04, PNorm = 66.1867, GNorm = 0.4791, lr_0 = 1.4288e-04
Loss = 8.7911e-04, PNorm = 66.2071, GNorm = 0.2768, lr_0 = 1.4069e-04
Validation auc = 0.986121
Epoch 26
Loss = 4.5197e-04, PNorm = 66.2156, GNorm = 0.2478, lr_0 = 1.3852e-04
Loss = 7.9601e-04, PNorm = 66.2307, GNorm = 0.6180, lr_0 = 1.3639e-04
Loss = 8.3323e-04, PNorm = 66.2463, GNorm = 1.2358, lr_0 = 1.3429e-04
Loss = 5.3503e-04, PNorm = 66.2571, GNorm = 0.3153, lr_0 = 1.3222e-04
Loss = 8.9743e-04, PNorm = 66.2662, GNorm = 0.4660, lr_0 = 1.3018e-04
Loss = 7.2991e-04, PNorm = 66.2848, GNorm = 0.9776, lr_0 = 1.2818e-04
Validation auc = 0.978603
Epoch 27
Loss = 6.9067e-04, PNorm = 66.2928, GNorm = 0.2804, lr_0 = 1.2621e-04
Loss = 6.7557e-04, PNorm = 66.3056, GNorm = 0.2371, lr_0 = 1.2426e-04
Loss = 6.1317e-04, PNorm = 66.3168, GNorm = 0.2562, lr_0 = 1.2235e-04
Loss = 1.1150e-03, PNorm = 66.3283, GNorm = 0.9589, lr_0 = 1.2047e-04
Loss = 8.9255e-04, PNorm = 66.3362, GNorm = 0.9405, lr_0 = 1.1861e-04
Validation auc = 0.983576
Epoch 28
Loss = 5.8215e-04, PNorm = 66.3449, GNorm = 0.2408, lr_0 = 1.1678e-04
Loss = 9.6464e-04, PNorm = 66.3626, GNorm = 0.6669, lr_0 = 1.1499e-04
Loss = 8.0467e-04, PNorm = 66.3685, GNorm = 0.3115, lr_0 = 1.1322e-04
Loss = 5.3888e-04, PNorm = 66.3807, GNorm = 0.3839, lr_0 = 1.1147e-04
Loss = 5.4418e-04, PNorm = 66.3862, GNorm = 0.4656, lr_0 = 1.0976e-04
Validation auc = 0.985774
Epoch 29
Loss = 5.6947e-04, PNorm = 66.3970, GNorm = 0.6803, lr_0 = 1.0807e-04
Loss = 6.5503e-04, PNorm = 66.4044, GNorm = 1.5098, lr_0 = 1.0640e-04
Loss = 8.3848e-04, PNorm = 66.4100, GNorm = 0.4045, lr_0 = 1.0476e-04
Loss = 4.9255e-04, PNorm = 66.4232, GNorm = 0.1263, lr_0 = 1.0315e-04
Loss = 6.0857e-04, PNorm = 66.4315, GNorm = 0.2687, lr_0 = 1.0156e-04
Loss = 9.6321e-04, PNorm = 66.4343, GNorm = 0.1424, lr_0 = 1.0000e-04
Validation auc = 0.985542
Model 0 best validation auc = 0.989822 on epoch 17
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test auc = nan
Ensemble test auc = nan
Fold 10
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': '../../../swansonk/chemprop_ckpt/0406_inhibition_hyperopt.json',
 'cuda': True,
 'data_path': '../../broad2/larger_dataset/0405_inhibition_dedup_binary.csv',
 'dataset_type': 'classification',
 'depth': 5,
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_dim': 200,
 'features_generator': None,
 'features_only': False,
 'features_path': ['../../saved_features/0405_broad_inhibition.npz'],
 'features_scaling': False,
 'features_size': 200,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 1600,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'no_cache': False,
 'num_folds': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'output_size': 1,
 'quiet': True,
 'save_dir': '../ckpt/0405_broad_inhibition_20folds/fold_10',
 'save_smiles_splits': False,
 'seed': 10,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'task_names': ['50uM_Inhibition'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 2654,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': ['../../saved_features/0405_broad_inhibition.npz'],
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 10
Class sizes
50uM_Inhibition 0: 91.93%, 1: 8.07%
Total size = 2,949 | train size = 2,654 | val size = 295 | test size = 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1600, bias=False)
      (W_h): Linear(in_features=1600, out_features=1600, bias=False)
      (W_o): Linear(in_features=1733, out_features=1600, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,571,401
Moving model to cuda
Epoch 0
Loss = 7.9091e-03, PNorm = 59.4389, GNorm = 0.4817, lr_0 = 1.8491e-04
Loss = 6.4306e-03, PNorm = 59.4556, GNorm = 0.4192, lr_0 = 2.6981e-04
Loss = 5.0450e-03, PNorm = 59.4732, GNorm = 0.6443, lr_0 = 3.5472e-04
Loss = 5.5097e-03, PNorm = 59.4948, GNorm = 0.4090, lr_0 = 4.3962e-04
Loss = 5.8106e-03, PNorm = 59.5178, GNorm = 0.6097, lr_0 = 5.2453e-04
Validation auc = 0.803237
Epoch 1
Loss = 4.5662e-03, PNorm = 59.5476, GNorm = 0.6637, lr_0 = 6.0943e-04
Loss = 4.6901e-03, PNorm = 59.5949, GNorm = 1.0513, lr_0 = 6.9434e-04
Loss = 4.8437e-03, PNorm = 59.6503, GNorm = 1.2931, lr_0 = 7.7925e-04
Loss = 5.1065e-03, PNorm = 59.7134, GNorm = 0.4313, lr_0 = 8.6415e-04
Loss = 4.8867e-03, PNorm = 59.8011, GNorm = 0.7004, lr_0 = 9.4906e-04
Validation auc = 0.812065
Epoch 2
Loss = 4.7184e-03, PNorm = 59.8965, GNorm = 0.4995, lr_0 = 9.9381e-04
Loss = 4.3107e-03, PNorm = 59.9955, GNorm = 0.4599, lr_0 = 9.7851e-04
Loss = 4.2637e-03, PNorm = 60.1014, GNorm = 1.3592, lr_0 = 9.6345e-04
Loss = 4.7751e-03, PNorm = 60.1981, GNorm = 0.3642, lr_0 = 9.4861e-04
Loss = 3.4449e-03, PNorm = 60.3045, GNorm = 0.2659, lr_0 = 9.3401e-04
Validation auc = 0.867442
Epoch 3
Loss = 4.3430e-03, PNorm = 60.3859, GNorm = 0.5759, lr_0 = 9.1963e-04
Loss = 3.2876e-03, PNorm = 60.4909, GNorm = 0.2396, lr_0 = 9.0547e-04
Loss = 3.4180e-03, PNorm = 60.5828, GNorm = 0.7238, lr_0 = 8.9153e-04
Loss = 4.6345e-03, PNorm = 60.6753, GNorm = 0.6566, lr_0 = 8.7780e-04
Loss = 3.8695e-03, PNorm = 60.7769, GNorm = 0.7248, lr_0 = 8.6429e-04
Loss = 4.0021e-03, PNorm = 60.8787, GNorm = 0.3504, lr_0 = 8.5098e-04
Validation auc = 0.868780
Epoch 4
Loss = 4.1349e-03, PNorm = 60.9792, GNorm = 0.9881, lr_0 = 8.3788e-04
Loss = 3.7560e-03, PNorm = 61.0814, GNorm = 0.7976, lr_0 = 8.2498e-04
Loss = 3.1988e-03, PNorm = 61.1767, GNorm = 0.4266, lr_0 = 8.1228e-04
Loss = 3.1041e-03, PNorm = 61.2766, GNorm = 0.4783, lr_0 = 7.9977e-04
Loss = 3.4398e-03, PNorm = 61.3552, GNorm = 0.5174, lr_0 = 7.8746e-04
Validation auc = 0.881354
Epoch 5
Loss = 3.7067e-03, PNorm = 61.4540, GNorm = 0.5464, lr_0 = 7.7533e-04
Loss = 3.5384e-03, PNorm = 61.5496, GNorm = 0.5813, lr_0 = 7.6340e-04
Loss = 2.2455e-03, PNorm = 61.6479, GNorm = 0.2644, lr_0 = 7.5164e-04
Loss = 3.7301e-03, PNorm = 61.7373, GNorm = 0.3992, lr_0 = 7.4007e-04
Loss = 3.2235e-03, PNorm = 61.8595, GNorm = 0.3338, lr_0 = 7.2867e-04
Validation auc = 0.888844
Epoch 6
Loss = 3.8412e-03, PNorm = 61.9706, GNorm = 0.5052, lr_0 = 7.1746e-04
Loss = 2.1875e-03, PNorm = 62.0644, GNorm = 0.3034, lr_0 = 7.0641e-04
Loss = 3.1125e-03, PNorm = 62.1635, GNorm = 0.6867, lr_0 = 6.9553e-04
Loss = 3.2433e-03, PNorm = 62.2436, GNorm = 0.4033, lr_0 = 6.8482e-04
Loss = 2.8000e-03, PNorm = 62.3189, GNorm = 0.2867, lr_0 = 6.7428e-04
Loss = 2.2377e-03, PNorm = 62.4058, GNorm = 0.3417, lr_0 = 6.6390e-04
Validation auc = 0.896201
Epoch 7
Loss = 2.6927e-03, PNorm = 62.4827, GNorm = 0.4500, lr_0 = 6.5368e-04
Loss = 2.0655e-03, PNorm = 62.5554, GNorm = 0.4691, lr_0 = 6.4361e-04
Loss = 2.6388e-03, PNorm = 62.6326, GNorm = 0.4505, lr_0 = 6.3370e-04
Loss = 3.1624e-03, PNorm = 62.7078, GNorm = 0.5692, lr_0 = 6.2395e-04
Loss = 2.3174e-03, PNorm = 62.7807, GNorm = 0.3857, lr_0 = 6.1434e-04
Validation auc = 0.890583
Epoch 8
Loss = 2.9910e-03, PNorm = 62.8546, GNorm = 0.6518, lr_0 = 6.0488e-04
Loss = 1.9674e-03, PNorm = 62.9260, GNorm = 0.4980, lr_0 = 5.9557e-04
Loss = 2.3440e-03, PNorm = 62.9809, GNorm = 0.2998, lr_0 = 5.8640e-04
Loss = 2.2355e-03, PNorm = 63.0410, GNorm = 0.7199, lr_0 = 5.7737e-04
Loss = 2.4493e-03, PNorm = 63.1088, GNorm = 0.4459, lr_0 = 5.6848e-04
Validation auc = 0.897539
Epoch 9
Loss = 3.0174e-03, PNorm = 63.1831, GNorm = 0.5180, lr_0 = 5.5973e-04
Loss = 1.3800e-03, PNorm = 63.2623, GNorm = 0.4099, lr_0 = 5.5111e-04
Loss = 1.9526e-03, PNorm = 63.3367, GNorm = 0.3251, lr_0 = 5.4263e-04
Loss = 2.5850e-03, PNorm = 63.4085, GNorm = 0.6020, lr_0 = 5.3427e-04
Loss = 2.3428e-03, PNorm = 63.4782, GNorm = 0.2467, lr_0 = 5.2605e-04
Loss = 2.4584e-03, PNorm = 63.5265, GNorm = 0.3418, lr_0 = 5.1795e-04
Validation auc = 0.902354
Epoch 10
Loss = 2.4408e-03, PNorm = 63.5936, GNorm = 0.3658, lr_0 = 5.0997e-04
Loss = 1.7362e-03, PNorm = 63.6554, GNorm = 0.3071, lr_0 = 5.0212e-04
Loss = 2.3827e-03, PNorm = 63.7197, GNorm = 0.4117, lr_0 = 4.9439e-04
Loss = 2.1008e-03, PNorm = 63.7780, GNorm = 0.4469, lr_0 = 4.8678e-04
Loss = 1.8763e-03, PNorm = 63.8305, GNorm = 0.3923, lr_0 = 4.7928e-04
Validation auc = 0.911182
Epoch 11
Loss = 1.7951e-03, PNorm = 63.8844, GNorm = 0.4539, lr_0 = 4.7190e-04
Loss = 1.5551e-03, PNorm = 63.9408, GNorm = 0.4698, lr_0 = 4.6464e-04
Loss = 1.5904e-03, PNorm = 63.9840, GNorm = 0.4043, lr_0 = 4.5749e-04
Loss = 2.1024e-03, PNorm = 64.0307, GNorm = 0.3147, lr_0 = 4.5044e-04
Loss = 2.1536e-03, PNorm = 64.0843, GNorm = 0.2395, lr_0 = 4.4351e-04
Validation auc = 0.905029
Epoch 12
Loss = 2.7681e-03, PNorm = 64.1511, GNorm = 0.8239, lr_0 = 4.3668e-04
Loss = 1.6050e-03, PNorm = 64.2235, GNorm = 0.2256, lr_0 = 4.2996e-04
Loss = 1.5939e-03, PNorm = 64.2829, GNorm = 0.6946, lr_0 = 4.2334e-04
Loss = 1.7061e-03, PNorm = 64.3305, GNorm = 0.4873, lr_0 = 4.1682e-04
Loss = 2.1813e-03, PNorm = 64.3648, GNorm = 0.4089, lr_0 = 4.1040e-04
Validation auc = 0.910781
Epoch 13
Loss = 2.7236e-04, PNorm = 64.4223, GNorm = 0.1050, lr_0 = 4.0408e-04
Loss = 1.4668e-03, PNorm = 64.4737, GNorm = 0.4647, lr_0 = 3.9786e-04
Loss = 1.6745e-03, PNorm = 64.5141, GNorm = 0.5312, lr_0 = 3.9173e-04
Loss = 1.9255e-03, PNorm = 64.5603, GNorm = 0.3935, lr_0 = 3.8570e-04
Loss = 2.0501e-03, PNorm = 64.6062, GNorm = 0.2842, lr_0 = 3.7976e-04
Loss = 1.9199e-03, PNorm = 64.6557, GNorm = 0.3885, lr_0 = 3.7392e-04
Validation auc = 0.932852
Epoch 14
Loss = 1.2066e-03, PNorm = 64.7098, GNorm = 0.5202, lr_0 = 3.6816e-04
Loss = 1.3848e-03, PNorm = 64.7642, GNorm = 0.5564, lr_0 = 3.6249e-04
Loss = 1.6845e-03, PNorm = 64.8120, GNorm = 0.3403, lr_0 = 3.5691e-04
Loss = 1.8054e-03, PNorm = 64.8516, GNorm = 0.3352, lr_0 = 3.5142e-04
Loss = 2.2184e-03, PNorm = 64.8761, GNorm = 0.4248, lr_0 = 3.4601e-04
Validation auc = 0.933253
Epoch 15
Loss = 1.4167e-03, PNorm = 64.9146, GNorm = 0.2851, lr_0 = 3.4068e-04
Loss = 1.2883e-03, PNorm = 64.9598, GNorm = 0.5698, lr_0 = 3.3543e-04
Loss = 1.7482e-03, PNorm = 64.9970, GNorm = 0.8188, lr_0 = 3.3027e-04
Loss = 1.3344e-03, PNorm = 65.0218, GNorm = 0.3713, lr_0 = 3.2518e-04
Loss = 1.1837e-03, PNorm = 65.0606, GNorm = 0.5766, lr_0 = 3.2018e-04
Validation auc = 0.925495
Epoch 16
Loss = 1.3458e-03, PNorm = 65.0941, GNorm = 0.5271, lr_0 = 3.1525e-04
Loss = 1.4654e-03, PNorm = 65.1351, GNorm = 0.2128, lr_0 = 3.1039e-04
Loss = 1.5472e-03, PNorm = 65.1679, GNorm = 0.2875, lr_0 = 3.0562e-04
Loss = 1.4802e-03, PNorm = 65.2001, GNorm = 0.7228, lr_0 = 3.0091e-04
Loss = 1.5368e-03, PNorm = 65.2436, GNorm = 0.6495, lr_0 = 2.9628e-04
Loss = 8.8366e-04, PNorm = 65.2735, GNorm = 0.6569, lr_0 = 2.9172e-04
Validation auc = 0.926164
Epoch 17
Loss = 1.3165e-03, PNorm = 65.3090, GNorm = 0.4081, lr_0 = 2.8722e-04
Loss = 1.2571e-03, PNorm = 65.3492, GNorm = 0.2000, lr_0 = 2.8280e-04
Loss = 1.6874e-03, PNorm = 65.3715, GNorm = 0.7997, lr_0 = 2.7845e-04
Loss = 1.3860e-03, PNorm = 65.3985, GNorm = 0.4349, lr_0 = 2.7416e-04
Loss = 9.8865e-04, PNorm = 65.4337, GNorm = 0.4534, lr_0 = 2.6994e-04
Validation auc = 0.934457
Epoch 18
Loss = 1.1177e-03, PNorm = 65.4634, GNorm = 0.9285, lr_0 = 2.6578e-04
Loss = 9.7336e-04, PNorm = 65.4948, GNorm = 0.0676, lr_0 = 2.6169e-04
Loss = 1.3732e-03, PNorm = 65.5192, GNorm = 0.2722, lr_0 = 2.5766e-04
Loss = 1.1758e-03, PNorm = 65.5543, GNorm = 0.7009, lr_0 = 2.5370e-04
Loss = 1.5424e-03, PNorm = 65.5723, GNorm = 0.3003, lr_0 = 2.4979e-04
Validation auc = 0.917202
Epoch 19
Loss = 7.6001e-04, PNorm = 65.5986, GNorm = 0.3920, lr_0 = 2.4594e-04
Loss = 1.2415e-03, PNorm = 65.6230, GNorm = 0.8134, lr_0 = 2.4216e-04
Loss = 8.9357e-04, PNorm = 65.6529, GNorm = 0.6887, lr_0 = 2.3843e-04
Loss = 1.0778e-03, PNorm = 65.6811, GNorm = 0.5192, lr_0 = 2.3476e-04
Loss = 1.2929e-03, PNorm = 65.6981, GNorm = 0.3444, lr_0 = 2.3114e-04
Loss = 1.5318e-03, PNorm = 65.7336, GNorm = 0.8174, lr_0 = 2.2758e-04
Validation auc = 0.910781
Epoch 20
Loss = 1.6150e-03, PNorm = 65.7545, GNorm = 0.4847, lr_0 = 2.2408e-04
Loss = 1.1962e-03, PNorm = 65.7871, GNorm = 0.3329, lr_0 = 2.2063e-04
Loss = 1.0724e-03, PNorm = 65.8137, GNorm = 0.5042, lr_0 = 2.1723e-04
Loss = 9.1035e-04, PNorm = 65.8277, GNorm = 0.7433, lr_0 = 2.1389e-04
Loss = 1.0504e-03, PNorm = 65.8460, GNorm = 0.1661, lr_0 = 2.1060e-04
Validation auc = 0.914259
Epoch 21
Loss = 5.3308e-04, PNorm = 65.8752, GNorm = 0.2865, lr_0 = 2.0735e-04
Loss = 1.1378e-03, PNorm = 65.8900, GNorm = 0.3951, lr_0 = 2.0416e-04
Loss = 1.0219e-03, PNorm = 65.9166, GNorm = 0.7956, lr_0 = 2.0102e-04
Loss = 8.7853e-04, PNorm = 65.9295, GNorm = 0.4574, lr_0 = 1.9792e-04
Loss = 9.5950e-04, PNorm = 65.9495, GNorm = 0.5693, lr_0 = 1.9488e-04
Validation auc = 0.908240
Epoch 22
Loss = 9.5899e-04, PNorm = 65.9682, GNorm = 0.5984, lr_0 = 1.9188e-04
Loss = 7.5921e-04, PNorm = 65.9821, GNorm = 0.9808, lr_0 = 1.8892e-04
Loss = 8.9331e-04, PNorm = 65.9970, GNorm = 0.0974, lr_0 = 1.8601e-04
Loss = 6.3252e-04, PNorm = 66.0142, GNorm = 0.3036, lr_0 = 1.8315e-04
Loss = 1.0023e-03, PNorm = 66.0336, GNorm = 0.7954, lr_0 = 1.8033e-04
Validation auc = 0.908373
Epoch 23
Loss = 5.4445e-04, PNorm = 66.0469, GNorm = 0.4345, lr_0 = 1.7755e-04
Loss = 8.6929e-04, PNorm = 66.0641, GNorm = 0.6999, lr_0 = 1.7482e-04
Loss = 5.8767e-04, PNorm = 66.0849, GNorm = 0.9790, lr_0 = 1.7213e-04
Loss = 5.9344e-04, PNorm = 66.0989, GNorm = 0.2232, lr_0 = 1.6948e-04
Loss = 1.2095e-03, PNorm = 66.1121, GNorm = 0.5201, lr_0 = 1.6687e-04
Loss = 9.0099e-04, PNorm = 66.1304, GNorm = 0.6468, lr_0 = 1.6430e-04
Validation auc = 0.913055
Epoch 24
Loss = 1.1209e-03, PNorm = 66.1421, GNorm = 0.2555, lr_0 = 1.6177e-04
Loss = 7.0448e-04, PNorm = 66.1604, GNorm = 0.0303, lr_0 = 1.5928e-04
Loss = 8.1534e-04, PNorm = 66.1687, GNorm = 1.0113, lr_0 = 1.5683e-04
Loss = 9.2295e-04, PNorm = 66.1772, GNorm = 0.5049, lr_0 = 1.5441e-04
Loss = 4.7186e-04, PNorm = 66.1947, GNorm = 0.1052, lr_0 = 1.5203e-04
Validation auc = 0.911985
Epoch 25
Loss = 5.3178e-04, PNorm = 66.2079, GNorm = 0.5520, lr_0 = 1.4969e-04
Loss = 6.7963e-04, PNorm = 66.2157, GNorm = 0.6057, lr_0 = 1.4739e-04
Loss = 8.7575e-04, PNorm = 66.2242, GNorm = 0.9610, lr_0 = 1.4512e-04
Loss = 5.4391e-04, PNorm = 66.2402, GNorm = 0.3259, lr_0 = 1.4288e-04
Loss = 8.1293e-04, PNorm = 66.2480, GNorm = 0.2974, lr_0 = 1.4069e-04
Validation auc = 0.911450
Epoch 26
Loss = 4.4170e-04, PNorm = 66.2586, GNorm = 0.1643, lr_0 = 1.3852e-04
Loss = 4.6691e-04, PNorm = 66.2716, GNorm = 0.2389, lr_0 = 1.3639e-04
Loss = 6.9187e-04, PNorm = 66.2761, GNorm = 0.6982, lr_0 = 1.3429e-04
Loss = 9.1390e-04, PNorm = 66.2893, GNorm = 0.5765, lr_0 = 1.3222e-04
Loss = 5.4620e-04, PNorm = 66.3039, GNorm = 0.2635, lr_0 = 1.3018e-04
Loss = 6.6159e-04, PNorm = 66.3157, GNorm = 0.1876, lr_0 = 1.2818e-04
Validation auc = 0.908373
Epoch 27
Loss = 9.5024e-04, PNorm = 66.3214, GNorm = 1.0732, lr_0 = 1.2621e-04
Loss = 8.1553e-04, PNorm = 66.3284, GNorm = 0.3698, lr_0 = 1.2426e-04
Loss = 5.2782e-04, PNorm = 66.3414, GNorm = 0.3792, lr_0 = 1.2235e-04
Loss = 6.3715e-04, PNorm = 66.3504, GNorm = 0.6774, lr_0 = 1.2047e-04
Loss = 7.2887e-04, PNorm = 66.3556, GNorm = 0.2999, lr_0 = 1.1861e-04
Validation auc = 0.911049
Epoch 28
Loss = 5.7244e-04, PNorm = 66.3614, GNorm = 0.3747, lr_0 = 1.1678e-04
Loss = 5.6300e-04, PNorm = 66.3691, GNorm = 0.7652, lr_0 = 1.1499e-04
Loss = 8.0759e-04, PNorm = 66.3756, GNorm = 0.1614, lr_0 = 1.1322e-04
Loss = 4.7263e-04, PNorm = 66.3803, GNorm = 0.3074, lr_0 = 1.1147e-04
Loss = 7.4629e-04, PNorm = 66.3868, GNorm = 0.2943, lr_0 = 1.0976e-04
Validation auc = 0.907170
Epoch 29
Loss = 6.5298e-04, PNorm = 66.3967, GNorm = 0.7547, lr_0 = 1.0807e-04
Loss = 4.6507e-04, PNorm = 66.4039, GNorm = 0.6702, lr_0 = 1.0640e-04
Loss = 5.7701e-04, PNorm = 66.4112, GNorm = 0.3843, lr_0 = 1.0476e-04
Loss = 5.8233e-04, PNorm = 66.4233, GNorm = 0.3683, lr_0 = 1.0315e-04
Loss = 5.6091e-04, PNorm = 66.4250, GNorm = 0.6084, lr_0 = 1.0156e-04
Loss = 6.1507e-04, PNorm = 66.4345, GNorm = 0.2998, lr_0 = 1.0000e-04
Validation auc = 0.907303
Model 0 best validation auc = 0.934457 on epoch 17
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test auc = nan
Ensemble test auc = nan
Fold 11
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': '../../../swansonk/chemprop_ckpt/0406_inhibition_hyperopt.json',
 'cuda': True,
 'data_path': '../../broad2/larger_dataset/0405_inhibition_dedup_binary.csv',
 'dataset_type': 'classification',
 'depth': 5,
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_dim': 200,
 'features_generator': None,
 'features_only': False,
 'features_path': ['../../saved_features/0405_broad_inhibition.npz'],
 'features_scaling': False,
 'features_size': 200,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 1600,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'no_cache': False,
 'num_folds': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'output_size': 1,
 'quiet': True,
 'save_dir': '../ckpt/0405_broad_inhibition_20folds/fold_11',
 'save_smiles_splits': False,
 'seed': 11,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'task_names': ['50uM_Inhibition'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 2654,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': ['../../saved_features/0405_broad_inhibition.npz'],
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 11
Class sizes
50uM_Inhibition 0: 91.93%, 1: 8.07%
Total size = 2,949 | train size = 2,654 | val size = 295 | test size = 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1600, bias=False)
      (W_h): Linear(in_features=1600, out_features=1600, bias=False)
      (W_o): Linear(in_features=1733, out_features=1600, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,571,401
Moving model to cuda
Epoch 0
Loss = 7.3464e-03, PNorm = 59.4905, GNorm = 0.6576, lr_0 = 1.8491e-04
Loss = 6.3673e-03, PNorm = 59.5072, GNorm = 0.4977, lr_0 = 2.6981e-04
Loss = 4.9199e-03, PNorm = 59.5290, GNorm = 0.3421, lr_0 = 3.5472e-04
Loss = 6.2820e-03, PNorm = 59.5489, GNorm = 0.8443, lr_0 = 4.3962e-04
Loss = 5.8753e-03, PNorm = 59.5763, GNorm = 0.9895, lr_0 = 5.2453e-04
Validation auc = 0.722579
Epoch 1
Loss = 6.2057e-03, PNorm = 59.6172, GNorm = 0.3771, lr_0 = 6.0943e-04
Loss = 5.5030e-03, PNorm = 59.6695, GNorm = 0.3657, lr_0 = 6.9434e-04
Loss = 5.3818e-03, PNorm = 59.7179, GNorm = 0.6236, lr_0 = 7.7925e-04
Loss = 5.4684e-03, PNorm = 59.7869, GNorm = 2.2954, lr_0 = 8.6415e-04
Loss = 4.2676e-03, PNorm = 59.8669, GNorm = 0.5329, lr_0 = 9.4906e-04
Validation auc = 0.893793
Epoch 2
Loss = 4.2263e-03, PNorm = 59.9597, GNorm = 0.3255, lr_0 = 9.9381e-04
Loss = 4.5106e-03, PNorm = 60.0403, GNorm = 0.3589, lr_0 = 9.7851e-04
Loss = 4.4172e-03, PNorm = 60.1224, GNorm = 0.5360, lr_0 = 9.6345e-04
Loss = 4.8229e-03, PNorm = 60.2081, GNorm = 0.4021, lr_0 = 9.4861e-04
Loss = 5.0859e-03, PNorm = 60.2798, GNorm = 0.4590, lr_0 = 9.3401e-04
Validation auc = 0.908641
Epoch 3
Loss = 1.7180e-03, PNorm = 60.3659, GNorm = 0.5191, lr_0 = 9.1963e-04
Loss = 4.1592e-03, PNorm = 60.4665, GNorm = 1.1938, lr_0 = 9.0547e-04
Loss = 4.1448e-03, PNorm = 60.5335, GNorm = 0.3291, lr_0 = 8.9153e-04
Loss = 4.5801e-03, PNorm = 60.6182, GNorm = 0.4628, lr_0 = 8.7780e-04
Loss = 3.9101e-03, PNorm = 60.6999, GNorm = 0.4182, lr_0 = 8.6429e-04
Loss = 4.3044e-03, PNorm = 60.7760, GNorm = 0.3351, lr_0 = 8.5098e-04
Validation auc = 0.915864
Epoch 4
Loss = 3.4479e-03, PNorm = 60.8668, GNorm = 0.3870, lr_0 = 8.3788e-04
Loss = 4.0070e-03, PNorm = 60.9525, GNorm = 1.0131, lr_0 = 8.2498e-04
Loss = 3.6419e-03, PNorm = 61.0343, GNorm = 0.2533, lr_0 = 8.1228e-04
Loss = 3.6666e-03, PNorm = 61.1247, GNorm = 0.3437, lr_0 = 7.9977e-04
Loss = 3.9259e-03, PNorm = 61.1933, GNorm = 0.6632, lr_0 = 7.8746e-04
Validation auc = 0.931648
Epoch 5
Loss = 3.1678e-03, PNorm = 61.2740, GNorm = 0.3042, lr_0 = 7.7533e-04
Loss = 3.2287e-03, PNorm = 61.3462, GNorm = 1.3558, lr_0 = 7.6340e-04
Loss = 3.4024e-03, PNorm = 61.4449, GNorm = 0.4548, lr_0 = 7.5164e-04
Loss = 3.2564e-03, PNorm = 61.5260, GNorm = 0.6837, lr_0 = 7.4007e-04
Loss = 2.7498e-03, PNorm = 61.6169, GNorm = 0.2839, lr_0 = 7.2867e-04
Validation auc = 0.946495
Epoch 6
Loss = 2.7945e-03, PNorm = 61.7005, GNorm = 0.4046, lr_0 = 7.1746e-04
Loss = 3.8240e-03, PNorm = 61.7764, GNorm = 0.7038, lr_0 = 7.0641e-04
Loss = 2.4038e-03, PNorm = 61.8760, GNorm = 1.0699, lr_0 = 6.9553e-04
Loss = 2.7102e-03, PNorm = 61.9516, GNorm = 0.3691, lr_0 = 6.8482e-04
Loss = 3.4008e-03, PNorm = 62.0315, GNorm = 0.8193, lr_0 = 6.7428e-04
Loss = 3.0016e-03, PNorm = 62.1080, GNorm = 0.4530, lr_0 = 6.6390e-04
Validation auc = 0.956260
Epoch 7
Loss = 2.8809e-03, PNorm = 62.1971, GNorm = 0.3176, lr_0 = 6.5368e-04
Loss = 3.0244e-03, PNorm = 62.2839, GNorm = 0.6453, lr_0 = 6.4361e-04
Loss = 2.8729e-03, PNorm = 62.3482, GNorm = 0.3074, lr_0 = 6.3370e-04
Loss = 2.7352e-03, PNorm = 62.4185, GNorm = 0.6315, lr_0 = 6.2395e-04
Loss = 2.9180e-03, PNorm = 62.4937, GNorm = 0.5246, lr_0 = 6.1434e-04
Validation auc = 0.959604
Epoch 8
Loss = 2.6131e-03, PNorm = 62.5789, GNorm = 0.3034, lr_0 = 6.0488e-04
Loss = 2.4975e-03, PNorm = 62.6485, GNorm = 0.3311, lr_0 = 5.9557e-04
Loss = 2.9418e-03, PNorm = 62.7096, GNorm = 0.2807, lr_0 = 5.8640e-04
Loss = 2.1850e-03, PNorm = 62.7802, GNorm = 0.5654, lr_0 = 5.7737e-04
Loss = 2.6538e-03, PNorm = 62.8564, GNorm = 1.1792, lr_0 = 5.6848e-04
Validation auc = 0.969235
Epoch 9
Loss = 1.6949e-03, PNorm = 62.9263, GNorm = 0.4811, lr_0 = 5.5973e-04
Loss = 2.2325e-03, PNorm = 62.9924, GNorm = 0.2715, lr_0 = 5.5111e-04
Loss = 2.2574e-03, PNorm = 63.0616, GNorm = 0.3842, lr_0 = 5.4263e-04
Loss = 2.0269e-03, PNorm = 63.1371, GNorm = 0.2830, lr_0 = 5.3427e-04
Loss = 2.7142e-03, PNorm = 63.1942, GNorm = 0.4906, lr_0 = 5.2605e-04
Loss = 2.7034e-03, PNorm = 63.2645, GNorm = 0.5645, lr_0 = 5.1795e-04
Validation auc = 0.965490
Epoch 10
Loss = 2.1868e-03, PNorm = 63.3319, GNorm = 0.3293, lr_0 = 5.0997e-04
Loss = 2.6101e-03, PNorm = 63.3992, GNorm = 0.4167, lr_0 = 5.0212e-04
Loss = 2.2347e-03, PNorm = 63.4451, GNorm = 0.7904, lr_0 = 4.9439e-04
Loss = 2.3354e-03, PNorm = 63.5105, GNorm = 0.3919, lr_0 = 4.8678e-04
Loss = 2.0976e-03, PNorm = 63.5715, GNorm = 0.6458, lr_0 = 4.7928e-04
Validation auc = 0.969904
Epoch 11
Loss = 2.7524e-03, PNorm = 63.6378, GNorm = 0.4035, lr_0 = 4.7190e-04
Loss = 1.9665e-03, PNorm = 63.7157, GNorm = 0.2777, lr_0 = 4.6464e-04
Loss = 1.9778e-03, PNorm = 63.7660, GNorm = 0.6962, lr_0 = 4.5749e-04
Loss = 2.5292e-03, PNorm = 63.8177, GNorm = 0.3344, lr_0 = 4.5044e-04
Loss = 1.8862e-03, PNorm = 63.8743, GNorm = 0.2385, lr_0 = 4.4351e-04
Validation auc = 0.968566
Epoch 12
Loss = 2.3112e-03, PNorm = 63.9289, GNorm = 1.1381, lr_0 = 4.3668e-04
Loss = 2.1359e-03, PNorm = 63.9651, GNorm = 0.3008, lr_0 = 4.2996e-04
Loss = 1.8932e-03, PNorm = 64.0205, GNorm = 0.5043, lr_0 = 4.2334e-04
Loss = 2.1684e-03, PNorm = 64.0672, GNorm = 0.6577, lr_0 = 4.1682e-04
Loss = 1.8152e-03, PNorm = 64.1217, GNorm = 0.5842, lr_0 = 4.1040e-04
Validation auc = 0.969235
Epoch 13
Loss = 7.6048e-04, PNorm = 64.1629, GNorm = 0.2187, lr_0 = 4.0408e-04
Loss = 2.1104e-03, PNorm = 64.2109, GNorm = 0.7122, lr_0 = 3.9786e-04
Loss = 1.6939e-03, PNorm = 64.2644, GNorm = 0.4181, lr_0 = 3.9173e-04
Loss = 1.8756e-03, PNorm = 64.3045, GNorm = 0.4200, lr_0 = 3.8570e-04
Loss = 2.2096e-03, PNorm = 64.3552, GNorm = 0.5253, lr_0 = 3.7976e-04
Loss = 1.5274e-03, PNorm = 64.4190, GNorm = 0.6796, lr_0 = 3.7392e-04
Validation auc = 0.974184
Epoch 14
Loss = 2.3648e-03, PNorm = 64.4607, GNorm = 0.4390, lr_0 = 3.6816e-04
Loss = 1.9227e-03, PNorm = 64.5096, GNorm = 0.4102, lr_0 = 3.6249e-04
Loss = 1.4373e-03, PNorm = 64.5466, GNorm = 0.3677, lr_0 = 3.5691e-04
Loss = 1.2088e-03, PNorm = 64.5958, GNorm = 0.6937, lr_0 = 3.5142e-04
Loss = 1.7635e-03, PNorm = 64.6327, GNorm = 0.4795, lr_0 = 3.4601e-04
Validation auc = 0.965757
Epoch 15
Loss = 1.3566e-03, PNorm = 64.6788, GNorm = 0.6895, lr_0 = 3.4068e-04
Loss = 1.6776e-03, PNorm = 64.7272, GNorm = 0.3290, lr_0 = 3.3543e-04
Loss = 2.0925e-03, PNorm = 64.7670, GNorm = 0.7969, lr_0 = 3.3027e-04
Loss = 1.4153e-03, PNorm = 64.8062, GNorm = 0.3196, lr_0 = 3.2518e-04
Loss = 1.4452e-03, PNorm = 64.8455, GNorm = 0.3214, lr_0 = 3.2018e-04
Validation auc = 0.971241
Epoch 16
Loss = 9.0105e-04, PNorm = 64.8751, GNorm = 0.4212, lr_0 = 3.1525e-04
Loss = 1.8190e-03, PNorm = 64.9142, GNorm = 0.2127, lr_0 = 3.1039e-04
Loss = 1.1854e-03, PNorm = 64.9467, GNorm = 0.5030, lr_0 = 3.0562e-04
Loss = 1.6217e-03, PNorm = 64.9867, GNorm = 0.7262, lr_0 = 3.0091e-04
Loss = 1.5888e-03, PNorm = 65.0200, GNorm = 0.6165, lr_0 = 2.9628e-04
Loss = 1.6002e-03, PNorm = 65.0589, GNorm = 0.5102, lr_0 = 2.9172e-04
Validation auc = 0.970037
Epoch 17
Loss = 1.4432e-03, PNorm = 65.0884, GNorm = 0.6248, lr_0 = 2.8722e-04
Loss = 1.0152e-03, PNorm = 65.1324, GNorm = 0.7179, lr_0 = 2.8280e-04
Loss = 1.1323e-03, PNorm = 65.1694, GNorm = 0.4791, lr_0 = 2.7845e-04
Loss = 1.7582e-03, PNorm = 65.2071, GNorm = 0.2801, lr_0 = 2.7416e-04
Loss = 1.7586e-03, PNorm = 65.2353, GNorm = 0.7933, lr_0 = 2.6994e-04
Validation auc = 0.966426
Epoch 18
Loss = 1.3403e-03, PNorm = 65.2703, GNorm = 0.5680, lr_0 = 2.6578e-04
Loss = 1.2524e-03, PNorm = 65.3002, GNorm = 0.3863, lr_0 = 2.6169e-04
Loss = 1.1371e-03, PNorm = 65.3343, GNorm = 0.1467, lr_0 = 2.5766e-04
Loss = 1.5403e-03, PNorm = 65.3607, GNorm = 0.6105, lr_0 = 2.5370e-04
Loss = 1.5321e-03, PNorm = 65.3982, GNorm = 0.8166, lr_0 = 2.4979e-04
Validation auc = 0.976592
Epoch 19
Loss = 7.2206e-04, PNorm = 65.4220, GNorm = 0.3210, lr_0 = 2.4594e-04
Loss = 1.4529e-03, PNorm = 65.4539, GNorm = 1.0491, lr_0 = 2.4216e-04
Loss = 8.8624e-04, PNorm = 65.4786, GNorm = 0.5296, lr_0 = 2.3843e-04
Loss = 1.5198e-03, PNorm = 65.5047, GNorm = 0.2864, lr_0 = 2.3476e-04
Loss = 1.3517e-03, PNorm = 65.5326, GNorm = 0.5071, lr_0 = 2.3114e-04
Loss = 1.1055e-03, PNorm = 65.5612, GNorm = 0.8574, lr_0 = 2.2758e-04
Validation auc = 0.969904
Epoch 20
Loss = 8.4187e-04, PNorm = 65.5773, GNorm = 0.2460, lr_0 = 2.2408e-04
Loss = 1.3734e-03, PNorm = 65.6043, GNorm = 1.1217, lr_0 = 2.2063e-04
Loss = 1.1829e-03, PNorm = 65.6298, GNorm = 0.1221, lr_0 = 2.1723e-04
Loss = 1.2800e-03, PNorm = 65.6518, GNorm = 0.6922, lr_0 = 2.1389e-04
Loss = 1.2479e-03, PNorm = 65.6664, GNorm = 0.2935, lr_0 = 2.1060e-04
Validation auc = 0.962681
Epoch 21
Loss = 7.9533e-04, PNorm = 65.6897, GNorm = 0.8742, lr_0 = 2.0735e-04
Loss = 1.2641e-03, PNorm = 65.7098, GNorm = 0.3183, lr_0 = 2.0416e-04
Loss = 9.9646e-04, PNorm = 65.7349, GNorm = 0.5251, lr_0 = 2.0102e-04
Loss = 9.5324e-04, PNorm = 65.7498, GNorm = 0.1458, lr_0 = 1.9792e-04
Loss = 1.6719e-03, PNorm = 65.7754, GNorm = 0.7406, lr_0 = 1.9488e-04
Validation auc = 0.963617
Epoch 22
Loss = 8.5372e-04, PNorm = 65.7886, GNorm = 0.3115, lr_0 = 1.9188e-04
Loss = 6.6887e-04, PNorm = 65.8067, GNorm = 0.4007, lr_0 = 1.8892e-04
Loss = 7.8128e-04, PNorm = 65.8237, GNorm = 1.0852, lr_0 = 1.8601e-04
Loss = 1.1634e-03, PNorm = 65.8352, GNorm = 1.0321, lr_0 = 1.8315e-04
Loss = 1.1746e-03, PNorm = 65.8603, GNorm = 1.1219, lr_0 = 1.8033e-04
Validation auc = 0.966426
Epoch 23
Loss = 1.2428e-03, PNorm = 65.8757, GNorm = 0.9919, lr_0 = 1.7755e-04
Loss = 7.7809e-04, PNorm = 65.8934, GNorm = 0.7997, lr_0 = 1.7482e-04
Loss = 9.5267e-04, PNorm = 65.9110, GNorm = 0.4882, lr_0 = 1.7213e-04
Loss = 1.3440e-03, PNorm = 65.9302, GNorm = 0.1731, lr_0 = 1.6948e-04
Loss = 7.2260e-04, PNorm = 65.9501, GNorm = 0.5681, lr_0 = 1.6687e-04
Loss = 8.2118e-04, PNorm = 65.9634, GNorm = 0.3255, lr_0 = 1.6430e-04
Validation auc = 0.958801
Epoch 24
Loss = 5.3333e-04, PNorm = 65.9743, GNorm = 0.0734, lr_0 = 1.6177e-04
Loss = 1.0017e-03, PNorm = 65.9847, GNorm = 0.6364, lr_0 = 1.5928e-04
Loss = 7.9820e-04, PNorm = 66.0057, GNorm = 0.4120, lr_0 = 1.5683e-04
Loss = 1.0648e-03, PNorm = 66.0189, GNorm = 0.1771, lr_0 = 1.5441e-04
Loss = 7.1652e-04, PNorm = 66.0312, GNorm = 0.4371, lr_0 = 1.5203e-04
Validation auc = 0.963751
Epoch 25
Loss = 7.5150e-04, PNorm = 66.0479, GNorm = 0.8789, lr_0 = 1.4969e-04
Loss = 7.2855e-04, PNorm = 66.0568, GNorm = 0.5853, lr_0 = 1.4739e-04
Loss = 8.1542e-04, PNorm = 66.0660, GNorm = 0.4605, lr_0 = 1.4512e-04
Loss = 6.8589e-04, PNorm = 66.0770, GNorm = 0.4798, lr_0 = 1.4288e-04
Loss = 8.5255e-04, PNorm = 66.0869, GNorm = 1.2337, lr_0 = 1.4069e-04
Validation auc = 0.958801
Epoch 26
Loss = 2.3540e-04, PNorm = 66.1017, GNorm = 0.4000, lr_0 = 1.3852e-04
Loss = 5.6984e-04, PNorm = 66.1141, GNorm = 0.1423, lr_0 = 1.3639e-04
Loss = 9.2465e-04, PNorm = 66.1285, GNorm = 0.1186, lr_0 = 1.3429e-04
Loss = 8.9262e-04, PNorm = 66.1386, GNorm = 0.3971, lr_0 = 1.3222e-04
Loss = 7.4623e-04, PNorm = 66.1517, GNorm = 0.3981, lr_0 = 1.3018e-04
Loss = 6.0593e-04, PNorm = 66.1639, GNorm = 0.0978, lr_0 = 1.2818e-04
Validation auc = 0.956929
Epoch 27
Loss = 7.0948e-04, PNorm = 66.1715, GNorm = 1.1874, lr_0 = 1.2621e-04
Loss = 6.1673e-04, PNorm = 66.1881, GNorm = 0.1842, lr_0 = 1.2426e-04
Loss = 7.3007e-04, PNorm = 66.1969, GNorm = 0.0926, lr_0 = 1.2235e-04
Loss = 1.2084e-03, PNorm = 66.2034, GNorm = 0.0439, lr_0 = 1.2047e-04
Loss = 5.4190e-04, PNorm = 66.2107, GNorm = 0.5144, lr_0 = 1.1861e-04
Validation auc = 0.971776
Epoch 28
Loss = 6.2777e-04, PNorm = 66.2210, GNorm = 0.2662, lr_0 = 1.1678e-04
Loss = 6.1902e-04, PNorm = 66.2306, GNorm = 1.1313, lr_0 = 1.1499e-04
Loss = 9.7029e-04, PNorm = 66.2389, GNorm = 0.9577, lr_0 = 1.1322e-04
Loss = 7.5095e-04, PNorm = 66.2485, GNorm = 0.1399, lr_0 = 1.1147e-04
Loss = 6.3710e-04, PNorm = 66.2562, GNorm = 0.3243, lr_0 = 1.0976e-04
Validation auc = 0.972311
Epoch 29
Loss = 4.9767e-04, PNorm = 66.2599, GNorm = 0.1243, lr_0 = 1.0807e-04
Loss = 6.6608e-04, PNorm = 66.2706, GNorm = 0.1168, lr_0 = 1.0640e-04
Loss = 5.5016e-04, PNorm = 66.2789, GNorm = 0.4416, lr_0 = 1.0476e-04
Loss = 6.0321e-04, PNorm = 66.2804, GNorm = 0.1358, lr_0 = 1.0315e-04
Loss = 8.0461e-04, PNorm = 66.2907, GNorm = 0.1456, lr_0 = 1.0156e-04
Loss = 7.2771e-04, PNorm = 66.2982, GNorm = 0.4847, lr_0 = 1.0000e-04
Validation auc = 0.968031
Model 0 best validation auc = 0.976592 on epoch 18
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test auc = nan
Ensemble test auc = nan
Fold 12
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': '../../../swansonk/chemprop_ckpt/0406_inhibition_hyperopt.json',
 'cuda': True,
 'data_path': '../../broad2/larger_dataset/0405_inhibition_dedup_binary.csv',
 'dataset_type': 'classification',
 'depth': 5,
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_dim': 200,
 'features_generator': None,
 'features_only': False,
 'features_path': ['../../saved_features/0405_broad_inhibition.npz'],
 'features_scaling': False,
 'features_size': 200,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 1600,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'no_cache': False,
 'num_folds': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'output_size': 1,
 'quiet': True,
 'save_dir': '../ckpt/0405_broad_inhibition_20folds/fold_12',
 'save_smiles_splits': False,
 'seed': 12,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'task_names': ['50uM_Inhibition'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 2654,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': ['../../saved_features/0405_broad_inhibition.npz'],
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 12
Class sizes
50uM_Inhibition 0: 91.93%, 1: 8.07%
Total size = 2,949 | train size = 2,654 | val size = 295 | test size = 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1600, bias=False)
      (W_h): Linear(in_features=1600, out_features=1600, bias=False)
      (W_o): Linear(in_features=1733, out_features=1600, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,571,401
Moving model to cuda
Epoch 0
Loss = 9.0208e-03, PNorm = 59.4498, GNorm = 0.7987, lr_0 = 1.8491e-04
Loss = 6.6960e-03, PNorm = 59.4671, GNorm = 0.8876, lr_0 = 2.6981e-04
Loss = 4.6086e-03, PNorm = 59.4871, GNorm = 0.3296, lr_0 = 3.5472e-04
Loss = 6.2185e-03, PNorm = 59.5069, GNorm = 0.5121, lr_0 = 4.3962e-04
Loss = 4.3133e-03, PNorm = 59.5332, GNorm = 0.4130, lr_0 = 5.2453e-04
Validation auc = 0.740569
Epoch 1
Loss = 5.3341e-03, PNorm = 59.5706, GNorm = 0.4513, lr_0 = 6.0943e-04
Loss = 6.1229e-03, PNorm = 59.6128, GNorm = 0.4723, lr_0 = 6.9434e-04
Loss = 5.5528e-03, PNorm = 59.6744, GNorm = 0.6857, lr_0 = 7.7925e-04
Loss = 4.4152e-03, PNorm = 59.7514, GNorm = 2.0704, lr_0 = 8.6415e-04
Loss = 4.2439e-03, PNorm = 59.8305, GNorm = 0.6473, lr_0 = 9.4906e-04
Validation auc = 0.800192
Epoch 2
Loss = 5.3502e-03, PNorm = 59.9091, GNorm = 0.8702, lr_0 = 9.9381e-04
Loss = 3.9724e-03, PNorm = 59.9853, GNorm = 1.9959, lr_0 = 9.7851e-04
Loss = 4.5471e-03, PNorm = 60.0616, GNorm = 0.3293, lr_0 = 9.6345e-04
Loss = 4.0408e-03, PNorm = 60.1548, GNorm = 0.4735, lr_0 = 9.4861e-04
Loss = 5.2028e-03, PNorm = 60.2339, GNorm = 0.5714, lr_0 = 9.3401e-04
Validation auc = 0.821611
Epoch 3
Loss = 5.1506e-03, PNorm = 60.3367, GNorm = 0.6790, lr_0 = 9.1963e-04
Loss = 3.7575e-03, PNorm = 60.4427, GNorm = 0.5622, lr_0 = 9.0547e-04
Loss = 3.0500e-03, PNorm = 60.5292, GNorm = 0.1699, lr_0 = 8.9153e-04
Loss = 5.1099e-03, PNorm = 60.5967, GNorm = 0.7818, lr_0 = 8.7780e-04
Loss = 4.2204e-03, PNorm = 60.6865, GNorm = 0.2700, lr_0 = 8.6429e-04
Loss = 3.9069e-03, PNorm = 60.7505, GNorm = 0.3798, lr_0 = 8.5098e-04
Validation auc = 0.845269
Epoch 4
Loss = 3.8200e-03, PNorm = 60.8035, GNorm = 0.7826, lr_0 = 8.3788e-04
Loss = 3.7384e-03, PNorm = 60.8652, GNorm = 0.5024, lr_0 = 8.2498e-04
Loss = 4.2228e-03, PNorm = 60.9413, GNorm = 0.7142, lr_0 = 8.1228e-04
Loss = 3.3680e-03, PNorm = 61.0131, GNorm = 0.7432, lr_0 = 7.9977e-04
Loss = 3.9776e-03, PNorm = 61.0889, GNorm = 0.8944, lr_0 = 7.8746e-04
Validation auc = 0.861893
Epoch 5
Loss = 2.4939e-03, PNorm = 61.1716, GNorm = 0.2359, lr_0 = 7.7533e-04
Loss = 3.3666e-03, PNorm = 61.2452, GNorm = 0.8618, lr_0 = 7.6340e-04
Loss = 2.9036e-03, PNorm = 61.3281, GNorm = 0.4980, lr_0 = 7.5164e-04
Loss = 4.0335e-03, PNorm = 61.4223, GNorm = 0.4218, lr_0 = 7.4007e-04
Loss = 3.3064e-03, PNorm = 61.5213, GNorm = 0.9695, lr_0 = 7.2867e-04
Validation auc = 0.876598
Epoch 6
Loss = 2.1399e-03, PNorm = 61.6179, GNorm = 0.3121, lr_0 = 7.1746e-04
Loss = 3.6460e-03, PNorm = 61.6957, GNorm = 1.4900, lr_0 = 7.0641e-04
Loss = 2.4645e-03, PNorm = 61.7979, GNorm = 0.4638, lr_0 = 6.9553e-04
Loss = 4.0733e-03, PNorm = 61.8767, GNorm = 0.6491, lr_0 = 6.8482e-04
Loss = 3.7639e-03, PNorm = 61.9776, GNorm = 1.1595, lr_0 = 6.7428e-04
Loss = 2.9590e-03, PNorm = 62.0689, GNorm = 0.3880, lr_0 = 6.6390e-04
Validation auc = 0.915601
Epoch 7
Loss = 2.2236e-03, PNorm = 62.1508, GNorm = 0.3573, lr_0 = 6.5368e-04
Loss = 2.7669e-03, PNorm = 62.2557, GNorm = 0.3988, lr_0 = 6.4361e-04
Loss = 4.1342e-03, PNorm = 62.3503, GNorm = 0.8563, lr_0 = 6.3370e-04
Loss = 2.5006e-03, PNorm = 62.4583, GNorm = 0.2240, lr_0 = 6.2395e-04
Loss = 3.1111e-03, PNorm = 62.5447, GNorm = 0.7104, lr_0 = 6.1434e-04
Validation auc = 0.913523
Epoch 8
Loss = 2.6536e-03, PNorm = 62.6222, GNorm = 0.3587, lr_0 = 6.0488e-04
Loss = 2.8740e-03, PNorm = 62.6918, GNorm = 0.5605, lr_0 = 5.9557e-04
Loss = 2.4926e-03, PNorm = 62.7517, GNorm = 0.2656, lr_0 = 5.8640e-04
Loss = 2.1027e-03, PNorm = 62.8143, GNorm = 0.3937, lr_0 = 5.7737e-04
Loss = 2.5700e-03, PNorm = 62.8801, GNorm = 0.4049, lr_0 = 5.6848e-04
Validation auc = 0.922315
Epoch 9
Loss = 2.9601e-03, PNorm = 62.9637, GNorm = 0.4722, lr_0 = 5.5973e-04
Loss = 2.6940e-03, PNorm = 63.0367, GNorm = 0.2634, lr_0 = 5.5111e-04
Loss = 2.3988e-03, PNorm = 63.1123, GNorm = 1.0108, lr_0 = 5.4263e-04
Loss = 2.6473e-03, PNorm = 63.1840, GNorm = 0.4762, lr_0 = 5.3427e-04
Loss = 2.2672e-03, PNorm = 63.2624, GNorm = 0.2958, lr_0 = 5.2605e-04
Loss = 1.6613e-03, PNorm = 63.3313, GNorm = 0.7664, lr_0 = 5.1795e-04
Validation auc = 0.939258
Epoch 10
Loss = 2.2636e-03, PNorm = 63.3932, GNorm = 0.5314, lr_0 = 5.0997e-04
Loss = 1.9616e-03, PNorm = 63.4426, GNorm = 0.3227, lr_0 = 5.0212e-04
Loss = 2.0644e-03, PNorm = 63.4962, GNorm = 0.5541, lr_0 = 4.9439e-04
Loss = 2.6632e-03, PNorm = 63.5431, GNorm = 0.8311, lr_0 = 4.8678e-04
Loss = 1.8381e-03, PNorm = 63.6030, GNorm = 0.6974, lr_0 = 4.7928e-04
Validation auc = 0.931905
Epoch 11
Loss = 1.9522e-03, PNorm = 63.6512, GNorm = 0.2804, lr_0 = 4.7190e-04
Loss = 2.5560e-03, PNorm = 63.7131, GNorm = 0.2399, lr_0 = 4.6464e-04
Loss = 1.6514e-03, PNorm = 63.7597, GNorm = 0.6239, lr_0 = 4.5749e-04
Loss = 1.8794e-03, PNorm = 63.8138, GNorm = 1.5225, lr_0 = 4.5044e-04
Loss = 1.9869e-03, PNorm = 63.8521, GNorm = 0.5269, lr_0 = 4.4351e-04
Validation auc = 0.942136
Epoch 12
Loss = 1.5593e-03, PNorm = 63.8987, GNorm = 0.4524, lr_0 = 4.3668e-04
Loss = 1.7408e-03, PNorm = 63.9516, GNorm = 0.4131, lr_0 = 4.2996e-04
Loss = 2.0769e-03, PNorm = 64.0093, GNorm = 0.6546, lr_0 = 4.2334e-04
Loss = 2.0156e-03, PNorm = 64.0607, GNorm = 0.6316, lr_0 = 4.1682e-04
Loss = 1.9003e-03, PNorm = 64.1104, GNorm = 0.5293, lr_0 = 4.1040e-04
Validation auc = 0.927270
Epoch 13
Loss = 2.0260e-03, PNorm = 64.1617, GNorm = 0.3177, lr_0 = 4.0408e-04
Loss = 1.5555e-03, PNorm = 64.2186, GNorm = 0.2671, lr_0 = 3.9786e-04
Loss = 1.5361e-03, PNorm = 64.2720, GNorm = 0.4064, lr_0 = 3.9173e-04
Loss = 2.9637e-03, PNorm = 64.3236, GNorm = 0.6779, lr_0 = 3.8570e-04
Loss = 1.8314e-03, PNorm = 64.3865, GNorm = 0.6183, lr_0 = 3.7976e-04
Loss = 1.3320e-03, PNorm = 64.4428, GNorm = 0.4416, lr_0 = 3.7392e-04
Validation auc = 0.940377
Epoch 14
Loss = 1.4612e-03, PNorm = 64.4833, GNorm = 0.5644, lr_0 = 3.6816e-04
Loss = 1.3970e-03, PNorm = 64.5260, GNorm = 0.5778, lr_0 = 3.6249e-04
Loss = 1.2566e-03, PNorm = 64.5703, GNorm = 0.2089, lr_0 = 3.5691e-04
Loss = 1.8534e-03, PNorm = 64.6040, GNorm = 0.5826, lr_0 = 3.5142e-04
Loss = 1.5337e-03, PNorm = 64.6480, GNorm = 0.7882, lr_0 = 3.4601e-04
Validation auc = 0.933184
Epoch 15
Loss = 1.2912e-03, PNorm = 64.6964, GNorm = 0.5060, lr_0 = 3.4068e-04
Loss = 1.4350e-03, PNorm = 64.7497, GNorm = 0.8001, lr_0 = 3.3543e-04
Loss = 1.2290e-03, PNorm = 64.7906, GNorm = 0.3915, lr_0 = 3.3027e-04
Loss = 1.2818e-03, PNorm = 64.8252, GNorm = 0.4806, lr_0 = 3.2518e-04
Loss = 1.6793e-03, PNorm = 64.8653, GNorm = 1.2533, lr_0 = 3.2018e-04
Validation auc = 0.953165
Epoch 16
Loss = 1.9150e-03, PNorm = 64.9036, GNorm = 0.6464, lr_0 = 3.1525e-04
Loss = 1.2256e-03, PNorm = 64.9455, GNorm = 0.6491, lr_0 = 3.1039e-04
Loss = 1.3337e-03, PNorm = 64.9864, GNorm = 0.2000, lr_0 = 3.0562e-04
Loss = 1.3912e-03, PNorm = 65.0205, GNorm = 0.5732, lr_0 = 3.0091e-04
Loss = 1.5740e-03, PNorm = 65.0528, GNorm = 0.3080, lr_0 = 2.9628e-04
Loss = 1.5431e-03, PNorm = 65.0896, GNorm = 0.3781, lr_0 = 2.9172e-04
Validation auc = 0.938299
Epoch 17
Loss = 1.5652e-03, PNorm = 65.1251, GNorm = 0.5204, lr_0 = 2.8722e-04
Loss = 1.2977e-03, PNorm = 65.1624, GNorm = 0.8967, lr_0 = 2.8280e-04
Loss = 1.2787e-03, PNorm = 65.1921, GNorm = 0.1729, lr_0 = 2.7845e-04
Loss = 9.5477e-04, PNorm = 65.2278, GNorm = 0.5433, lr_0 = 2.7416e-04
Loss = 2.0072e-03, PNorm = 65.2462, GNorm = 0.4431, lr_0 = 2.6994e-04
Validation auc = 0.943734
Epoch 18
Loss = 1.0664e-03, PNorm = 65.2872, GNorm = 0.3383, lr_0 = 2.6578e-04
Loss = 1.4498e-03, PNorm = 65.3203, GNorm = 0.2391, lr_0 = 2.6169e-04
Loss = 1.2930e-03, PNorm = 65.3528, GNorm = 0.2873, lr_0 = 2.5766e-04
Loss = 1.3421e-03, PNorm = 65.3806, GNorm = 0.3176, lr_0 = 2.5370e-04
Loss = 1.1784e-03, PNorm = 65.4112, GNorm = 0.2231, lr_0 = 2.4979e-04
Validation auc = 0.939258
Epoch 19
Loss = 1.4979e-03, PNorm = 65.4478, GNorm = 0.9781, lr_0 = 2.4594e-04
Loss = 1.0642e-03, PNorm = 65.4700, GNorm = 0.2263, lr_0 = 2.4216e-04
Loss = 1.0856e-03, PNorm = 65.5007, GNorm = 0.4665, lr_0 = 2.3843e-04
Loss = 9.8328e-04, PNorm = 65.5222, GNorm = 0.4108, lr_0 = 2.3476e-04
Loss = 1.5978e-03, PNorm = 65.5433, GNorm = 0.4172, lr_0 = 2.3114e-04
Loss = 1.3195e-03, PNorm = 65.5647, GNorm = 0.6881, lr_0 = 2.2758e-04
Validation auc = 0.933184
Epoch 20
Loss = 7.9962e-04, PNorm = 65.5961, GNorm = 0.6409, lr_0 = 2.2408e-04
Loss = 1.2401e-03, PNorm = 65.6218, GNorm = 0.9923, lr_0 = 2.2063e-04
Loss = 1.1377e-03, PNorm = 65.6428, GNorm = 0.3606, lr_0 = 2.1723e-04
Loss = 7.1863e-04, PNorm = 65.6634, GNorm = 0.6508, lr_0 = 2.1389e-04
Loss = 1.0576e-03, PNorm = 65.6878, GNorm = 0.2210, lr_0 = 2.1060e-04
Validation auc = 0.925512
Epoch 21
Loss = 7.6924e-04, PNorm = 65.7015, GNorm = 0.3651, lr_0 = 2.0735e-04
Loss = 7.9427e-04, PNorm = 65.7266, GNorm = 0.7566, lr_0 = 2.0416e-04
Loss = 7.9143e-04, PNorm = 65.7475, GNorm = 0.1632, lr_0 = 2.0102e-04
Loss = 7.5309e-04, PNorm = 65.7678, GNorm = 0.4556, lr_0 = 1.9792e-04
Loss = 1.3038e-03, PNorm = 65.7850, GNorm = 0.8051, lr_0 = 1.9488e-04
Validation auc = 0.930627
Epoch 22
Loss = 6.7254e-04, PNorm = 65.8036, GNorm = 0.5713, lr_0 = 1.9188e-04
Loss = 7.5187e-04, PNorm = 65.8315, GNorm = 0.7652, lr_0 = 1.8892e-04
Loss = 1.2860e-03, PNorm = 65.8482, GNorm = 0.4522, lr_0 = 1.8601e-04
Loss = 8.8092e-04, PNorm = 65.8685, GNorm = 0.4991, lr_0 = 1.8315e-04
Loss = 8.9554e-04, PNorm = 65.8897, GNorm = 0.1018, lr_0 = 1.8033e-04
Validation auc = 0.936701
Epoch 23
Loss = 5.5758e-04, PNorm = 65.9028, GNorm = 0.3743, lr_0 = 1.7755e-04
Loss = 1.0528e-03, PNorm = 65.9223, GNorm = 0.5058, lr_0 = 1.7482e-04
Loss = 8.6625e-04, PNorm = 65.9381, GNorm = 0.4915, lr_0 = 1.7213e-04
Loss = 1.0166e-03, PNorm = 65.9551, GNorm = 0.1656, lr_0 = 1.6948e-04
Loss = 1.0940e-03, PNorm = 65.9752, GNorm = 1.1064, lr_0 = 1.6687e-04
Loss = 9.8213e-04, PNorm = 65.9869, GNorm = 0.3675, lr_0 = 1.6430e-04
Validation auc = 0.925671
Epoch 24
Loss = 4.7000e-04, PNorm = 66.0000, GNorm = 0.0797, lr_0 = 1.6177e-04
Loss = 1.2831e-03, PNorm = 66.0153, GNorm = 0.3326, lr_0 = 1.5928e-04
Loss = 5.9870e-04, PNorm = 66.0283, GNorm = 0.2840, lr_0 = 1.5683e-04
Loss = 7.8796e-04, PNorm = 66.0451, GNorm = 0.5435, lr_0 = 1.5441e-04
Loss = 8.2143e-04, PNorm = 66.0556, GNorm = 0.4284, lr_0 = 1.5203e-04
Validation auc = 0.928708
Epoch 25
Loss = 8.1678e-04, PNorm = 66.0724, GNorm = 0.6343, lr_0 = 1.4969e-04
Loss = 6.5672e-04, PNorm = 66.0831, GNorm = 0.3021, lr_0 = 1.4739e-04
Loss = 6.2941e-04, PNorm = 66.0942, GNorm = 0.4047, lr_0 = 1.4512e-04
Loss = 9.5718e-04, PNorm = 66.1070, GNorm = 0.5901, lr_0 = 1.4288e-04
Loss = 6.9192e-04, PNorm = 66.1220, GNorm = 0.5401, lr_0 = 1.4069e-04
Validation auc = 0.916880
Epoch 26
Loss = 4.5585e-04, PNorm = 66.1383, GNorm = 0.6092, lr_0 = 1.3852e-04
Loss = 7.6694e-04, PNorm = 66.1438, GNorm = 0.4324, lr_0 = 1.3639e-04
Loss = 1.3405e-03, PNorm = 66.1605, GNorm = 0.4117, lr_0 = 1.3429e-04
Loss = 5.9263e-04, PNorm = 66.1715, GNorm = 0.1490, lr_0 = 1.3222e-04
Loss = 5.0920e-04, PNorm = 66.1822, GNorm = 0.5082, lr_0 = 1.3018e-04
Loss = 7.9730e-04, PNorm = 66.1924, GNorm = 0.1025, lr_0 = 1.2818e-04
Validation auc = 0.929668
Epoch 27
Loss = 9.8753e-04, PNorm = 66.2014, GNorm = 0.8134, lr_0 = 1.2621e-04
Loss = 6.9309e-04, PNorm = 66.2127, GNorm = 0.2778, lr_0 = 1.2426e-04
Loss = 5.8194e-04, PNorm = 66.2209, GNorm = 0.7569, lr_0 = 1.2235e-04
Loss = 6.5324e-04, PNorm = 66.2248, GNorm = 0.1929, lr_0 = 1.2047e-04
Loss = 6.9244e-04, PNorm = 66.2396, GNorm = 0.7910, lr_0 = 1.1861e-04
Validation auc = 0.925671
Epoch 28
Loss = 4.4161e-04, PNorm = 66.2521, GNorm = 0.7703, lr_0 = 1.1678e-04
Loss = 8.1966e-04, PNorm = 66.2617, GNorm = 0.8452, lr_0 = 1.1499e-04
Loss = 6.7423e-04, PNorm = 66.2678, GNorm = 0.4466, lr_0 = 1.1322e-04
Loss = 8.8942e-04, PNorm = 66.2773, GNorm = 0.3336, lr_0 = 1.1147e-04
Loss = 4.9465e-04, PNorm = 66.2872, GNorm = 0.2603, lr_0 = 1.0976e-04
Validation auc = 0.925991
Epoch 29
Loss = 4.8042e-04, PNorm = 66.2922, GNorm = 0.5524, lr_0 = 1.0807e-04
Loss = 8.0992e-04, PNorm = 66.3053, GNorm = 0.1441, lr_0 = 1.0640e-04
Loss = 9.7975e-04, PNorm = 66.3135, GNorm = 0.1902, lr_0 = 1.0476e-04
Loss = 4.4787e-04, PNorm = 66.3204, GNorm = 0.5008, lr_0 = 1.0315e-04
Loss = 5.0273e-04, PNorm = 66.3268, GNorm = 0.0808, lr_0 = 1.0156e-04
Loss = 7.4061e-04, PNorm = 66.3326, GNorm = 0.2717, lr_0 = 1.0000e-04
Validation auc = 0.923114
Model 0 best validation auc = 0.953165 on epoch 15
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test auc = nan
Ensemble test auc = nan
Fold 13
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': '../../../swansonk/chemprop_ckpt/0406_inhibition_hyperopt.json',
 'cuda': True,
 'data_path': '../../broad2/larger_dataset/0405_inhibition_dedup_binary.csv',
 'dataset_type': 'classification',
 'depth': 5,
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_dim': 200,
 'features_generator': None,
 'features_only': False,
 'features_path': ['../../saved_features/0405_broad_inhibition.npz'],
 'features_scaling': False,
 'features_size': 200,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 1600,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'no_cache': False,
 'num_folds': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'output_size': 1,
 'quiet': True,
 'save_dir': '../ckpt/0405_broad_inhibition_20folds/fold_13',
 'save_smiles_splits': False,
 'seed': 13,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'task_names': ['50uM_Inhibition'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 2654,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': ['../../saved_features/0405_broad_inhibition.npz'],
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 13
Class sizes
50uM_Inhibition 0: 91.93%, 1: 8.07%
Total size = 2,949 | train size = 2,654 | val size = 295 | test size = 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1600, bias=False)
      (W_h): Linear(in_features=1600, out_features=1600, bias=False)
      (W_o): Linear(in_features=1733, out_features=1600, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,571,401
Moving model to cuda
Epoch 0
Loss = 7.7585e-03, PNorm = 59.4373, GNorm = 0.5681, lr_0 = 1.8491e-04
Loss = 5.8777e-03, PNorm = 59.4532, GNorm = 0.4589, lr_0 = 2.6981e-04
Loss = 6.1610e-03, PNorm = 59.4705, GNorm = 0.4667, lr_0 = 3.5472e-04
Loss = 5.7012e-03, PNorm = 59.4918, GNorm = 0.6158, lr_0 = 4.3962e-04
Loss = 5.3215e-03, PNorm = 59.5259, GNorm = 0.8336, lr_0 = 5.2453e-04
Validation auc = 0.792018
Epoch 1
Loss = 6.0361e-03, PNorm = 59.5651, GNorm = 1.0586, lr_0 = 6.0943e-04
Loss = 4.3635e-03, PNorm = 59.6220, GNorm = 0.5014, lr_0 = 6.9434e-04
Loss = 4.5099e-03, PNorm = 59.6781, GNorm = 0.5220, lr_0 = 7.7925e-04
Loss = 6.2926e-03, PNorm = 59.7414, GNorm = 0.5226, lr_0 = 8.6415e-04
Loss = 5.0340e-03, PNorm = 59.8330, GNorm = 0.4261, lr_0 = 9.4906e-04
Validation auc = 0.769755
Epoch 2
Loss = 4.3859e-03, PNorm = 59.9412, GNorm = 0.5091, lr_0 = 9.9381e-04
Loss = 5.2426e-03, PNorm = 60.0276, GNorm = 1.1289, lr_0 = 9.7851e-04
Loss = 4.7084e-03, PNorm = 60.1238, GNorm = 0.4048, lr_0 = 9.6345e-04
Loss = 4.2728e-03, PNorm = 60.2138, GNorm = 1.0789, lr_0 = 9.4861e-04
Loss = 3.6545e-03, PNorm = 60.3134, GNorm = 1.6374, lr_0 = 9.3401e-04
Validation auc = 0.803249
Epoch 3
Loss = 5.1306e-03, PNorm = 60.3929, GNorm = 1.5631, lr_0 = 9.1963e-04
Loss = 4.1034e-03, PNorm = 60.4728, GNorm = 0.5266, lr_0 = 9.0547e-04
Loss = 3.0991e-03, PNorm = 60.5684, GNorm = 0.3945, lr_0 = 8.9153e-04
Loss = 4.8359e-03, PNorm = 60.6397, GNorm = 0.4929, lr_0 = 8.7780e-04
Loss = 3.9172e-03, PNorm = 60.7352, GNorm = 0.8207, lr_0 = 8.6429e-04
Loss = 3.3173e-03, PNorm = 60.8445, GNorm = 0.8009, lr_0 = 8.5098e-04
Validation auc = 0.856398
Epoch 4
Loss = 4.2725e-03, PNorm = 60.9318, GNorm = 0.5499, lr_0 = 8.3788e-04
Loss = 3.5462e-03, PNorm = 61.0306, GNorm = 0.4733, lr_0 = 8.2498e-04
Loss = 3.7478e-03, PNorm = 61.1261, GNorm = 0.5414, lr_0 = 8.1228e-04
Loss = 3.6825e-03, PNorm = 61.2217, GNorm = 0.2824, lr_0 = 7.9977e-04
Loss = 3.8098e-03, PNorm = 61.2829, GNorm = 0.2695, lr_0 = 7.8746e-04
Validation auc = 0.897914
Epoch 5
Loss = 5.4991e-03, PNorm = 61.3587, GNorm = 0.9946, lr_0 = 7.7533e-04
Loss = 3.0876e-03, PNorm = 61.4547, GNorm = 0.2400, lr_0 = 7.6340e-04
Loss = 3.1452e-03, PNorm = 61.5529, GNorm = 0.3965, lr_0 = 7.5164e-04
Loss = 3.7416e-03, PNorm = 61.6297, GNorm = 1.3463, lr_0 = 7.4007e-04
Loss = 2.8533e-03, PNorm = 61.7253, GNorm = 0.3059, lr_0 = 7.2867e-04
Validation auc = 0.923987
Epoch 6
Loss = 2.4577e-03, PNorm = 61.8029, GNorm = 0.2494, lr_0 = 7.1746e-04
Loss = 2.4144e-03, PNorm = 61.8855, GNorm = 0.4046, lr_0 = 7.0641e-04
Loss = 2.7406e-03, PNorm = 61.9627, GNorm = 0.6718, lr_0 = 6.9553e-04
Loss = 3.1605e-03, PNorm = 62.0476, GNorm = 0.5129, lr_0 = 6.8482e-04
Loss = 3.6261e-03, PNorm = 62.1342, GNorm = 0.5571, lr_0 = 6.7428e-04
Loss = 3.0013e-03, PNorm = 62.2103, GNorm = 0.4950, lr_0 = 6.6390e-04
Validation auc = 0.939832
Epoch 7
Loss = 2.1769e-03, PNorm = 62.3048, GNorm = 0.7663, lr_0 = 6.5368e-04
Loss = 3.3837e-03, PNorm = 62.3779, GNorm = 0.3946, lr_0 = 6.4361e-04
Loss = 2.5435e-03, PNorm = 62.4619, GNorm = 0.5654, lr_0 = 6.3370e-04
Loss = 3.7032e-03, PNorm = 62.5356, GNorm = 1.0076, lr_0 = 6.2395e-04
Loss = 2.9876e-03, PNorm = 62.6312, GNorm = 0.6210, lr_0 = 6.1434e-04
Validation auc = 0.938829
Epoch 8
Loss = 2.0571e-03, PNorm = 62.7185, GNorm = 0.4200, lr_0 = 6.0488e-04
Loss = 1.9377e-03, PNorm = 62.7969, GNorm = 0.1290, lr_0 = 5.9557e-04
Loss = 3.5911e-03, PNorm = 62.8390, GNorm = 0.3595, lr_0 = 5.8640e-04
Loss = 2.1986e-03, PNorm = 62.9171, GNorm = 0.4096, lr_0 = 5.7737e-04
Loss = 2.3856e-03, PNorm = 62.9984, GNorm = 0.3415, lr_0 = 5.6848e-04
Validation auc = 0.960088
Epoch 9
Loss = 1.9378e-03, PNorm = 63.0666, GNorm = 0.5644, lr_0 = 5.5973e-04
Loss = 2.5588e-03, PNorm = 63.1483, GNorm = 0.9050, lr_0 = 5.5111e-04
Loss = 2.4535e-03, PNorm = 63.2231, GNorm = 0.7358, lr_0 = 5.4263e-04
Loss = 1.7427e-03, PNorm = 63.2859, GNorm = 0.4939, lr_0 = 5.3427e-04
Loss = 2.7028e-03, PNorm = 63.3422, GNorm = 0.3796, lr_0 = 5.2605e-04
Loss = 2.0790e-03, PNorm = 63.4081, GNorm = 0.5956, lr_0 = 5.1795e-04
Validation auc = 0.952667
Epoch 10
Loss = 2.7446e-03, PNorm = 63.4619, GNorm = 0.3528, lr_0 = 5.0997e-04
Loss = 1.5585e-03, PNorm = 63.5215, GNorm = 0.3597, lr_0 = 5.0212e-04
Loss = 1.5595e-03, PNorm = 63.5815, GNorm = 0.6501, lr_0 = 4.9439e-04
Loss = 2.5769e-03, PNorm = 63.6287, GNorm = 0.3128, lr_0 = 4.8678e-04
Loss = 2.3968e-03, PNorm = 63.6973, GNorm = 0.4420, lr_0 = 4.7928e-04
Validation auc = 0.952868
Epoch 11
Loss = 1.3618e-03, PNorm = 63.7716, GNorm = 0.1603, lr_0 = 4.7190e-04
Loss = 1.8276e-03, PNorm = 63.8366, GNorm = 0.3803, lr_0 = 4.6464e-04
Loss = 2.2445e-03, PNorm = 63.8906, GNorm = 0.3727, lr_0 = 4.5749e-04
Loss = 2.0178e-03, PNorm = 63.9426, GNorm = 0.4204, lr_0 = 4.5044e-04
Loss = 2.1649e-03, PNorm = 63.9985, GNorm = 0.4699, lr_0 = 4.4351e-04
Validation auc = 0.938829
Epoch 12
Loss = 2.2221e-03, PNorm = 64.0356, GNorm = 0.5632, lr_0 = 4.3668e-04
Loss = 1.6113e-03, PNorm = 64.0903, GNorm = 0.3687, lr_0 = 4.2996e-04
Loss = 2.0819e-03, PNorm = 64.1430, GNorm = 0.8014, lr_0 = 4.2334e-04
Loss = 2.0007e-03, PNorm = 64.1893, GNorm = 0.4085, lr_0 = 4.1682e-04
Loss = 2.0757e-03, PNorm = 64.2465, GNorm = 0.3667, lr_0 = 4.1040e-04
Validation auc = 0.949258
Epoch 13
Loss = 1.0534e-03, PNorm = 64.3025, GNorm = 0.4193, lr_0 = 4.0408e-04
Loss = 1.4241e-03, PNorm = 64.3638, GNorm = 0.7147, lr_0 = 3.9786e-04
Loss = 2.1317e-03, PNorm = 64.4165, GNorm = 0.3464, lr_0 = 3.9173e-04
Loss = 2.3201e-03, PNorm = 64.4586, GNorm = 0.2990, lr_0 = 3.8570e-04
Loss = 1.2590e-03, PNorm = 64.5098, GNorm = 0.3915, lr_0 = 3.7976e-04
Loss = 2.1472e-03, PNorm = 64.5549, GNorm = 0.3781, lr_0 = 3.7392e-04
Validation auc = 0.941436
Epoch 14
Loss = 1.8495e-03, PNorm = 64.5933, GNorm = 0.9302, lr_0 = 3.6816e-04
Loss = 1.6320e-03, PNorm = 64.6444, GNorm = 0.2802, lr_0 = 3.6249e-04
Loss = 1.4771e-03, PNorm = 64.6860, GNorm = 0.1481, lr_0 = 3.5691e-04
Loss = 1.8973e-03, PNorm = 64.7149, GNorm = 0.2165, lr_0 = 3.5142e-04
Loss = 1.7949e-03, PNorm = 64.7615, GNorm = 0.8803, lr_0 = 3.4601e-04
Validation auc = 0.903329
Epoch 15
Loss = 2.3429e-03, PNorm = 64.7975, GNorm = 0.8150, lr_0 = 3.4068e-04
Loss = 1.5779e-03, PNorm = 64.8426, GNorm = 0.4330, lr_0 = 3.3543e-04
Loss = 1.5974e-03, PNorm = 64.8900, GNorm = 0.4530, lr_0 = 3.3027e-04
Loss = 1.4705e-03, PNorm = 64.9380, GNorm = 0.1991, lr_0 = 3.2518e-04
Loss = 8.8965e-04, PNorm = 64.9864, GNorm = 0.2342, lr_0 = 3.2018e-04
Validation auc = 0.934416
Epoch 16
Loss = 1.0994e-03, PNorm = 65.0240, GNorm = 0.5440, lr_0 = 3.1525e-04
Loss = 1.0362e-03, PNorm = 65.0554, GNorm = 0.1037, lr_0 = 3.1039e-04
Loss = 1.1569e-03, PNorm = 65.0873, GNorm = 0.5625, lr_0 = 3.0562e-04
Loss = 2.2935e-03, PNorm = 65.1168, GNorm = 0.7398, lr_0 = 3.0091e-04
Loss = 1.0352e-03, PNorm = 65.1562, GNorm = 0.3890, lr_0 = 2.9628e-04
Loss = 1.1171e-03, PNorm = 65.1942, GNorm = 0.7265, lr_0 = 2.9172e-04
Validation auc = 0.913157
Epoch 17
Loss = 8.4084e-04, PNorm = 65.2272, GNorm = 0.4305, lr_0 = 2.8722e-04
Loss = 1.0530e-03, PNorm = 65.2660, GNorm = 0.5132, lr_0 = 2.8280e-04
Loss = 1.0379e-03, PNorm = 65.2940, GNorm = 0.4442, lr_0 = 2.7845e-04
Loss = 1.6121e-03, PNorm = 65.3245, GNorm = 0.3870, lr_0 = 2.7416e-04
Loss = 1.2600e-03, PNorm = 65.3598, GNorm = 0.4110, lr_0 = 2.6994e-04
Validation auc = 0.932812
Epoch 18
Loss = 7.7843e-04, PNorm = 65.3881, GNorm = 0.3947, lr_0 = 2.6578e-04
Loss = 9.2661e-04, PNorm = 65.4247, GNorm = 0.3858, lr_0 = 2.6169e-04
Loss = 1.5744e-03, PNorm = 65.4422, GNorm = 0.6551, lr_0 = 2.5766e-04
Loss = 1.7864e-03, PNorm = 65.4873, GNorm = 0.5001, lr_0 = 2.5370e-04
Loss = 1.4746e-03, PNorm = 65.5143, GNorm = 0.6178, lr_0 = 2.4979e-04
Validation auc = 0.942439
Epoch 19
Loss = 5.8404e-04, PNorm = 65.5551, GNorm = 0.4942, lr_0 = 2.4594e-04
Loss = 1.4207e-03, PNorm = 65.5834, GNorm = 0.6784, lr_0 = 2.4216e-04
Loss = 1.1840e-03, PNorm = 65.6204, GNorm = 0.6381, lr_0 = 2.3843e-04
Loss = 8.5555e-04, PNorm = 65.6515, GNorm = 0.3018, lr_0 = 2.3476e-04
Loss = 1.0169e-03, PNorm = 65.6691, GNorm = 0.8976, lr_0 = 2.3114e-04
Loss = 1.2932e-03, PNorm = 65.7007, GNorm = 0.5967, lr_0 = 2.2758e-04
Validation auc = 0.925592
Epoch 20
Loss = 7.7168e-04, PNorm = 65.7208, GNorm = 0.1780, lr_0 = 2.2408e-04
Loss = 9.0531e-04, PNorm = 65.7388, GNorm = 0.1573, lr_0 = 2.2063e-04
Loss = 1.4293e-03, PNorm = 65.7613, GNorm = 0.5323, lr_0 = 2.1723e-04
Loss = 1.0029e-03, PNorm = 65.7844, GNorm = 0.5174, lr_0 = 2.1389e-04
Loss = 1.0858e-03, PNorm = 65.8149, GNorm = 1.2698, lr_0 = 2.1060e-04
Validation auc = 0.932812
Epoch 21
Loss = 9.0161e-04, PNorm = 65.8292, GNorm = 0.4200, lr_0 = 2.0735e-04
Loss = 6.3440e-04, PNorm = 65.8521, GNorm = 0.2464, lr_0 = 2.0416e-04
Loss = 1.0698e-03, PNorm = 65.8663, GNorm = 0.2748, lr_0 = 2.0102e-04
Loss = 9.4772e-04, PNorm = 65.8936, GNorm = 0.6240, lr_0 = 1.9792e-04
Loss = 1.2656e-03, PNorm = 65.9086, GNorm = 1.2587, lr_0 = 1.9488e-04
Validation auc = 0.948656
Epoch 22
Loss = 1.6178e-03, PNorm = 65.9240, GNorm = 0.9685, lr_0 = 1.9188e-04
Loss = 7.1282e-04, PNorm = 65.9542, GNorm = 0.2057, lr_0 = 1.8892e-04
Loss = 9.0467e-04, PNorm = 65.9667, GNorm = 0.5367, lr_0 = 1.8601e-04
Loss = 9.8849e-04, PNorm = 65.9871, GNorm = 0.1586, lr_0 = 1.8315e-04
Loss = 1.2272e-03, PNorm = 66.0094, GNorm = 0.4865, lr_0 = 1.8033e-04
Validation auc = 0.925993
Epoch 23
Loss = 5.0241e-04, PNorm = 66.0227, GNorm = 0.3376, lr_0 = 1.7755e-04
Loss = 5.1272e-04, PNorm = 66.0382, GNorm = 0.3769, lr_0 = 1.7482e-04
Loss = 6.2318e-04, PNorm = 66.0498, GNorm = 0.8957, lr_0 = 1.7213e-04
Loss = 6.9281e-04, PNorm = 66.0602, GNorm = 1.0426, lr_0 = 1.6948e-04
Loss = 1.0534e-03, PNorm = 66.0782, GNorm = 0.1812, lr_0 = 1.6687e-04
Loss = 1.2171e-03, PNorm = 66.0889, GNorm = 0.6120, lr_0 = 1.6430e-04
Validation auc = 0.927397
Epoch 24
Loss = 7.2590e-04, PNorm = 66.1131, GNorm = 0.2864, lr_0 = 1.6177e-04
Loss = 7.2765e-04, PNorm = 66.1249, GNorm = 0.7399, lr_0 = 1.5928e-04
Loss = 5.7530e-04, PNorm = 66.1356, GNorm = 0.2723, lr_0 = 1.5683e-04
Loss = 7.0120e-04, PNorm = 66.1487, GNorm = 0.2234, lr_0 = 1.5441e-04
Loss = 1.1094e-03, PNorm = 66.1659, GNorm = 0.5912, lr_0 = 1.5203e-04
Validation auc = 0.916165
Epoch 25
Loss = 4.2986e-04, PNorm = 66.1797, GNorm = 0.5373, lr_0 = 1.4969e-04
Loss = 7.8031e-04, PNorm = 66.1901, GNorm = 0.3599, lr_0 = 1.4739e-04
Loss = 7.4429e-04, PNorm = 66.2062, GNorm = 0.2832, lr_0 = 1.4512e-04
Loss = 4.5993e-04, PNorm = 66.2150, GNorm = 0.2369, lr_0 = 1.4288e-04
Loss = 1.1373e-03, PNorm = 66.2209, GNorm = 0.0200, lr_0 = 1.4069e-04
Validation auc = 0.914761
Epoch 26
Loss = 4.6903e-04, PNorm = 66.2354, GNorm = 0.3378, lr_0 = 1.3852e-04
Loss = 6.3494e-04, PNorm = 66.2441, GNorm = 0.9121, lr_0 = 1.3639e-04
Loss = 8.9268e-04, PNorm = 66.2531, GNorm = 1.0958, lr_0 = 1.3429e-04
Loss = 6.4764e-04, PNorm = 66.2612, GNorm = 0.1016, lr_0 = 1.3222e-04
Loss = 5.2797e-04, PNorm = 66.2716, GNorm = 0.6480, lr_0 = 1.3018e-04
Loss = 9.1199e-04, PNorm = 66.2764, GNorm = 0.4678, lr_0 = 1.2818e-04
Validation auc = 0.920578
Epoch 27
Loss = 4.4777e-04, PNorm = 66.2887, GNorm = 0.4949, lr_0 = 1.2621e-04
Loss = 6.4020e-04, PNorm = 66.2983, GNorm = 0.4012, lr_0 = 1.2426e-04
Loss = 4.4367e-04, PNorm = 66.3094, GNorm = 0.2928, lr_0 = 1.2235e-04
Loss = 1.1005e-03, PNorm = 66.3153, GNorm = 0.9066, lr_0 = 1.2047e-04
Loss = 6.5264e-04, PNorm = 66.3252, GNorm = 0.0922, lr_0 = 1.1861e-04
Validation auc = 0.915363
Epoch 28
Loss = 6.0040e-04, PNorm = 66.3338, GNorm = 0.7737, lr_0 = 1.1678e-04
Loss = 6.8777e-04, PNorm = 66.3393, GNorm = 0.6669, lr_0 = 1.1499e-04
Loss = 6.5820e-04, PNorm = 66.3533, GNorm = 0.1569, lr_0 = 1.1322e-04
Loss = 5.3518e-04, PNorm = 66.3647, GNorm = 0.9720, lr_0 = 1.1147e-04
Loss = 3.8884e-04, PNorm = 66.3718, GNorm = 0.1291, lr_0 = 1.0976e-04
Validation auc = 0.912355
Epoch 29
Loss = 6.1953e-04, PNorm = 66.3826, GNorm = 0.0776, lr_0 = 1.0807e-04
Loss = 3.9157e-04, PNorm = 66.3868, GNorm = 0.5320, lr_0 = 1.0640e-04
Loss = 7.7661e-04, PNorm = 66.3926, GNorm = 0.9695, lr_0 = 1.0476e-04
Loss = 6.8404e-04, PNorm = 66.3975, GNorm = 0.9676, lr_0 = 1.0315e-04
Loss = 5.2023e-04, PNorm = 66.4071, GNorm = 0.1111, lr_0 = 1.0156e-04
Loss = 6.5171e-04, PNorm = 66.4131, GNorm = 0.9687, lr_0 = 1.0000e-04
Validation auc = 0.912154
Model 0 best validation auc = 0.960088 on epoch 8
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test auc = nan
Ensemble test auc = nan
Fold 14
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': '../../../swansonk/chemprop_ckpt/0406_inhibition_hyperopt.json',
 'cuda': True,
 'data_path': '../../broad2/larger_dataset/0405_inhibition_dedup_binary.csv',
 'dataset_type': 'classification',
 'depth': 5,
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_dim': 200,
 'features_generator': None,
 'features_only': False,
 'features_path': ['../../saved_features/0405_broad_inhibition.npz'],
 'features_scaling': False,
 'features_size': 200,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 1600,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'no_cache': False,
 'num_folds': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'output_size': 1,
 'quiet': True,
 'save_dir': '../ckpt/0405_broad_inhibition_20folds/fold_14',
 'save_smiles_splits': False,
 'seed': 14,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'task_names': ['50uM_Inhibition'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 2654,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': ['../../saved_features/0405_broad_inhibition.npz'],
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 14
Class sizes
50uM_Inhibition 0: 91.93%, 1: 8.07%
Total size = 2,949 | train size = 2,654 | val size = 295 | test size = 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1600, bias=False)
      (W_h): Linear(in_features=1600, out_features=1600, bias=False)
      (W_o): Linear(in_features=1733, out_features=1600, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,571,401
Moving model to cuda
Epoch 0
Loss = 8.1611e-03, PNorm = 59.4791, GNorm = 0.7021, lr_0 = 1.8491e-04
Loss = 4.9925e-03, PNorm = 59.4952, GNorm = 0.4540, lr_0 = 2.6981e-04
Loss = 6.3928e-03, PNorm = 59.5109, GNorm = 0.4665, lr_0 = 3.5472e-04
Loss = 4.9367e-03, PNorm = 59.5331, GNorm = 0.4828, lr_0 = 4.3962e-04
Loss = 5.5979e-03, PNorm = 59.5629, GNorm = 0.6213, lr_0 = 5.2453e-04
Validation auc = 0.815954
Epoch 1
Loss = 4.8162e-03, PNorm = 59.6017, GNorm = 0.5963, lr_0 = 6.0943e-04
Loss = 4.2785e-03, PNorm = 59.6591, GNorm = 0.3495, lr_0 = 6.9434e-04
Loss = 4.6031e-03, PNorm = 59.7304, GNorm = 0.9205, lr_0 = 7.7925e-04
Loss = 5.1383e-03, PNorm = 59.8072, GNorm = 0.7419, lr_0 = 8.6415e-04
Loss = 5.3845e-03, PNorm = 59.9017, GNorm = 0.3490, lr_0 = 9.4906e-04
Validation auc = 0.843413
Epoch 2
Loss = 3.3506e-03, PNorm = 60.0079, GNorm = 0.7110, lr_0 = 9.9381e-04
Loss = 4.6076e-03, PNorm = 60.1049, GNorm = 0.3569, lr_0 = 9.7851e-04
Loss = 3.6820e-03, PNorm = 60.1962, GNorm = 1.6518, lr_0 = 9.6345e-04
Loss = 4.4293e-03, PNorm = 60.2857, GNorm = 1.2834, lr_0 = 9.4861e-04
Loss = 3.7524e-03, PNorm = 60.3856, GNorm = 1.1481, lr_0 = 9.3401e-04
Validation auc = 0.857317
Epoch 3
Loss = 3.2727e-03, PNorm = 60.4480, GNorm = 0.4991, lr_0 = 9.1963e-04
Loss = 4.1534e-03, PNorm = 60.5316, GNorm = 0.6051, lr_0 = 9.0547e-04
Loss = 5.2303e-03, PNorm = 60.6418, GNorm = 0.3519, lr_0 = 8.9153e-04
Loss = 4.4821e-03, PNorm = 60.7574, GNorm = 0.4998, lr_0 = 8.7780e-04
Loss = 4.4683e-03, PNorm = 60.8696, GNorm = 0.3210, lr_0 = 8.6429e-04
Loss = 3.5450e-03, PNorm = 60.9540, GNorm = 0.3545, lr_0 = 8.5098e-04
Validation auc = 0.839590
Epoch 4
Loss = 4.5646e-03, PNorm = 61.0442, GNorm = 0.2594, lr_0 = 8.3788e-04
Loss = 3.2283e-03, PNorm = 61.1328, GNorm = 0.7831, lr_0 = 8.2498e-04
Loss = 3.6474e-03, PNorm = 61.2173, GNorm = 0.5708, lr_0 = 8.1228e-04
Loss = 3.8453e-03, PNorm = 61.2984, GNorm = 0.3914, lr_0 = 7.9977e-04
Loss = 3.1313e-03, PNorm = 61.3961, GNorm = 0.3541, lr_0 = 7.8746e-04
Validation auc = 0.880083
Epoch 5
Loss = 4.1908e-03, PNorm = 61.4869, GNorm = 1.1211, lr_0 = 7.7533e-04
Loss = 3.3094e-03, PNorm = 61.5673, GNorm = 0.5307, lr_0 = 7.6340e-04
Loss = 2.4733e-03, PNorm = 61.6568, GNorm = 0.7835, lr_0 = 7.5164e-04
Loss = 3.8450e-03, PNorm = 61.7331, GNorm = 0.3873, lr_0 = 7.4007e-04
Loss = 3.1036e-03, PNorm = 61.8516, GNorm = 0.4780, lr_0 = 7.2867e-04
Validation auc = 0.897810
Epoch 6
Loss = 3.8054e-03, PNorm = 61.9823, GNorm = 0.3757, lr_0 = 7.1746e-04
Loss = 4.3423e-03, PNorm = 62.0872, GNorm = 0.4919, lr_0 = 7.0641e-04
Loss = 2.5159e-03, PNorm = 62.1951, GNorm = 0.6972, lr_0 = 6.9553e-04
Loss = 2.3453e-03, PNorm = 62.2966, GNorm = 0.7035, lr_0 = 6.8482e-04
Loss = 2.9881e-03, PNorm = 62.3602, GNorm = 0.4391, lr_0 = 6.7428e-04
Loss = 2.1888e-03, PNorm = 62.4501, GNorm = 0.3534, lr_0 = 6.6390e-04
Validation auc = 0.903893
Epoch 7
Loss = 1.9381e-03, PNorm = 62.5180, GNorm = 0.4378, lr_0 = 6.5368e-04
Loss = 2.3388e-03, PNorm = 62.5945, GNorm = 0.3904, lr_0 = 6.4361e-04
Loss = 2.2962e-03, PNorm = 62.6645, GNorm = 0.4573, lr_0 = 6.3370e-04
Loss = 2.6410e-03, PNorm = 62.7397, GNorm = 0.4422, lr_0 = 6.2395e-04
Loss = 3.5332e-03, PNorm = 62.7919, GNorm = 0.4031, lr_0 = 6.1434e-04
Validation auc = 0.907021
Epoch 8
Loss = 3.4335e-03, PNorm = 62.8791, GNorm = 0.4998, lr_0 = 6.0488e-04
Loss = 2.7370e-03, PNorm = 62.9799, GNorm = 0.4865, lr_0 = 5.9557e-04
Loss = 3.6266e-03, PNorm = 63.0442, GNorm = 0.4676, lr_0 = 5.8640e-04
Loss = 2.0404e-03, PNorm = 63.1317, GNorm = 0.2743, lr_0 = 5.7737e-04
Loss = 1.7426e-03, PNorm = 63.2010, GNorm = 0.7964, lr_0 = 5.6848e-04
Validation auc = 0.900417
Epoch 9
Loss = 2.1056e-03, PNorm = 63.2831, GNorm = 0.5708, lr_0 = 5.5973e-04
Loss = 2.7581e-03, PNorm = 63.3582, GNorm = 0.4270, lr_0 = 5.5111e-04
Loss = 2.3927e-03, PNorm = 63.4130, GNorm = 0.4309, lr_0 = 5.4263e-04
Loss = 2.2727e-03, PNorm = 63.4735, GNorm = 0.2683, lr_0 = 5.3427e-04
Loss = 2.0708e-03, PNorm = 63.5294, GNorm = 0.2549, lr_0 = 5.2605e-04
Loss = 1.8391e-03, PNorm = 63.5843, GNorm = 0.4558, lr_0 = 5.1795e-04
Validation auc = 0.889468
Epoch 10
Loss = 1.8146e-03, PNorm = 63.6381, GNorm = 0.8725, lr_0 = 5.0997e-04
Loss = 2.6651e-03, PNorm = 63.6913, GNorm = 0.4990, lr_0 = 5.0212e-04
Loss = 2.2412e-03, PNorm = 63.7494, GNorm = 0.4488, lr_0 = 4.9439e-04
Loss = 2.0386e-03, PNorm = 63.8076, GNorm = 0.4481, lr_0 = 4.8678e-04
Loss = 1.6013e-03, PNorm = 63.8678, GNorm = 0.2508, lr_0 = 4.7928e-04
Validation auc = 0.918839
Epoch 11
Loss = 1.6710e-03, PNorm = 63.9198, GNorm = 1.5512, lr_0 = 4.7190e-04
Loss = 1.9713e-03, PNorm = 63.9788, GNorm = 0.3452, lr_0 = 4.6464e-04
Loss = 1.7521e-03, PNorm = 64.0425, GNorm = 0.2985, lr_0 = 4.5749e-04
Loss = 1.7557e-03, PNorm = 64.0972, GNorm = 0.5581, lr_0 = 4.5044e-04
Loss = 2.1537e-03, PNorm = 64.1220, GNorm = 0.5972, lr_0 = 4.4351e-04
Validation auc = 0.918491
Epoch 12
Loss = 2.0024e-03, PNorm = 64.1616, GNorm = 0.5698, lr_0 = 4.3668e-04
Loss = 1.6191e-03, PNorm = 64.2158, GNorm = 0.4632, lr_0 = 4.2996e-04
Loss = 1.7663e-03, PNorm = 64.2809, GNorm = 0.4292, lr_0 = 4.2334e-04
Loss = 1.8948e-03, PNorm = 64.3315, GNorm = 0.5307, lr_0 = 4.1682e-04
Loss = 1.9381e-03, PNorm = 64.3914, GNorm = 0.3766, lr_0 = 4.1040e-04
Validation auc = 0.923531
Epoch 13
Loss = 5.2383e-04, PNorm = 64.4419, GNorm = 0.3814, lr_0 = 4.0408e-04
Loss = 1.5420e-03, PNorm = 64.4963, GNorm = 0.9133, lr_0 = 3.9786e-04
Loss = 1.5813e-03, PNorm = 64.5376, GNorm = 0.6193, lr_0 = 3.9173e-04
Loss = 1.8333e-03, PNorm = 64.5784, GNorm = 0.8649, lr_0 = 3.8570e-04
Loss = 1.5379e-03, PNorm = 64.6179, GNorm = 0.5246, lr_0 = 3.7976e-04
Loss = 1.7727e-03, PNorm = 64.6537, GNorm = 0.4038, lr_0 = 3.7392e-04
Validation auc = 0.914842
Epoch 14
Loss = 1.6574e-03, PNorm = 64.6932, GNorm = 0.6170, lr_0 = 3.6816e-04
Loss = 1.9263e-03, PNorm = 64.7276, GNorm = 0.6398, lr_0 = 3.6249e-04
Loss = 1.3667e-03, PNorm = 64.7780, GNorm = 0.4178, lr_0 = 3.5691e-04
Loss = 1.4593e-03, PNorm = 64.8236, GNorm = 0.4770, lr_0 = 3.5142e-04
Loss = 1.8495e-03, PNorm = 64.8697, GNorm = 0.3956, lr_0 = 3.4601e-04
Validation auc = 0.896767
Epoch 15
Loss = 1.2301e-03, PNorm = 64.9122, GNorm = 0.3127, lr_0 = 3.4068e-04
Loss = 1.4561e-03, PNorm = 64.9642, GNorm = 0.7908, lr_0 = 3.3543e-04
Loss = 1.1942e-03, PNorm = 65.0140, GNorm = 0.7595, lr_0 = 3.3027e-04
Loss = 1.9143e-03, PNorm = 65.0343, GNorm = 0.6061, lr_0 = 3.2518e-04
Loss = 1.6175e-03, PNorm = 65.0658, GNorm = 0.4827, lr_0 = 3.2018e-04
Validation auc = 0.907543
Epoch 16
Loss = 1.1245e-03, PNorm = 65.0916, GNorm = 0.6407, lr_0 = 3.1525e-04
Loss = 9.9171e-04, PNorm = 65.1256, GNorm = 0.4129, lr_0 = 3.1039e-04
Loss = 1.4435e-03, PNorm = 65.1557, GNorm = 0.7630, lr_0 = 3.0562e-04
Loss = 1.7951e-03, PNorm = 65.1806, GNorm = 0.6700, lr_0 = 3.0091e-04
Loss = 1.4138e-03, PNorm = 65.2197, GNorm = 0.3181, lr_0 = 2.9628e-04
Loss = 1.0268e-03, PNorm = 65.2617, GNorm = 0.2904, lr_0 = 2.9172e-04
Validation auc = 0.900938
Epoch 17
Loss = 9.1564e-04, PNorm = 65.2945, GNorm = 0.2059, lr_0 = 2.8722e-04
Loss = 1.4822e-03, PNorm = 65.3182, GNorm = 0.4962, lr_0 = 2.8280e-04
Loss = 1.2372e-03, PNorm = 65.3499, GNorm = 0.6698, lr_0 = 2.7845e-04
Loss = 1.0978e-03, PNorm = 65.3804, GNorm = 0.6980, lr_0 = 2.7416e-04
Loss = 1.5079e-03, PNorm = 65.4123, GNorm = 1.3114, lr_0 = 2.6994e-04
Validation auc = 0.902850
Epoch 18
Loss = 8.0506e-04, PNorm = 65.4374, GNorm = 0.2255, lr_0 = 2.6578e-04
Loss = 1.3506e-03, PNorm = 65.4594, GNorm = 0.2264, lr_0 = 2.6169e-04
Loss = 1.3685e-03, PNorm = 65.4868, GNorm = 0.3031, lr_0 = 2.5766e-04
Loss = 1.3403e-03, PNorm = 65.5258, GNorm = 0.7867, lr_0 = 2.5370e-04
Loss = 1.0677e-03, PNorm = 65.5503, GNorm = 0.6511, lr_0 = 2.4979e-04
Validation auc = 0.906326
Epoch 19
Loss = 1.2051e-03, PNorm = 65.5835, GNorm = 0.3897, lr_0 = 2.4594e-04
Loss = 1.0326e-03, PNorm = 65.6099, GNorm = 0.4062, lr_0 = 2.4216e-04
Loss = 1.0656e-03, PNorm = 65.6367, GNorm = 0.5411, lr_0 = 2.3843e-04
Loss = 9.3551e-04, PNorm = 65.6729, GNorm = 1.5684, lr_0 = 2.3476e-04
Loss = 1.4623e-03, PNorm = 65.6895, GNorm = 0.8772, lr_0 = 2.3114e-04
Loss = 1.2491e-03, PNorm = 65.7170, GNorm = 0.4294, lr_0 = 2.2758e-04
Validation auc = 0.889121
Epoch 20
Loss = 7.9884e-04, PNorm = 65.7441, GNorm = 0.3412, lr_0 = 2.2408e-04
Loss = 1.3890e-03, PNorm = 65.7692, GNorm = 0.6918, lr_0 = 2.2063e-04
Loss = 1.1962e-03, PNorm = 65.7845, GNorm = 0.5306, lr_0 = 2.1723e-04
Loss = 1.1950e-03, PNorm = 65.8141, GNorm = 0.8988, lr_0 = 2.1389e-04
Loss = 1.0782e-03, PNorm = 65.8332, GNorm = 0.5695, lr_0 = 2.1060e-04
Validation auc = 0.910497
Epoch 21
Loss = 9.3161e-04, PNorm = 65.8559, GNorm = 0.3184, lr_0 = 2.0735e-04
Loss = 6.5201e-04, PNorm = 65.8735, GNorm = 0.2698, lr_0 = 2.0416e-04
Loss = 1.0783e-03, PNorm = 65.8943, GNorm = 0.4440, lr_0 = 2.0102e-04
Loss = 1.4606e-03, PNorm = 65.9073, GNorm = 0.6958, lr_0 = 1.9792e-04
Loss = 9.2405e-04, PNorm = 65.9380, GNorm = 0.9276, lr_0 = 1.9488e-04
Validation auc = 0.892075
Epoch 22
Loss = 9.3732e-04, PNorm = 65.9561, GNorm = 0.6198, lr_0 = 1.9188e-04
Loss = 1.0737e-03, PNorm = 65.9766, GNorm = 1.2712, lr_0 = 1.8892e-04
Loss = 9.9845e-04, PNorm = 65.9917, GNorm = 0.2055, lr_0 = 1.8601e-04
Loss = 1.1100e-03, PNorm = 66.0067, GNorm = 0.3148, lr_0 = 1.8315e-04
Loss = 9.4552e-04, PNorm = 66.0246, GNorm = 0.3396, lr_0 = 1.8033e-04
Validation auc = 0.904241
Epoch 23
Loss = 2.0464e-04, PNorm = 66.0483, GNorm = 0.1838, lr_0 = 1.7755e-04
Loss = 1.0233e-03, PNorm = 66.0592, GNorm = 0.7030, lr_0 = 1.7482e-04
Loss = 8.3462e-04, PNorm = 66.0792, GNorm = 1.0848, lr_0 = 1.7213e-04
Loss = 1.1142e-03, PNorm = 66.0887, GNorm = 0.7970, lr_0 = 1.6948e-04
Loss = 1.0654e-03, PNorm = 66.1049, GNorm = 0.6136, lr_0 = 1.6687e-04
Loss = 8.3796e-04, PNorm = 66.1196, GNorm = 0.1969, lr_0 = 1.6430e-04
Validation auc = 0.896594
Epoch 24
Loss = 1.2776e-03, PNorm = 66.1425, GNorm = 0.6786, lr_0 = 1.6177e-04
Loss = 8.7817e-04, PNorm = 66.1593, GNorm = 0.4989, lr_0 = 1.5928e-04
Loss = 6.5631e-04, PNorm = 66.1730, GNorm = 0.3461, lr_0 = 1.5683e-04
Loss = 7.7543e-04, PNorm = 66.1887, GNorm = 0.6890, lr_0 = 1.5441e-04
Loss = 5.9620e-04, PNorm = 66.1985, GNorm = 0.8080, lr_0 = 1.5203e-04
Validation auc = 0.899374
Epoch 25
Loss = 7.0121e-04, PNorm = 66.2092, GNorm = 0.7330, lr_0 = 1.4969e-04
Loss = 7.8312e-04, PNorm = 66.2264, GNorm = 0.5596, lr_0 = 1.4739e-04
Loss = 5.0311e-04, PNorm = 66.2340, GNorm = 0.8018, lr_0 = 1.4512e-04
Loss = 5.7817e-04, PNorm = 66.2476, GNorm = 1.2408, lr_0 = 1.4288e-04
Loss = 6.5408e-04, PNorm = 66.2596, GNorm = 0.3075, lr_0 = 1.4069e-04
Validation auc = 0.904762
Epoch 26
Loss = 1.1242e-03, PNorm = 66.2698, GNorm = 1.0192, lr_0 = 1.3852e-04
Loss = 6.1202e-04, PNorm = 66.2787, GNorm = 0.6481, lr_0 = 1.3639e-04
Loss = 9.0530e-04, PNorm = 66.2881, GNorm = 0.6447, lr_0 = 1.3429e-04
Loss = 3.6671e-04, PNorm = 66.2995, GNorm = 0.5339, lr_0 = 1.3222e-04
Loss = 7.5254e-04, PNorm = 66.3109, GNorm = 0.5367, lr_0 = 1.3018e-04
Loss = 8.0303e-04, PNorm = 66.3256, GNorm = 0.5245, lr_0 = 1.2818e-04
Validation auc = 0.892944
Epoch 27
Loss = 7.9182e-04, PNorm = 66.3323, GNorm = 1.1468, lr_0 = 1.2621e-04
Loss = 8.0783e-04, PNorm = 66.3454, GNorm = 0.8963, lr_0 = 1.2426e-04
Loss = 4.1707e-04, PNorm = 66.3534, GNorm = 0.3685, lr_0 = 1.2235e-04
Loss = 4.8022e-04, PNorm = 66.3626, GNorm = 0.5676, lr_0 = 1.2047e-04
Loss = 7.2866e-04, PNorm = 66.3713, GNorm = 0.8961, lr_0 = 1.1861e-04
Validation auc = 0.903372
Epoch 28
Loss = 9.6743e-04, PNorm = 66.3859, GNorm = 0.2701, lr_0 = 1.1678e-04
Loss = 2.7181e-04, PNorm = 66.3997, GNorm = 0.1663, lr_0 = 1.1499e-04
Loss = 6.4535e-04, PNorm = 66.4034, GNorm = 0.9964, lr_0 = 1.1322e-04
Loss = 8.5441e-04, PNorm = 66.4108, GNorm = 1.2559, lr_0 = 1.1147e-04
Loss = 7.3654e-04, PNorm = 66.4212, GNorm = 0.3004, lr_0 = 1.0976e-04
Validation auc = 0.902850
Epoch 29
Loss = 5.2235e-04, PNorm = 66.4253, GNorm = 0.1778, lr_0 = 1.0807e-04
Loss = 3.8989e-04, PNorm = 66.4372, GNorm = 0.1377, lr_0 = 1.0640e-04
Loss = 7.5722e-04, PNorm = 66.4419, GNorm = 0.1055, lr_0 = 1.0476e-04
Loss = 8.9561e-04, PNorm = 66.4508, GNorm = 0.6633, lr_0 = 1.0315e-04
Loss = 9.3763e-04, PNorm = 66.4611, GNorm = 1.0107, lr_0 = 1.0156e-04
Loss = 5.3280e-04, PNorm = 66.4625, GNorm = 0.4809, lr_0 = 1.0000e-04
Validation auc = 0.898158
Model 0 best validation auc = 0.923531 on epoch 12
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test auc = nan
Ensemble test auc = nan
Fold 15
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': '../../../swansonk/chemprop_ckpt/0406_inhibition_hyperopt.json',
 'cuda': True,
 'data_path': '../../broad2/larger_dataset/0405_inhibition_dedup_binary.csv',
 'dataset_type': 'classification',
 'depth': 5,
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_dim': 200,
 'features_generator': None,
 'features_only': False,
 'features_path': ['../../saved_features/0405_broad_inhibition.npz'],
 'features_scaling': False,
 'features_size': 200,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 1600,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'no_cache': False,
 'num_folds': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'output_size': 1,
 'quiet': True,
 'save_dir': '../ckpt/0405_broad_inhibition_20folds/fold_15',
 'save_smiles_splits': False,
 'seed': 15,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'task_names': ['50uM_Inhibition'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 2654,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': ['../../saved_features/0405_broad_inhibition.npz'],
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 15
Class sizes
50uM_Inhibition 0: 91.93%, 1: 8.07%
Total size = 2,949 | train size = 2,654 | val size = 295 | test size = 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1600, bias=False)
      (W_h): Linear(in_features=1600, out_features=1600, bias=False)
      (W_o): Linear(in_features=1733, out_features=1600, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,571,401
Moving model to cuda
Epoch 0
Loss = 9.2270e-03, PNorm = 59.4809, GNorm = 0.5296, lr_0 = 1.8491e-04
Loss = 5.8009e-03, PNorm = 59.5002, GNorm = 1.1512, lr_0 = 2.6981e-04
Loss = 6.5334e-03, PNorm = 59.5188, GNorm = 0.6181, lr_0 = 3.5472e-04
Loss = 5.0856e-03, PNorm = 59.5404, GNorm = 0.3556, lr_0 = 4.3962e-04
Loss = 4.9156e-03, PNorm = 59.5643, GNorm = 0.4878, lr_0 = 5.2453e-04
Validation auc = 0.773985
Epoch 1
Loss = 5.1987e-03, PNorm = 59.5906, GNorm = 1.1736, lr_0 = 6.0943e-04
Loss = 5.2789e-03, PNorm = 59.6303, GNorm = 0.4589, lr_0 = 6.9434e-04
Loss = 4.9557e-03, PNorm = 59.6803, GNorm = 0.4551, lr_0 = 7.7925e-04
Loss = 4.8688e-03, PNorm = 59.7576, GNorm = 1.3526, lr_0 = 8.6415e-04
Loss = 4.3073e-03, PNorm = 59.8439, GNorm = 0.2569, lr_0 = 9.4906e-04
Validation auc = 0.811501
Epoch 2
Loss = 4.3562e-03, PNorm = 59.9482, GNorm = 0.5425, lr_0 = 9.9381e-04
Loss = 4.9281e-03, PNorm = 60.0711, GNorm = 0.5797, lr_0 = 9.7851e-04
Loss = 4.6201e-03, PNorm = 60.1879, GNorm = 0.4017, lr_0 = 9.6345e-04
Loss = 4.9091e-03, PNorm = 60.2833, GNorm = 0.4640, lr_0 = 9.4861e-04
Loss = 4.2663e-03, PNorm = 60.3812, GNorm = 0.6879, lr_0 = 9.3401e-04
Validation auc = 0.820418
Epoch 3
Loss = 4.3946e-03, PNorm = 60.4716, GNorm = 0.6633, lr_0 = 9.1963e-04
Loss = 3.9738e-03, PNorm = 60.5491, GNorm = 0.6076, lr_0 = 9.0547e-04
Loss = 4.1150e-03, PNorm = 60.6402, GNorm = 0.3223, lr_0 = 8.9153e-04
Loss = 3.6297e-03, PNorm = 60.7382, GNorm = 0.4692, lr_0 = 8.7780e-04
Loss = 3.9505e-03, PNorm = 60.8323, GNorm = 0.9644, lr_0 = 8.6429e-04
Loss = 3.8640e-03, PNorm = 60.9153, GNorm = 0.3520, lr_0 = 8.5098e-04
Validation auc = 0.915129
Epoch 4
Loss = 2.0486e-03, PNorm = 60.9980, GNorm = 0.6078, lr_0 = 8.3788e-04
Loss = 4.4792e-03, PNorm = 61.0602, GNorm = 0.3884, lr_0 = 8.2498e-04
Loss = 3.6477e-03, PNorm = 61.1586, GNorm = 0.4440, lr_0 = 8.1228e-04
Loss = 3.4060e-03, PNorm = 61.2487, GNorm = 1.0799, lr_0 = 7.9977e-04
Loss = 3.1504e-03, PNorm = 61.3118, GNorm = 0.3851, lr_0 = 7.8746e-04
Validation auc = 0.933887
Epoch 5
Loss = 3.2086e-03, PNorm = 61.3948, GNorm = 0.4573, lr_0 = 7.7533e-04
Loss = 3.2933e-03, PNorm = 61.5151, GNorm = 0.3053, lr_0 = 7.6340e-04
Loss = 3.2112e-03, PNorm = 61.6108, GNorm = 0.9702, lr_0 = 7.5164e-04
Loss = 2.9793e-03, PNorm = 61.7076, GNorm = 0.2891, lr_0 = 7.4007e-04
Loss = 2.7842e-03, PNorm = 61.7955, GNorm = 0.4617, lr_0 = 7.2867e-04
Validation auc = 0.939422
Epoch 6
Loss = 2.6062e-03, PNorm = 61.8489, GNorm = 0.6415, lr_0 = 7.1746e-04
Loss = 4.1320e-03, PNorm = 61.9271, GNorm = 0.3454, lr_0 = 7.0641e-04
Loss = 2.9802e-03, PNorm = 62.0080, GNorm = 0.4292, lr_0 = 6.9553e-04
Loss = 2.4480e-03, PNorm = 62.0811, GNorm = 0.4336, lr_0 = 6.8482e-04
Loss = 3.0800e-03, PNorm = 62.1634, GNorm = 0.6585, lr_0 = 6.7428e-04
Loss = 2.3941e-03, PNorm = 62.2681, GNorm = 0.2730, lr_0 = 6.6390e-04
Validation auc = 0.939883
Epoch 7
Loss = 2.8906e-03, PNorm = 62.3699, GNorm = 0.5346, lr_0 = 6.5368e-04
Loss = 2.7399e-03, PNorm = 62.4492, GNorm = 0.7347, lr_0 = 6.4361e-04
Loss = 3.0841e-03, PNorm = 62.5194, GNorm = 0.6598, lr_0 = 6.3370e-04
Loss = 2.7885e-03, PNorm = 62.6007, GNorm = 0.3086, lr_0 = 6.2395e-04
Loss = 2.4899e-03, PNorm = 62.6823, GNorm = 0.4554, lr_0 = 6.1434e-04
Validation auc = 0.961408
Epoch 8
Loss = 1.1122e-03, PNorm = 62.7589, GNorm = 0.2402, lr_0 = 6.0488e-04
Loss = 2.1874e-03, PNorm = 62.8305, GNorm = 0.6365, lr_0 = 5.9557e-04
Loss = 2.1655e-03, PNorm = 62.9047, GNorm = 0.5701, lr_0 = 5.8640e-04
Loss = 3.0500e-03, PNorm = 62.9802, GNorm = 0.2599, lr_0 = 5.7737e-04
Loss = 2.7289e-03, PNorm = 63.0497, GNorm = 0.1840, lr_0 = 5.6848e-04
Validation auc = 0.964022
Epoch 9
Loss = 1.7606e-03, PNorm = 63.1296, GNorm = 0.3554, lr_0 = 5.5973e-04
Loss = 2.2012e-03, PNorm = 63.2077, GNorm = 1.1332, lr_0 = 5.5111e-04
Loss = 2.4949e-03, PNorm = 63.2850, GNorm = 0.4156, lr_0 = 5.4263e-04
Loss = 2.5019e-03, PNorm = 63.3674, GNorm = 0.7514, lr_0 = 5.3427e-04
Loss = 2.2920e-03, PNorm = 63.4238, GNorm = 0.6641, lr_0 = 5.2605e-04
Loss = 2.1573e-03, PNorm = 63.5090, GNorm = 0.4486, lr_0 = 5.1795e-04
Validation auc = 0.965560
Epoch 10
Loss = 2.5704e-03, PNorm = 63.5833, GNorm = 2.4867, lr_0 = 5.0997e-04
Loss = 2.0658e-03, PNorm = 63.6419, GNorm = 0.3973, lr_0 = 5.0212e-04
Loss = 2.4111e-03, PNorm = 63.7105, GNorm = 0.5245, lr_0 = 4.9439e-04
Loss = 2.4903e-03, PNorm = 63.7780, GNorm = 0.6918, lr_0 = 4.8678e-04
Loss = 2.2780e-03, PNorm = 63.8310, GNorm = 0.5940, lr_0 = 4.7928e-04
Validation auc = 0.970172
Epoch 11
Loss = 1.8080e-03, PNorm = 63.8973, GNorm = 0.3907, lr_0 = 4.7190e-04
Loss = 2.4476e-03, PNorm = 63.9552, GNorm = 1.1623, lr_0 = 4.6464e-04
Loss = 2.5328e-03, PNorm = 64.0216, GNorm = 0.3189, lr_0 = 4.5749e-04
Loss = 1.8328e-03, PNorm = 64.0828, GNorm = 0.5232, lr_0 = 4.5044e-04
Loss = 2.0683e-03, PNorm = 64.1300, GNorm = 1.4417, lr_0 = 4.4351e-04
Validation auc = 0.969557
Epoch 12
Loss = 2.5104e-03, PNorm = 64.1733, GNorm = 0.1918, lr_0 = 4.3668e-04
Loss = 1.7107e-03, PNorm = 64.2245, GNorm = 0.4683, lr_0 = 4.2996e-04
Loss = 1.8474e-03, PNorm = 64.2776, GNorm = 0.8645, lr_0 = 4.2334e-04
Loss = 1.3944e-03, PNorm = 64.3320, GNorm = 0.7311, lr_0 = 4.1682e-04
Loss = 2.8205e-03, PNorm = 64.3685, GNorm = 0.6373, lr_0 = 4.1040e-04
Validation auc = 0.968173
Epoch 13
Loss = 1.9755e-03, PNorm = 64.4328, GNorm = 0.5171, lr_0 = 4.0408e-04
Loss = 1.5640e-03, PNorm = 64.4738, GNorm = 0.6400, lr_0 = 3.9786e-04
Loss = 1.9453e-03, PNorm = 64.5329, GNorm = 0.7313, lr_0 = 3.9173e-04
Loss = 1.6284e-03, PNorm = 64.5855, GNorm = 0.4991, lr_0 = 3.8570e-04
Loss = 1.6635e-03, PNorm = 64.6336, GNorm = 0.1749, lr_0 = 3.7976e-04
Loss = 2.3069e-03, PNorm = 64.6745, GNorm = 0.5139, lr_0 = 3.7392e-04
Validation auc = 0.969711
Epoch 14
Loss = 2.1328e-03, PNorm = 64.7211, GNorm = 0.3395, lr_0 = 3.6816e-04
Loss = 1.5393e-03, PNorm = 64.7712, GNorm = 0.4891, lr_0 = 3.6249e-04
Loss = 1.8687e-03, PNorm = 64.8185, GNorm = 0.4356, lr_0 = 3.5691e-04
Loss = 1.3597e-03, PNorm = 64.8621, GNorm = 0.5309, lr_0 = 3.5142e-04
Loss = 1.5030e-03, PNorm = 64.8999, GNorm = 0.7559, lr_0 = 3.4601e-04
Validation auc = 0.970326
Epoch 15
Loss = 8.1049e-04, PNorm = 64.9399, GNorm = 0.3006, lr_0 = 3.4068e-04
Loss = 1.3383e-03, PNorm = 64.9763, GNorm = 0.2533, lr_0 = 3.3543e-04
Loss = 1.3909e-03, PNorm = 65.0166, GNorm = 0.3287, lr_0 = 3.3027e-04
Loss = 1.9194e-03, PNorm = 65.0530, GNorm = 0.5049, lr_0 = 3.2518e-04
Loss = 2.0481e-03, PNorm = 65.0980, GNorm = 1.1952, lr_0 = 3.2018e-04
Validation auc = 0.969865
Epoch 16
Loss = 7.5890e-04, PNorm = 65.1389, GNorm = 0.2619, lr_0 = 3.1525e-04
Loss = 1.3243e-03, PNorm = 65.1844, GNorm = 0.6316, lr_0 = 3.1039e-04
Loss = 2.2134e-03, PNorm = 65.2087, GNorm = 0.3160, lr_0 = 3.0562e-04
Loss = 1.4622e-03, PNorm = 65.2535, GNorm = 0.3504, lr_0 = 3.0091e-04
Loss = 1.2942e-03, PNorm = 65.2948, GNorm = 0.3549, lr_0 = 2.9628e-04
Loss = 1.6870e-03, PNorm = 65.3178, GNorm = 0.1326, lr_0 = 2.9172e-04
Validation auc = 0.968635
Epoch 17
Loss = 1.1541e-03, PNorm = 65.3504, GNorm = 0.1742, lr_0 = 2.8722e-04
Loss = 1.7190e-03, PNorm = 65.3755, GNorm = 0.7055, lr_0 = 2.8280e-04
Loss = 1.4746e-03, PNorm = 65.4099, GNorm = 0.3784, lr_0 = 2.7845e-04
Loss = 1.2769e-03, PNorm = 65.4389, GNorm = 0.3945, lr_0 = 2.7416e-04
Loss = 1.3080e-03, PNorm = 65.4712, GNorm = 0.1514, lr_0 = 2.6994e-04
Validation auc = 0.968788
Epoch 18
Loss = 1.6626e-03, PNorm = 65.5009, GNorm = 0.9132, lr_0 = 2.6578e-04
Loss = 1.5162e-03, PNorm = 65.5368, GNorm = 0.4917, lr_0 = 2.6169e-04
Loss = 9.6554e-04, PNorm = 65.5766, GNorm = 0.1788, lr_0 = 2.5766e-04
Loss = 1.1071e-03, PNorm = 65.6103, GNorm = 0.0711, lr_0 = 2.5370e-04
Loss = 1.4806e-03, PNorm = 65.6269, GNorm = 2.2073, lr_0 = 2.4979e-04
Validation auc = 0.969403
Epoch 19
Loss = 2.2544e-03, PNorm = 65.6569, GNorm = 0.5714, lr_0 = 2.4594e-04
Loss = 9.6932e-04, PNorm = 65.7056, GNorm = 0.6140, lr_0 = 2.4216e-04
Loss = 9.5402e-04, PNorm = 65.7258, GNorm = 0.4200, lr_0 = 2.3843e-04
Loss = 1.0748e-03, PNorm = 65.7515, GNorm = 0.8934, lr_0 = 2.3476e-04
Loss = 1.3635e-03, PNorm = 65.7755, GNorm = 0.3411, lr_0 = 2.3114e-04
Loss = 1.6039e-03, PNorm = 65.8051, GNorm = 0.5174, lr_0 = 2.2758e-04
Validation auc = 0.969711
Epoch 20
Loss = 1.2303e-03, PNorm = 65.8280, GNorm = 0.6954, lr_0 = 2.2408e-04
Loss = 1.0083e-03, PNorm = 65.8566, GNorm = 0.1160, lr_0 = 2.2063e-04
Loss = 1.3839e-03, PNorm = 65.8754, GNorm = 0.9333, lr_0 = 2.1723e-04
Loss = 1.0844e-03, PNorm = 65.8960, GNorm = 0.7219, lr_0 = 2.1389e-04
Loss = 1.3676e-03, PNorm = 65.9241, GNorm = 0.6662, lr_0 = 2.1060e-04
Validation auc = 0.974016
Epoch 21
Loss = 1.4464e-03, PNorm = 65.9364, GNorm = 1.4156, lr_0 = 2.0735e-04
Loss = 1.2585e-03, PNorm = 65.9718, GNorm = 0.6067, lr_0 = 2.0416e-04
Loss = 7.0027e-04, PNorm = 65.9962, GNorm = 0.2958, lr_0 = 2.0102e-04
Loss = 1.2779e-03, PNorm = 66.0172, GNorm = 0.1486, lr_0 = 1.9792e-04
Loss = 1.3113e-03, PNorm = 66.0296, GNorm = 0.5460, lr_0 = 1.9488e-04
Validation auc = 0.972325
Epoch 22
Loss = 1.1191e-03, PNorm = 66.0453, GNorm = 0.8811, lr_0 = 1.9188e-04
Loss = 7.7134e-04, PNorm = 66.0644, GNorm = 0.1676, lr_0 = 1.8892e-04
Loss = 1.1497e-03, PNorm = 66.0800, GNorm = 0.3340, lr_0 = 1.8601e-04
Loss = 1.3107e-03, PNorm = 66.0901, GNorm = 0.8611, lr_0 = 1.8315e-04
Loss = 6.8793e-04, PNorm = 66.1085, GNorm = 0.4199, lr_0 = 1.8033e-04
Validation auc = 0.970172
Epoch 23
Loss = 7.4951e-04, PNorm = 66.1273, GNorm = 0.6522, lr_0 = 1.7755e-04
Loss = 9.2669e-04, PNorm = 66.1500, GNorm = 0.1231, lr_0 = 1.7482e-04
Loss = 9.1189e-04, PNorm = 66.1647, GNorm = 0.7307, lr_0 = 1.7213e-04
Loss = 8.9530e-04, PNorm = 66.1806, GNorm = 0.5810, lr_0 = 1.6948e-04
Loss = 8.5470e-04, PNorm = 66.1933, GNorm = 0.5785, lr_0 = 1.6687e-04
Loss = 6.9256e-04, PNorm = 66.2124, GNorm = 0.6621, lr_0 = 1.6430e-04
Validation auc = 0.972171
Epoch 24
Loss = 6.9566e-04, PNorm = 66.2236, GNorm = 0.8571, lr_0 = 1.6177e-04
Loss = 9.6612e-04, PNorm = 66.2368, GNorm = 0.6756, lr_0 = 1.5928e-04
Loss = 8.6649e-04, PNorm = 66.2585, GNorm = 0.9083, lr_0 = 1.5683e-04
Loss = 8.0227e-04, PNorm = 66.2719, GNorm = 0.2362, lr_0 = 1.5441e-04
Loss = 1.0031e-03, PNorm = 66.2848, GNorm = 0.9612, lr_0 = 1.5203e-04
Validation auc = 0.968481
Epoch 25
Loss = 6.7181e-04, PNorm = 66.3012, GNorm = 0.2176, lr_0 = 1.4969e-04
Loss = 8.7922e-04, PNorm = 66.3114, GNorm = 0.7254, lr_0 = 1.4739e-04
Loss = 6.8836e-04, PNorm = 66.3185, GNorm = 0.4221, lr_0 = 1.4512e-04
Loss = 1.0243e-03, PNorm = 66.3348, GNorm = 1.0396, lr_0 = 1.4288e-04
Loss = 9.5949e-04, PNorm = 66.3437, GNorm = 0.5424, lr_0 = 1.4069e-04
Validation auc = 0.969403
Epoch 26
Loss = 3.2423e-04, PNorm = 66.3563, GNorm = 0.1542, lr_0 = 1.3852e-04
Loss = 4.4586e-04, PNorm = 66.3712, GNorm = 0.8019, lr_0 = 1.3639e-04
Loss = 8.8809e-04, PNorm = 66.3792, GNorm = 0.3532, lr_0 = 1.3429e-04
Loss = 8.2574e-04, PNorm = 66.3930, GNorm = 1.5862, lr_0 = 1.3222e-04
Loss = 8.3930e-04, PNorm = 66.3961, GNorm = 0.6211, lr_0 = 1.3018e-04
Loss = 1.0161e-03, PNorm = 66.4086, GNorm = 1.0614, lr_0 = 1.2818e-04
Validation auc = 0.969403
Epoch 27
Loss = 8.7520e-04, PNorm = 66.4199, GNorm = 0.6055, lr_0 = 1.2621e-04
Loss = 5.1244e-04, PNorm = 66.4277, GNorm = 0.6296, lr_0 = 1.2426e-04
Loss = 7.2133e-04, PNorm = 66.4401, GNorm = 1.3326, lr_0 = 1.2235e-04
Loss = 6.8577e-04, PNorm = 66.4505, GNorm = 0.7118, lr_0 = 1.2047e-04
Loss = 6.9832e-04, PNorm = 66.4554, GNorm = 0.1165, lr_0 = 1.1861e-04
Validation auc = 0.969557
Epoch 28
Loss = 8.4726e-04, PNorm = 66.4648, GNorm = 0.6642, lr_0 = 1.1678e-04
Loss = 8.0206e-04, PNorm = 66.4702, GNorm = 0.5964, lr_0 = 1.1499e-04
Loss = 9.2249e-04, PNorm = 66.4816, GNorm = 1.7090, lr_0 = 1.1322e-04
Loss = 8.9155e-04, PNorm = 66.4858, GNorm = 0.7372, lr_0 = 1.1147e-04
Loss = 5.8386e-04, PNorm = 66.4945, GNorm = 0.0615, lr_0 = 1.0976e-04
Validation auc = 0.970172
Epoch 29
Loss = 5.1738e-04, PNorm = 66.5028, GNorm = 0.1284, lr_0 = 1.0807e-04
Loss = 6.3390e-04, PNorm = 66.5137, GNorm = 0.1153, lr_0 = 1.0640e-04
Loss = 6.2568e-04, PNorm = 66.5230, GNorm = 0.5871, lr_0 = 1.0476e-04
Loss = 6.6241e-04, PNorm = 66.5279, GNorm = 0.6726, lr_0 = 1.0315e-04
Loss = 8.6499e-04, PNorm = 66.5367, GNorm = 0.5904, lr_0 = 1.0156e-04
Loss = 7.7798e-04, PNorm = 66.5404, GNorm = 0.0858, lr_0 = 1.0000e-04
Validation auc = 0.970326
Model 0 best validation auc = 0.974016 on epoch 20
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test auc = nan
Ensemble test auc = nan
Fold 16
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': '../../../swansonk/chemprop_ckpt/0406_inhibition_hyperopt.json',
 'cuda': True,
 'data_path': '../../broad2/larger_dataset/0405_inhibition_dedup_binary.csv',
 'dataset_type': 'classification',
 'depth': 5,
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_dim': 200,
 'features_generator': None,
 'features_only': False,
 'features_path': ['../../saved_features/0405_broad_inhibition.npz'],
 'features_scaling': False,
 'features_size': 200,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 1600,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'no_cache': False,
 'num_folds': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'output_size': 1,
 'quiet': True,
 'save_dir': '../ckpt/0405_broad_inhibition_20folds/fold_16',
 'save_smiles_splits': False,
 'seed': 16,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'task_names': ['50uM_Inhibition'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 2654,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': ['../../saved_features/0405_broad_inhibition.npz'],
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 16
Class sizes
50uM_Inhibition 0: 91.93%, 1: 8.07%
Total size = 2,949 | train size = 2,654 | val size = 295 | test size = 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1600, bias=False)
      (W_h): Linear(in_features=1600, out_features=1600, bias=False)
      (W_o): Linear(in_features=1733, out_features=1600, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,571,401
Moving model to cuda
Epoch 0
Loss = 7.3262e-03, PNorm = 59.4720, GNorm = 0.9023, lr_0 = 1.8491e-04
Loss = 6.3967e-03, PNorm = 59.4867, GNorm = 0.7762, lr_0 = 2.6981e-04
Loss = 5.7683e-03, PNorm = 59.5077, GNorm = 0.4604, lr_0 = 3.5472e-04
Loss = 5.5187e-03, PNorm = 59.5353, GNorm = 0.4437, lr_0 = 4.3962e-04
Loss = 4.4620e-03, PNorm = 59.5684, GNorm = 0.5860, lr_0 = 5.2453e-04
Validation auc = 0.759344
Epoch 1
Loss = 4.9398e-03, PNorm = 59.6159, GNorm = 0.5165, lr_0 = 6.0943e-04
Loss = 4.9160e-03, PNorm = 59.6734, GNorm = 0.3118, lr_0 = 6.9434e-04
Loss = 4.8034e-03, PNorm = 59.7464, GNorm = 0.3555, lr_0 = 7.7925e-04
Loss = 5.1893e-03, PNorm = 59.8296, GNorm = 1.0772, lr_0 = 8.6415e-04
Loss = 5.2766e-03, PNorm = 59.9343, GNorm = 0.5094, lr_0 = 9.4906e-04
Validation auc = 0.788520
Epoch 2
Loss = 3.9163e-03, PNorm = 60.0527, GNorm = 0.3815, lr_0 = 9.9381e-04
Loss = 3.4624e-03, PNorm = 60.1590, GNorm = 0.4222, lr_0 = 9.7851e-04
Loss = 5.0138e-03, PNorm = 60.2604, GNorm = 0.3193, lr_0 = 9.6345e-04
Loss = 4.2020e-03, PNorm = 60.3808, GNorm = 0.7951, lr_0 = 9.4861e-04
Loss = 5.3287e-03, PNorm = 60.4754, GNorm = 0.3773, lr_0 = 9.3401e-04
Validation auc = 0.778986
Epoch 3
Loss = 3.7543e-03, PNorm = 60.5717, GNorm = 0.7705, lr_0 = 9.1963e-04
Loss = 3.7601e-03, PNorm = 60.6508, GNorm = 0.2869, lr_0 = 9.0547e-04
Loss = 3.7070e-03, PNorm = 60.7305, GNorm = 0.4081, lr_0 = 8.9153e-04
Loss = 4.0703e-03, PNorm = 60.8229, GNorm = 0.4515, lr_0 = 8.7780e-04
Loss = 3.9993e-03, PNorm = 60.9290, GNorm = 0.8776, lr_0 = 8.6429e-04
Loss = 3.7794e-03, PNorm = 61.0413, GNorm = 0.5861, lr_0 = 8.5098e-04
Validation auc = 0.774409
Epoch 4
Loss = 4.3209e-03, PNorm = 61.1313, GNorm = 0.2941, lr_0 = 8.3788e-04
Loss = 3.4588e-03, PNorm = 61.2228, GNorm = 0.6962, lr_0 = 8.2498e-04
Loss = 3.9816e-03, PNorm = 61.3081, GNorm = 0.5680, lr_0 = 8.1228e-04
Loss = 3.6732e-03, PNorm = 61.3929, GNorm = 0.4808, lr_0 = 7.9977e-04
Loss = 2.6566e-03, PNorm = 61.4855, GNorm = 0.2837, lr_0 = 7.8746e-04
Validation auc = 0.811785
Epoch 5
Loss = 2.8558e-03, PNorm = 61.5610, GNorm = 0.7074, lr_0 = 7.7533e-04
Loss = 3.3296e-03, PNorm = 61.6447, GNorm = 0.4622, lr_0 = 7.6340e-04
Loss = 3.7039e-03, PNorm = 61.7417, GNorm = 0.6400, lr_0 = 7.5164e-04
Loss = 3.2284e-03, PNorm = 61.8483, GNorm = 0.3124, lr_0 = 7.4007e-04
Loss = 2.4493e-03, PNorm = 61.9683, GNorm = 0.3720, lr_0 = 7.2867e-04
Validation auc = 0.827994
Epoch 6
Loss = 4.0671e-03, PNorm = 62.0635, GNorm = 0.7077, lr_0 = 7.1746e-04
Loss = 2.6432e-03, PNorm = 62.1736, GNorm = 0.3241, lr_0 = 7.0641e-04
Loss = 3.0150e-03, PNorm = 62.2937, GNorm = 0.4418, lr_0 = 6.9553e-04
Loss = 2.6392e-03, PNorm = 62.3977, GNorm = 0.5237, lr_0 = 6.8482e-04
Loss = 2.6992e-03, PNorm = 62.4701, GNorm = 0.5715, lr_0 = 6.7428e-04
Loss = 2.8982e-03, PNorm = 62.5345, GNorm = 0.8331, lr_0 = 6.6390e-04
Validation auc = 0.850686
Epoch 7
Loss = 2.4795e-03, PNorm = 62.6266, GNorm = 0.8181, lr_0 = 6.5368e-04
Loss = 2.7199e-03, PNorm = 62.7281, GNorm = 0.3213, lr_0 = 6.4361e-04
Loss = 2.9562e-03, PNorm = 62.8272, GNorm = 0.3850, lr_0 = 6.3370e-04
Loss = 2.5935e-03, PNorm = 62.9253, GNorm = 0.3126, lr_0 = 6.2395e-04
Loss = 3.1114e-03, PNorm = 62.9938, GNorm = 0.8595, lr_0 = 6.1434e-04
Validation auc = 0.866133
Epoch 8
Loss = 2.1661e-03, PNorm = 63.0629, GNorm = 0.4536, lr_0 = 6.0488e-04
Loss = 2.1623e-03, PNorm = 63.1444, GNorm = 0.4768, lr_0 = 5.9557e-04
Loss = 3.0808e-03, PNorm = 63.2075, GNorm = 0.8823, lr_0 = 5.8640e-04
Loss = 2.7092e-03, PNorm = 63.2925, GNorm = 0.8333, lr_0 = 5.7737e-04
Loss = 2.2985e-03, PNorm = 63.3820, GNorm = 0.4054, lr_0 = 5.6848e-04
Validation auc = 0.856598
Epoch 9
Loss = 2.3324e-03, PNorm = 63.4519, GNorm = 0.7899, lr_0 = 5.5973e-04
Loss = 2.7664e-03, PNorm = 63.5248, GNorm = 0.8187, lr_0 = 5.5111e-04
Loss = 2.5531e-03, PNorm = 63.5995, GNorm = 0.2694, lr_0 = 5.4263e-04
Loss = 2.3018e-03, PNorm = 63.6707, GNorm = 0.8945, lr_0 = 5.3427e-04
Loss = 2.3001e-03, PNorm = 63.7656, GNorm = 0.2570, lr_0 = 5.2605e-04
Loss = 2.3134e-03, PNorm = 63.8307, GNorm = 0.9132, lr_0 = 5.1795e-04
Validation auc = 0.859268
Epoch 10
Loss = 2.2409e-03, PNorm = 63.9004, GNorm = 0.6747, lr_0 = 5.0997e-04
Loss = 1.8741e-03, PNorm = 63.9703, GNorm = 0.2346, lr_0 = 5.0212e-04
Loss = 1.6918e-03, PNorm = 64.0355, GNorm = 0.3628, lr_0 = 4.9439e-04
Loss = 2.6580e-03, PNorm = 64.0839, GNorm = 0.3232, lr_0 = 4.8678e-04
Loss = 2.0830e-03, PNorm = 64.1402, GNorm = 0.3980, lr_0 = 4.7928e-04
Validation auc = 0.889397
Epoch 11
Loss = 1.9044e-03, PNorm = 64.2115, GNorm = 0.5373, lr_0 = 4.7190e-04
Loss = 1.0405e-03, PNorm = 64.2658, GNorm = 0.3198, lr_0 = 4.6464e-04
Loss = 2.0752e-03, PNorm = 64.3224, GNorm = 0.4390, lr_0 = 4.5749e-04
Loss = 2.3020e-03, PNorm = 64.3875, GNorm = 0.3111, lr_0 = 4.5044e-04
Loss = 2.3260e-03, PNorm = 64.4520, GNorm = 0.2162, lr_0 = 4.4351e-04
Validation auc = 0.863463
Epoch 12
Loss = 2.3143e-03, PNorm = 64.5079, GNorm = 0.5618, lr_0 = 4.3668e-04
Loss = 2.2702e-03, PNorm = 64.5567, GNorm = 0.3484, lr_0 = 4.2996e-04
Loss = 1.8820e-03, PNorm = 64.6211, GNorm = 0.3450, lr_0 = 4.2334e-04
Loss = 2.3057e-03, PNorm = 64.6647, GNorm = 0.4257, lr_0 = 4.1682e-04
Loss = 1.6446e-03, PNorm = 64.7171, GNorm = 0.7216, lr_0 = 4.1040e-04
Validation auc = 0.884439
Epoch 13
Loss = 9.2464e-04, PNorm = 64.7568, GNorm = 0.3956, lr_0 = 4.0408e-04
Loss = 1.4515e-03, PNorm = 64.8111, GNorm = 0.3633, lr_0 = 3.9786e-04
Loss = 1.5376e-03, PNorm = 64.8630, GNorm = 1.0578, lr_0 = 3.9173e-04
Loss = 2.0278e-03, PNorm = 64.8954, GNorm = 1.2668, lr_0 = 3.8570e-04
Loss = 2.3590e-03, PNorm = 64.9598, GNorm = 0.3970, lr_0 = 3.7976e-04
Loss = 1.5390e-03, PNorm = 65.0115, GNorm = 0.7135, lr_0 = 3.7392e-04
Validation auc = 0.887300
Epoch 14
Loss = 1.6233e-03, PNorm = 65.0610, GNorm = 0.2503, lr_0 = 3.6816e-04
Loss = 2.0993e-03, PNorm = 65.1071, GNorm = 0.2939, lr_0 = 3.6249e-04
Loss = 1.4674e-03, PNorm = 65.1538, GNorm = 0.4313, lr_0 = 3.5691e-04
Loss = 1.2459e-03, PNorm = 65.1810, GNorm = 0.7986, lr_0 = 3.5142e-04
Loss = 1.5908e-03, PNorm = 65.2189, GNorm = 0.4127, lr_0 = 3.4601e-04
Validation auc = 0.887109
Epoch 15
Loss = 1.6873e-03, PNorm = 65.2567, GNorm = 0.4821, lr_0 = 3.4068e-04
Loss = 1.7924e-03, PNorm = 65.3163, GNorm = 0.1836, lr_0 = 3.3543e-04
Loss = 1.6214e-03, PNorm = 65.3653, GNorm = 0.8030, lr_0 = 3.3027e-04
Loss = 1.7183e-03, PNorm = 65.4026, GNorm = 0.8608, lr_0 = 3.2518e-04
Loss = 1.1025e-03, PNorm = 65.4440, GNorm = 0.2992, lr_0 = 3.2018e-04
Validation auc = 0.886537
Epoch 16
Loss = 2.5133e-03, PNorm = 65.4698, GNorm = 0.6102, lr_0 = 3.1525e-04
Loss = 1.4539e-03, PNorm = 65.5178, GNorm = 0.2597, lr_0 = 3.1039e-04
Loss = 1.1107e-03, PNorm = 65.5577, GNorm = 0.3344, lr_0 = 3.0562e-04
Loss = 1.6343e-03, PNorm = 65.6139, GNorm = 1.1084, lr_0 = 3.0091e-04
Loss = 1.7447e-03, PNorm = 65.6408, GNorm = 0.2946, lr_0 = 2.9628e-04
Loss = 1.4674e-03, PNorm = 65.6719, GNorm = 0.3983, lr_0 = 2.9172e-04
Validation auc = 0.889588
Epoch 17
Loss = 1.2562e-03, PNorm = 65.7199, GNorm = 1.0177, lr_0 = 2.8722e-04
Loss = 9.8652e-04, PNorm = 65.7494, GNorm = 0.3801, lr_0 = 2.8280e-04
Loss = 1.2529e-03, PNorm = 65.7872, GNorm = 0.4463, lr_0 = 2.7845e-04
Loss = 1.1038e-03, PNorm = 65.8200, GNorm = 0.1875, lr_0 = 2.7416e-04
Loss = 1.5822e-03, PNorm = 65.8455, GNorm = 0.3611, lr_0 = 2.6994e-04
Validation auc = 0.898360
Epoch 18
Loss = 1.4046e-03, PNorm = 65.8729, GNorm = 0.4503, lr_0 = 2.6578e-04
Loss = 1.0845e-03, PNorm = 65.9151, GNorm = 0.2269, lr_0 = 2.6169e-04
Loss = 1.1428e-03, PNorm = 65.9472, GNorm = 0.4639, lr_0 = 2.5766e-04
Loss = 1.7971e-03, PNorm = 65.9771, GNorm = 0.9157, lr_0 = 2.5370e-04
Loss = 8.7541e-04, PNorm = 66.0125, GNorm = 0.4338, lr_0 = 2.4979e-04
Validation auc = 0.897788
Epoch 19
Loss = 9.9165e-04, PNorm = 66.0287, GNorm = 0.9026, lr_0 = 2.4594e-04
Loss = 1.1397e-03, PNorm = 66.0597, GNorm = 0.3427, lr_0 = 2.4216e-04
Loss = 6.7119e-04, PNorm = 66.0875, GNorm = 0.2481, lr_0 = 2.3843e-04
Loss = 1.0075e-03, PNorm = 66.1129, GNorm = 0.1368, lr_0 = 2.3476e-04
Loss = 1.3829e-03, PNorm = 66.1386, GNorm = 0.4498, lr_0 = 2.3114e-04
Loss = 1.1599e-03, PNorm = 66.1599, GNorm = 0.1277, lr_0 = 2.2758e-04
Validation auc = 0.894355
Epoch 20
Loss = 4.9087e-04, PNorm = 66.1818, GNorm = 0.3328, lr_0 = 2.2408e-04
Loss = 1.2191e-03, PNorm = 66.2032, GNorm = 0.5639, lr_0 = 2.2063e-04
Loss = 1.0833e-03, PNorm = 66.2236, GNorm = 0.1803, lr_0 = 2.1723e-04
Loss = 1.6913e-03, PNorm = 66.2541, GNorm = 0.1652, lr_0 = 2.1389e-04
Loss = 1.2378e-03, PNorm = 66.2795, GNorm = 1.0107, lr_0 = 2.1060e-04
Validation auc = 0.889016
Epoch 21
Loss = 8.9502e-04, PNorm = 66.2932, GNorm = 0.6616, lr_0 = 2.0735e-04
Loss = 1.1889e-03, PNorm = 66.3276, GNorm = 0.2977, lr_0 = 2.0416e-04
Loss = 1.0632e-03, PNorm = 66.3483, GNorm = 0.5816, lr_0 = 2.0102e-04
Loss = 9.8849e-04, PNorm = 66.3639, GNorm = 0.6111, lr_0 = 1.9792e-04
Loss = 1.3185e-03, PNorm = 66.3961, GNorm = 0.0770, lr_0 = 1.9488e-04
Validation auc = 0.886728
Epoch 22
Loss = 1.0325e-03, PNorm = 66.4141, GNorm = 0.6549, lr_0 = 1.9188e-04
Loss = 8.8047e-04, PNorm = 66.4360, GNorm = 0.1335, lr_0 = 1.8892e-04
Loss = 9.2390e-04, PNorm = 66.4597, GNorm = 0.4301, lr_0 = 1.8601e-04
Loss = 1.3526e-03, PNorm = 66.4722, GNorm = 0.9272, lr_0 = 1.8315e-04
Loss = 9.3773e-04, PNorm = 66.5071, GNorm = 0.1483, lr_0 = 1.8033e-04
Validation auc = 0.898551
Epoch 23
Loss = 9.4882e-05, PNorm = 66.5204, GNorm = 0.0774, lr_0 = 1.7755e-04
Loss = 1.0954e-03, PNorm = 66.5376, GNorm = 0.5898, lr_0 = 1.7482e-04
Loss = 6.3882e-04, PNorm = 66.5535, GNorm = 0.1703, lr_0 = 1.7213e-04
Loss = 4.7299e-04, PNorm = 66.5682, GNorm = 0.1708, lr_0 = 1.6948e-04
Loss = 1.0266e-03, PNorm = 66.5755, GNorm = 0.7740, lr_0 = 1.6687e-04
Loss = 1.2165e-03, PNorm = 66.5913, GNorm = 0.3297, lr_0 = 1.6430e-04
Validation auc = 0.898551
Epoch 24
Loss = 4.3356e-04, PNorm = 66.6067, GNorm = 0.2025, lr_0 = 1.6177e-04
Loss = 9.4266e-04, PNorm = 66.6169, GNorm = 0.3177, lr_0 = 1.5928e-04
Loss = 9.0748e-04, PNorm = 66.6375, GNorm = 0.4702, lr_0 = 1.5683e-04
Loss = 1.1638e-03, PNorm = 66.6433, GNorm = 0.0747, lr_0 = 1.5441e-04
Loss = 5.6799e-04, PNorm = 66.6572, GNorm = 0.5422, lr_0 = 1.5203e-04
Validation auc = 0.903509
Epoch 25
Loss = 1.0836e-03, PNorm = 66.6707, GNorm = 0.5717, lr_0 = 1.4969e-04
Loss = 5.9274e-04, PNorm = 66.6810, GNorm = 0.7894, lr_0 = 1.4739e-04
Loss = 7.3033e-04, PNorm = 66.6936, GNorm = 0.2955, lr_0 = 1.4512e-04
Loss = 8.0888e-04, PNorm = 66.7069, GNorm = 1.2922, lr_0 = 1.4288e-04
Loss = 4.8833e-04, PNorm = 66.7134, GNorm = 1.0380, lr_0 = 1.4069e-04
Validation auc = 0.894165
Epoch 26
Loss = 8.9395e-04, PNorm = 66.7249, GNorm = 0.7405, lr_0 = 1.3852e-04
Loss = 6.0018e-04, PNorm = 66.7329, GNorm = 0.6259, lr_0 = 1.3639e-04
Loss = 9.0110e-04, PNorm = 66.7440, GNorm = 1.2018, lr_0 = 1.3429e-04
Loss = 6.3208e-04, PNorm = 66.7618, GNorm = 0.6432, lr_0 = 1.3222e-04
Loss = 6.0553e-04, PNorm = 66.7702, GNorm = 0.2889, lr_0 = 1.3018e-04
Loss = 8.1493e-04, PNorm = 66.7819, GNorm = 1.8433, lr_0 = 1.2818e-04
Validation auc = 0.894355
Epoch 27
Loss = 4.4796e-04, PNorm = 66.7946, GNorm = 0.3115, lr_0 = 1.2621e-04
Loss = 9.1994e-04, PNorm = 66.8012, GNorm = 0.6464, lr_0 = 1.2426e-04
Loss = 4.8298e-04, PNorm = 66.8159, GNorm = 0.5251, lr_0 = 1.2235e-04
Loss = 7.8547e-04, PNorm = 66.8191, GNorm = 0.2687, lr_0 = 1.2047e-04
Loss = 1.3900e-03, PNorm = 66.8282, GNorm = 0.8396, lr_0 = 1.1861e-04
Validation auc = 0.903127
Epoch 28
Loss = 5.8295e-04, PNorm = 66.8430, GNorm = 0.7463, lr_0 = 1.1678e-04
Loss = 6.1425e-04, PNorm = 66.8498, GNorm = 0.0182, lr_0 = 1.1499e-04
Loss = 5.3634e-04, PNorm = 66.8560, GNorm = 0.2137, lr_0 = 1.1322e-04
Loss = 6.4139e-04, PNorm = 66.8665, GNorm = 0.8027, lr_0 = 1.1147e-04
Loss = 8.7641e-04, PNorm = 66.8752, GNorm = 0.0573, lr_0 = 1.0976e-04
Validation auc = 0.902174
Epoch 29
Loss = 6.3229e-04, PNorm = 66.8818, GNorm = 0.5290, lr_0 = 1.0807e-04
Loss = 4.3886e-04, PNorm = 66.8886, GNorm = 0.3197, lr_0 = 1.0640e-04
Loss = 7.8423e-04, PNorm = 66.8977, GNorm = 0.5108, lr_0 = 1.0476e-04
Loss = 1.0101e-03, PNorm = 66.9075, GNorm = 1.1632, lr_0 = 1.0315e-04
Loss = 7.5510e-04, PNorm = 66.9153, GNorm = 0.3140, lr_0 = 1.0156e-04
Loss = 4.0335e-04, PNorm = 66.9211, GNorm = 0.4893, lr_0 = 1.0000e-04
Validation auc = 0.900839
Model 0 best validation auc = 0.903509 on epoch 24
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test auc = nan
Ensemble test auc = nan
Fold 17
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': '../../../swansonk/chemprop_ckpt/0406_inhibition_hyperopt.json',
 'cuda': True,
 'data_path': '../../broad2/larger_dataset/0405_inhibition_dedup_binary.csv',
 'dataset_type': 'classification',
 'depth': 5,
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_dim': 200,
 'features_generator': None,
 'features_only': False,
 'features_path': ['../../saved_features/0405_broad_inhibition.npz'],
 'features_scaling': False,
 'features_size': 200,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 1600,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'no_cache': False,
 'num_folds': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'output_size': 1,
 'quiet': True,
 'save_dir': '../ckpt/0405_broad_inhibition_20folds/fold_17',
 'save_smiles_splits': False,
 'seed': 17,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'task_names': ['50uM_Inhibition'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 2654,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': ['../../saved_features/0405_broad_inhibition.npz'],
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 17
Class sizes
50uM_Inhibition 0: 91.93%, 1: 8.07%
Total size = 2,949 | train size = 2,654 | val size = 295 | test size = 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1600, bias=False)
      (W_h): Linear(in_features=1600, out_features=1600, bias=False)
      (W_o): Linear(in_features=1733, out_features=1600, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,571,401
Moving model to cuda
Epoch 0
Loss = 9.3625e-03, PNorm = 59.4489, GNorm = 0.7503, lr_0 = 1.8491e-04
Loss = 5.0508e-03, PNorm = 59.4654, GNorm = 0.3692, lr_0 = 2.6981e-04
Loss = 6.2388e-03, PNorm = 59.4790, GNorm = 0.3879, lr_0 = 3.5472e-04
Loss = 5.4706e-03, PNorm = 59.4976, GNorm = 0.4443, lr_0 = 4.3962e-04
Loss = 6.0299e-03, PNorm = 59.5186, GNorm = 0.3608, lr_0 = 5.2453e-04
Validation auc = 0.781969
Epoch 1
Loss = 6.0427e-03, PNorm = 59.5459, GNorm = 0.6297, lr_0 = 6.0943e-04
Loss = 5.2819e-03, PNorm = 59.5902, GNorm = 0.3325, lr_0 = 6.9434e-04
Loss = 5.0871e-03, PNorm = 59.6410, GNorm = 0.3388, lr_0 = 7.7925e-04
Loss = 4.2552e-03, PNorm = 59.7140, GNorm = 0.3390, lr_0 = 8.6415e-04
Loss = 5.8140e-03, PNorm = 59.8094, GNorm = 0.2478, lr_0 = 9.4906e-04
Validation auc = 0.895460
Epoch 2
Loss = 4.4353e-03, PNorm = 59.9427, GNorm = 0.6330, lr_0 = 9.9381e-04
Loss = 5.7189e-03, PNorm = 60.0461, GNorm = 0.4877, lr_0 = 9.7851e-04
Loss = 4.5178e-03, PNorm = 60.1319, GNorm = 0.4672, lr_0 = 9.6345e-04
Loss = 5.6874e-03, PNorm = 60.2129, GNorm = 0.3606, lr_0 = 9.4861e-04
Loss = 4.2710e-03, PNorm = 60.2837, GNorm = 0.3625, lr_0 = 9.3401e-04
Validation auc = 0.931426
Epoch 3
Loss = 5.5297e-03, PNorm = 60.3459, GNorm = 0.6507, lr_0 = 9.1963e-04
Loss = 4.2081e-03, PNorm = 60.4254, GNorm = 0.6283, lr_0 = 9.0547e-04
Loss = 3.3965e-03, PNorm = 60.5062, GNorm = 0.3967, lr_0 = 8.9153e-04
Loss = 4.6576e-03, PNorm = 60.6039, GNorm = 0.4399, lr_0 = 8.7780e-04
Loss = 4.3579e-03, PNorm = 60.6816, GNorm = 0.3472, lr_0 = 8.6429e-04
Loss = 4.4726e-03, PNorm = 60.7745, GNorm = 0.8937, lr_0 = 8.5098e-04
Validation auc = 0.929827
Epoch 4
Loss = 4.3567e-03, PNorm = 60.8797, GNorm = 0.5852, lr_0 = 8.3788e-04
Loss = 3.3795e-03, PNorm = 60.9775, GNorm = 0.4648, lr_0 = 8.2498e-04
Loss = 4.3981e-03, PNorm = 61.0488, GNorm = 0.6638, lr_0 = 8.1228e-04
Loss = 3.1442e-03, PNorm = 61.1100, GNorm = 0.8632, lr_0 = 7.9977e-04
Loss = 3.9255e-03, PNorm = 61.1769, GNorm = 0.4253, lr_0 = 7.8746e-04
Validation auc = 0.946611
Epoch 5
Loss = 3.7915e-03, PNorm = 61.2600, GNorm = 1.0533, lr_0 = 7.7533e-04
Loss = 2.9286e-03, PNorm = 61.3493, GNorm = 0.6715, lr_0 = 7.6340e-04
Loss = 4.1163e-03, PNorm = 61.4204, GNorm = 0.3078, lr_0 = 7.5164e-04
Loss = 3.7327e-03, PNorm = 61.4992, GNorm = 0.4490, lr_0 = 7.4007e-04
Loss = 3.0755e-03, PNorm = 61.5831, GNorm = 0.7806, lr_0 = 7.2867e-04
Validation auc = 0.933024
Epoch 6
Loss = 1.6497e-03, PNorm = 61.6917, GNorm = 0.7316, lr_0 = 7.1746e-04
Loss = 2.9449e-03, PNorm = 61.7823, GNorm = 0.9013, lr_0 = 7.0641e-04
Loss = 3.6813e-03, PNorm = 61.8760, GNorm = 0.4415, lr_0 = 6.9553e-04
Loss = 3.3831e-03, PNorm = 61.9698, GNorm = 0.5083, lr_0 = 6.8482e-04
Loss = 3.2475e-03, PNorm = 62.0434, GNorm = 0.4748, lr_0 = 6.7428e-04
Loss = 2.1641e-03, PNorm = 62.1105, GNorm = 0.5490, lr_0 = 6.6390e-04
Validation auc = 0.956202
Epoch 7
Loss = 3.1512e-03, PNorm = 62.1720, GNorm = 0.4246, lr_0 = 6.5368e-04
Loss = 2.0995e-03, PNorm = 62.2576, GNorm = 0.2614, lr_0 = 6.4361e-04
Loss = 3.0686e-03, PNorm = 62.3196, GNorm = 0.3675, lr_0 = 6.3370e-04
Loss = 3.5548e-03, PNorm = 62.4002, GNorm = 1.5643, lr_0 = 6.2395e-04
Loss = 2.5046e-03, PNorm = 62.4922, GNorm = 0.5479, lr_0 = 6.1434e-04
Validation auc = 0.964514
Epoch 8
Loss = 2.0030e-03, PNorm = 62.5840, GNorm = 0.2438, lr_0 = 6.0488e-04
Loss = 3.1641e-03, PNorm = 62.6518, GNorm = 0.3310, lr_0 = 5.9557e-04
Loss = 3.3179e-03, PNorm = 62.7097, GNorm = 0.4554, lr_0 = 5.8640e-04
Loss = 3.2232e-03, PNorm = 62.8069, GNorm = 0.2684, lr_0 = 5.7737e-04
Loss = 2.7809e-03, PNorm = 62.8731, GNorm = 0.3257, lr_0 = 5.6848e-04
Validation auc = 0.958120
Epoch 9
Loss = 1.7042e-03, PNorm = 62.9436, GNorm = 0.7592, lr_0 = 5.5973e-04
Loss = 2.9399e-03, PNorm = 62.9999, GNorm = 0.6996, lr_0 = 5.5111e-04
Loss = 1.8330e-03, PNorm = 63.0575, GNorm = 0.7581, lr_0 = 5.4263e-04
Loss = 2.5879e-03, PNorm = 63.1079, GNorm = 0.4091, lr_0 = 5.3427e-04
Loss = 2.6468e-03, PNorm = 63.1719, GNorm = 0.2773, lr_0 = 5.2605e-04
Loss = 1.7063e-03, PNorm = 63.2189, GNorm = 0.4482, lr_0 = 5.1795e-04
Validation auc = 0.942136
Epoch 10
Loss = 2.4933e-03, PNorm = 63.2716, GNorm = 0.5221, lr_0 = 5.0997e-04
Loss = 2.3672e-03, PNorm = 63.3261, GNorm = 0.3591, lr_0 = 5.0212e-04
Loss = 3.0793e-03, PNorm = 63.3970, GNorm = 0.6669, lr_0 = 4.9439e-04
Loss = 2.2736e-03, PNorm = 63.4459, GNorm = 0.4654, lr_0 = 4.8678e-04
Loss = 2.6031e-03, PNorm = 63.5067, GNorm = 0.7390, lr_0 = 4.7928e-04
Validation auc = 0.936701
Epoch 11
Loss = 2.0496e-03, PNorm = 63.5655, GNorm = 0.5234, lr_0 = 4.7190e-04
Loss = 2.1745e-03, PNorm = 63.6230, GNorm = 0.2051, lr_0 = 4.6464e-04
Loss = 1.3455e-03, PNorm = 63.6683, GNorm = 0.9904, lr_0 = 4.5749e-04
Loss = 2.3945e-03, PNorm = 63.7195, GNorm = 0.3378, lr_0 = 4.5044e-04
Loss = 2.0348e-03, PNorm = 63.7545, GNorm = 0.4172, lr_0 = 4.4351e-04
Validation auc = 0.962276
Epoch 12
Loss = 1.3794e-03, PNorm = 63.7926, GNorm = 0.4338, lr_0 = 4.3668e-04
Loss = 1.6607e-03, PNorm = 63.8369, GNorm = 0.3877, lr_0 = 4.2996e-04
Loss = 2.3658e-03, PNorm = 63.8896, GNorm = 0.7409, lr_0 = 4.2334e-04
Loss = 1.9664e-03, PNorm = 63.9246, GNorm = 0.7985, lr_0 = 4.1682e-04
Loss = 2.1666e-03, PNorm = 63.9685, GNorm = 0.3722, lr_0 = 4.1040e-04
Validation auc = 0.946451
Epoch 13
Loss = 8.9498e-04, PNorm = 64.0095, GNorm = 0.3666, lr_0 = 4.0408e-04
Loss = 1.5812e-03, PNorm = 64.0614, GNorm = 0.4994, lr_0 = 3.9786e-04
Loss = 1.5557e-03, PNorm = 64.1182, GNorm = 0.2396, lr_0 = 3.9173e-04
Loss = 2.4570e-03, PNorm = 64.1527, GNorm = 0.5057, lr_0 = 3.8570e-04
Loss = 2.4443e-03, PNorm = 64.2019, GNorm = 0.7445, lr_0 = 3.7976e-04
Loss = 2.1370e-03, PNorm = 64.2415, GNorm = 0.4967, lr_0 = 3.7392e-04
Validation auc = 0.940697
Epoch 14
Loss = 1.7311e-03, PNorm = 64.2994, GNorm = 0.4244, lr_0 = 3.6816e-04
Loss = 1.9502e-03, PNorm = 64.3434, GNorm = 0.5547, lr_0 = 3.6249e-04
Loss = 1.5286e-03, PNorm = 64.3892, GNorm = 0.8731, lr_0 = 3.5691e-04
Loss = 1.6575e-03, PNorm = 64.4231, GNorm = 0.1730, lr_0 = 3.5142e-04
Loss = 1.8713e-03, PNorm = 64.4598, GNorm = 0.4273, lr_0 = 3.4601e-04
Validation auc = 0.950448
Epoch 15
Loss = 1.5830e-03, PNorm = 64.5110, GNorm = 0.6278, lr_0 = 3.4068e-04
Loss = 1.5532e-03, PNorm = 64.5393, GNorm = 0.9380, lr_0 = 3.3543e-04
Loss = 1.2150e-03, PNorm = 64.5865, GNorm = 0.2940, lr_0 = 3.3027e-04
Loss = 2.3273e-03, PNorm = 64.6193, GNorm = 0.3301, lr_0 = 3.2518e-04
Loss = 2.0134e-03, PNorm = 64.6498, GNorm = 0.3101, lr_0 = 3.2018e-04
Validation auc = 0.939418
Epoch 16
Loss = 7.8654e-04, PNorm = 64.6855, GNorm = 0.5613, lr_0 = 3.1525e-04
Loss = 1.3177e-03, PNorm = 64.7249, GNorm = 0.3806, lr_0 = 3.1039e-04
Loss = 1.3676e-03, PNorm = 64.7552, GNorm = 0.6959, lr_0 = 3.0562e-04
Loss = 2.0728e-03, PNorm = 64.7880, GNorm = 0.5690, lr_0 = 3.0091e-04
Loss = 1.9218e-03, PNorm = 64.8133, GNorm = 0.3596, lr_0 = 2.9628e-04
Loss = 1.4454e-03, PNorm = 64.8575, GNorm = 1.2588, lr_0 = 2.9172e-04
Validation auc = 0.933664
Epoch 17
Loss = 1.1675e-03, PNorm = 64.8809, GNorm = 0.2972, lr_0 = 2.8722e-04
Loss = 1.5493e-03, PNorm = 64.9194, GNorm = 1.1360, lr_0 = 2.8280e-04
Loss = 1.3754e-03, PNorm = 64.9360, GNorm = 0.6912, lr_0 = 2.7845e-04
Loss = 1.3279e-03, PNorm = 64.9739, GNorm = 0.2127, lr_0 = 2.7416e-04
Loss = 2.2501e-03, PNorm = 64.9930, GNorm = 1.6459, lr_0 = 2.6994e-04
Validation auc = 0.940217
Epoch 18
Loss = 1.5453e-03, PNorm = 65.0228, GNorm = 0.4029, lr_0 = 2.6578e-04
Loss = 1.1442e-03, PNorm = 65.0555, GNorm = 1.3060, lr_0 = 2.6169e-04
Loss = 1.3345e-03, PNorm = 65.0842, GNorm = 0.4389, lr_0 = 2.5766e-04
Loss = 1.8657e-03, PNorm = 65.1124, GNorm = 1.5071, lr_0 = 2.5370e-04
Loss = 8.5841e-04, PNorm = 65.1374, GNorm = 0.3976, lr_0 = 2.4979e-04
Validation auc = 0.930467
Epoch 19
Loss = 5.5965e-04, PNorm = 65.1690, GNorm = 0.3523, lr_0 = 2.4594e-04
Loss = 1.0693e-03, PNorm = 65.1880, GNorm = 0.4757, lr_0 = 2.4216e-04
Loss = 1.6329e-03, PNorm = 65.2185, GNorm = 0.5734, lr_0 = 2.3843e-04
Loss = 1.3916e-03, PNorm = 65.2361, GNorm = 0.2905, lr_0 = 2.3476e-04
Loss = 1.1785e-03, PNorm = 65.2689, GNorm = 0.2040, lr_0 = 2.3114e-04
Loss = 1.5499e-03, PNorm = 65.2961, GNorm = 0.8793, lr_0 = 2.2758e-04
Validation auc = 0.926950
Epoch 20
Loss = 1.5499e-03, PNorm = 65.3062, GNorm = 1.1366, lr_0 = 2.2408e-04
Loss = 8.7303e-04, PNorm = 65.3527, GNorm = 0.7089, lr_0 = 2.2063e-04
Loss = 1.5521e-03, PNorm = 65.3634, GNorm = 0.9013, lr_0 = 2.1723e-04
Loss = 1.0971e-03, PNorm = 65.3884, GNorm = 0.2918, lr_0 = 2.1389e-04
Loss = 1.2877e-03, PNorm = 65.4099, GNorm = 0.1354, lr_0 = 2.1060e-04
Validation auc = 0.928549
Epoch 21
Loss = 1.0495e-03, PNorm = 65.4245, GNorm = 0.5298, lr_0 = 2.0735e-04
Loss = 1.0943e-03, PNorm = 65.4501, GNorm = 0.4791, lr_0 = 2.0416e-04
Loss = 7.1699e-04, PNorm = 65.4671, GNorm = 0.1447, lr_0 = 2.0102e-04
Loss = 1.3922e-03, PNorm = 65.4807, GNorm = 0.6793, lr_0 = 1.9792e-04
Loss = 1.2772e-03, PNorm = 65.4936, GNorm = 0.8872, lr_0 = 1.9488e-04
Validation auc = 0.933983
Epoch 22
Loss = 1.2119e-03, PNorm = 65.5110, GNorm = 0.4250, lr_0 = 1.9188e-04
Loss = 8.9636e-04, PNorm = 65.5304, GNorm = 0.6163, lr_0 = 1.8892e-04
Loss = 1.2094e-03, PNorm = 65.5474, GNorm = 0.9213, lr_0 = 1.8601e-04
Loss = 1.4409e-03, PNorm = 65.5709, GNorm = 0.6754, lr_0 = 1.8315e-04
Loss = 4.5896e-04, PNorm = 65.5854, GNorm = 0.2981, lr_0 = 1.8033e-04
Validation auc = 0.922315
Epoch 23
Loss = 2.0943e-04, PNorm = 65.6007, GNorm = 0.1597, lr_0 = 1.7755e-04
Loss = 7.6001e-04, PNorm = 65.6150, GNorm = 0.5053, lr_0 = 1.7482e-04
Loss = 9.1425e-04, PNorm = 65.6380, GNorm = 0.2467, lr_0 = 1.7213e-04
Loss = 1.0041e-03, PNorm = 65.6546, GNorm = 0.4976, lr_0 = 1.6948e-04
Loss = 1.1229e-03, PNorm = 65.6687, GNorm = 0.8078, lr_0 = 1.6687e-04
Loss = 5.9582e-04, PNorm = 65.6888, GNorm = 0.3477, lr_0 = 1.6430e-04
Validation auc = 0.935102
Epoch 24
Loss = 5.8572e-04, PNorm = 65.7008, GNorm = 0.2674, lr_0 = 1.6177e-04
Loss = 9.5084e-04, PNorm = 65.7053, GNorm = 0.7996, lr_0 = 1.5928e-04
Loss = 1.1351e-03, PNorm = 65.7228, GNorm = 0.5919, lr_0 = 1.5683e-04
Loss = 7.6507e-04, PNorm = 65.7359, GNorm = 0.1622, lr_0 = 1.5441e-04
Loss = 1.1489e-03, PNorm = 65.7506, GNorm = 0.2189, lr_0 = 1.5203e-04
Validation auc = 0.935262
Epoch 25
Loss = 8.0901e-04, PNorm = 65.7613, GNorm = 0.3671, lr_0 = 1.4969e-04
Loss = 1.0126e-03, PNorm = 65.7719, GNorm = 0.2253, lr_0 = 1.4739e-04
Loss = 6.7067e-04, PNorm = 65.7793, GNorm = 0.6357, lr_0 = 1.4512e-04
Loss = 6.8171e-04, PNorm = 65.7917, GNorm = 0.9416, lr_0 = 1.4288e-04
Loss = 8.7259e-04, PNorm = 65.8014, GNorm = 0.7253, lr_0 = 1.4069e-04
Validation auc = 0.931266
Epoch 26
Loss = 6.3837e-04, PNorm = 65.8137, GNorm = 0.6134, lr_0 = 1.3852e-04
Loss = 5.0346e-04, PNorm = 65.8248, GNorm = 0.1201, lr_0 = 1.3639e-04
Loss = 8.7647e-04, PNorm = 65.8354, GNorm = 1.1616, lr_0 = 1.3429e-04
Loss = 6.8520e-04, PNorm = 65.8433, GNorm = 0.3097, lr_0 = 1.3222e-04
Loss = 1.0660e-03, PNorm = 65.8591, GNorm = 0.1789, lr_0 = 1.3018e-04
Loss = 9.4152e-04, PNorm = 65.8670, GNorm = 0.5718, lr_0 = 1.2818e-04
Validation auc = 0.919118
Epoch 27
Loss = 8.4670e-04, PNorm = 65.8821, GNorm = 0.5478, lr_0 = 1.2621e-04
Loss = 8.2460e-04, PNorm = 65.8931, GNorm = 0.6028, lr_0 = 1.2426e-04
Loss = 6.3472e-04, PNorm = 65.9009, GNorm = 0.9344, lr_0 = 1.2235e-04
Loss = 7.5001e-04, PNorm = 65.9115, GNorm = 0.2022, lr_0 = 1.2047e-04
Loss = 6.0256e-04, PNorm = 65.9217, GNorm = 0.4393, lr_0 = 1.1861e-04
Validation auc = 0.921036
Epoch 28
Loss = 6.1013e-04, PNorm = 65.9292, GNorm = 0.7768, lr_0 = 1.1678e-04
Loss = 6.1905e-04, PNorm = 65.9336, GNorm = 1.2407, lr_0 = 1.1499e-04
Loss = 4.2661e-04, PNorm = 65.9501, GNorm = 0.0732, lr_0 = 1.1322e-04
Loss = 1.0284e-03, PNorm = 65.9551, GNorm = 0.8852, lr_0 = 1.1147e-04
Loss = 1.1750e-03, PNorm = 65.9610, GNorm = 1.1070, lr_0 = 1.0976e-04
Validation auc = 0.932385
Epoch 29
Loss = 4.1508e-04, PNorm = 65.9781, GNorm = 0.5809, lr_0 = 1.0807e-04
Loss = 7.6465e-04, PNorm = 65.9770, GNorm = 0.3066, lr_0 = 1.0640e-04
Loss = 6.6073e-04, PNorm = 65.9845, GNorm = 0.4425, lr_0 = 1.0476e-04
Loss = 1.0805e-03, PNorm = 65.9989, GNorm = 0.3351, lr_0 = 1.0315e-04
Loss = 1.1026e-03, PNorm = 66.0011, GNorm = 0.4214, lr_0 = 1.0156e-04
Loss = 6.0310e-04, PNorm = 66.0115, GNorm = 0.6228, lr_0 = 1.0000e-04
Validation auc = 0.922155
Model 0 best validation auc = 0.964514 on epoch 7
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test auc = nan
Ensemble test auc = nan
Fold 18
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': '../../../swansonk/chemprop_ckpt/0406_inhibition_hyperopt.json',
 'cuda': True,
 'data_path': '../../broad2/larger_dataset/0405_inhibition_dedup_binary.csv',
 'dataset_type': 'classification',
 'depth': 5,
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_dim': 200,
 'features_generator': None,
 'features_only': False,
 'features_path': ['../../saved_features/0405_broad_inhibition.npz'],
 'features_scaling': False,
 'features_size': 200,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 1600,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'no_cache': False,
 'num_folds': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'output_size': 1,
 'quiet': True,
 'save_dir': '../ckpt/0405_broad_inhibition_20folds/fold_18',
 'save_smiles_splits': False,
 'seed': 18,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'task_names': ['50uM_Inhibition'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 2654,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': ['../../saved_features/0405_broad_inhibition.npz'],
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 18
Class sizes
50uM_Inhibition 0: 91.93%, 1: 8.07%
Total size = 2,949 | train size = 2,654 | val size = 295 | test size = 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1600, bias=False)
      (W_h): Linear(in_features=1600, out_features=1600, bias=False)
      (W_o): Linear(in_features=1733, out_features=1600, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,571,401
Moving model to cuda
Epoch 0
Loss = 7.8577e-03, PNorm = 59.4709, GNorm = 0.7100, lr_0 = 1.8491e-04
Loss = 6.3678e-03, PNorm = 59.4856, GNorm = 0.6583, lr_0 = 2.6981e-04
Loss = 5.2216e-03, PNorm = 59.5044, GNorm = 0.6024, lr_0 = 3.5472e-04
Loss = 5.7169e-03, PNorm = 59.5328, GNorm = 0.7383, lr_0 = 4.3962e-04
Loss = 5.3203e-03, PNorm = 59.5640, GNorm = 0.7168, lr_0 = 5.2453e-04
Validation auc = 0.716545
Epoch 1
Loss = 5.2361e-03, PNorm = 59.6090, GNorm = 0.3033, lr_0 = 6.0943e-04
Loss = 5.1143e-03, PNorm = 59.6545, GNorm = 0.4377, lr_0 = 6.9434e-04
Loss = 4.3066e-03, PNorm = 59.7185, GNorm = 0.5203, lr_0 = 7.7925e-04
Loss = 5.6878e-03, PNorm = 59.7932, GNorm = 1.9302, lr_0 = 8.6415e-04
Loss = 5.6315e-03, PNorm = 59.8950, GNorm = 0.4384, lr_0 = 9.4906e-04
Validation auc = 0.848627
Epoch 2
Loss = 4.8471e-03, PNorm = 60.0296, GNorm = 1.1788, lr_0 = 9.9381e-04
Loss = 4.5074e-03, PNorm = 60.1471, GNorm = 0.6320, lr_0 = 9.7851e-04
Loss = 3.7418e-03, PNorm = 60.2575, GNorm = 0.5071, lr_0 = 9.6345e-04
Loss = 5.3469e-03, PNorm = 60.3383, GNorm = 1.2315, lr_0 = 9.4861e-04
Loss = 4.8579e-03, PNorm = 60.4307, GNorm = 0.3410, lr_0 = 9.3401e-04
Validation auc = 0.889990
Epoch 3
Loss = 3.6793e-03, PNorm = 60.5163, GNorm = 0.3100, lr_0 = 9.1963e-04
Loss = 3.5971e-03, PNorm = 60.5995, GNorm = 0.2956, lr_0 = 9.0547e-04
Loss = 4.0283e-03, PNorm = 60.6726, GNorm = 0.8339, lr_0 = 8.9153e-04
Loss = 4.5929e-03, PNorm = 60.7456, GNorm = 0.3268, lr_0 = 8.7780e-04
Loss = 3.6456e-03, PNorm = 60.8368, GNorm = 0.3922, lr_0 = 8.6429e-04
Loss = 3.3024e-03, PNorm = 60.9297, GNorm = 0.4285, lr_0 = 8.5098e-04
Validation auc = 0.850017
Epoch 4
Loss = 4.5057e-03, PNorm = 61.0130, GNorm = 1.6460, lr_0 = 8.3788e-04
Loss = 3.3093e-03, PNorm = 61.1299, GNorm = 0.9164, lr_0 = 8.2498e-04
Loss = 4.6880e-03, PNorm = 61.2369, GNorm = 1.1801, lr_0 = 8.1228e-04
Loss = 4.7874e-03, PNorm = 61.3423, GNorm = 1.0218, lr_0 = 7.9977e-04
Loss = 3.0344e-03, PNorm = 61.4708, GNorm = 0.5937, lr_0 = 7.8746e-04
Validation auc = 0.911540
Epoch 5
Loss = 2.6493e-03, PNorm = 61.5563, GNorm = 0.2957, lr_0 = 7.7533e-04
Loss = 3.3286e-03, PNorm = 61.6180, GNorm = 0.8897, lr_0 = 7.6340e-04
Loss = 3.0835e-03, PNorm = 61.6886, GNorm = 0.3550, lr_0 = 7.5164e-04
Loss = 2.7957e-03, PNorm = 61.7652, GNorm = 0.6189, lr_0 = 7.4007e-04
Loss = 3.6326e-03, PNorm = 61.8313, GNorm = 0.6534, lr_0 = 7.2867e-04
Validation auc = 0.912930
Epoch 6
Loss = 3.2296e-03, PNorm = 61.9181, GNorm = 0.5547, lr_0 = 7.1746e-04
Loss = 3.0278e-03, PNorm = 62.0156, GNorm = 0.4094, lr_0 = 7.0641e-04
Loss = 2.3775e-03, PNorm = 62.1074, GNorm = 0.6751, lr_0 = 6.9553e-04
Loss = 3.1731e-03, PNorm = 62.1920, GNorm = 0.8172, lr_0 = 6.8482e-04
Loss = 2.1757e-03, PNorm = 62.2976, GNorm = 0.8548, lr_0 = 6.7428e-04
Loss = 3.2276e-03, PNorm = 62.3728, GNorm = 0.9929, lr_0 = 6.6390e-04
Validation auc = 0.926486
Epoch 7
Loss = 2.6844e-03, PNorm = 62.4635, GNorm = 0.4476, lr_0 = 6.5368e-04
Loss = 2.5279e-03, PNorm = 62.5575, GNorm = 0.2969, lr_0 = 6.4361e-04
Loss = 2.3868e-03, PNorm = 62.6353, GNorm = 0.8085, lr_0 = 6.3370e-04
Loss = 2.8707e-03, PNorm = 62.7029, GNorm = 0.6959, lr_0 = 6.2395e-04
Loss = 2.8027e-03, PNorm = 62.7814, GNorm = 0.9048, lr_0 = 6.1434e-04
Validation auc = 0.934654
Epoch 8
Loss = 2.8597e-03, PNorm = 62.8473, GNorm = 0.8369, lr_0 = 6.0488e-04
Loss = 2.5686e-03, PNorm = 62.9277, GNorm = 0.3679, lr_0 = 5.9557e-04
Loss = 2.2894e-03, PNorm = 63.0007, GNorm = 0.4433, lr_0 = 5.8640e-04
Loss = 2.4794e-03, PNorm = 63.0828, GNorm = 0.3356, lr_0 = 5.7737e-04
Loss = 2.5666e-03, PNorm = 63.1595, GNorm = 0.7160, lr_0 = 5.6848e-04
Validation auc = 0.959159
Epoch 9
Loss = 1.8349e-03, PNorm = 63.2210, GNorm = 0.3938, lr_0 = 5.5973e-04
Loss = 1.8626e-03, PNorm = 63.2845, GNorm = 0.4922, lr_0 = 5.5111e-04
Loss = 1.8911e-03, PNorm = 63.3490, GNorm = 0.7327, lr_0 = 5.4263e-04
Loss = 2.1560e-03, PNorm = 63.4107, GNorm = 0.4423, lr_0 = 5.3427e-04
Loss = 3.5190e-03, PNorm = 63.4563, GNorm = 0.5401, lr_0 = 5.2605e-04
Loss = 2.5586e-03, PNorm = 63.5174, GNorm = 0.4255, lr_0 = 5.1795e-04
Validation auc = 0.957073
Epoch 10
Loss = 2.1445e-03, PNorm = 63.5900, GNorm = 0.3802, lr_0 = 5.0997e-04
Loss = 2.0657e-03, PNorm = 63.6599, GNorm = 1.1573, lr_0 = 5.0212e-04
Loss = 2.0833e-03, PNorm = 63.7160, GNorm = 0.7937, lr_0 = 4.9439e-04
Loss = 2.3714e-03, PNorm = 63.7882, GNorm = 0.4968, lr_0 = 4.8678e-04
Loss = 2.7091e-03, PNorm = 63.8504, GNorm = 0.5017, lr_0 = 4.7928e-04
Validation auc = 0.951338
Epoch 11
Loss = 1.7591e-03, PNorm = 63.9185, GNorm = 0.4600, lr_0 = 4.7190e-04
Loss = 1.7810e-03, PNorm = 63.9768, GNorm = 0.9760, lr_0 = 4.6464e-04
Loss = 2.6115e-03, PNorm = 64.0178, GNorm = 0.5935, lr_0 = 4.5749e-04
Loss = 2.6738e-03, PNorm = 64.0798, GNorm = 0.4539, lr_0 = 4.5044e-04
Loss = 1.9906e-03, PNorm = 64.1267, GNorm = 0.2160, lr_0 = 4.4351e-04
Validation auc = 0.963156
Epoch 12
Loss = 3.4058e-03, PNorm = 64.1854, GNorm = 0.5911, lr_0 = 4.3668e-04
Loss = 1.1929e-03, PNorm = 64.2298, GNorm = 0.4909, lr_0 = 4.2996e-04
Loss = 1.6048e-03, PNorm = 64.2650, GNorm = 0.5079, lr_0 = 4.2334e-04
Loss = 2.1590e-03, PNorm = 64.2992, GNorm = 0.3741, lr_0 = 4.1682e-04
Loss = 1.4592e-03, PNorm = 64.3609, GNorm = 0.6088, lr_0 = 4.1040e-04
Validation auc = 0.975322
Epoch 13
Loss = 1.5378e-03, PNorm = 64.4022, GNorm = 0.5318, lr_0 = 4.0408e-04
Loss = 1.8021e-03, PNorm = 64.4536, GNorm = 0.5299, lr_0 = 3.9786e-04
Loss = 1.6160e-03, PNorm = 64.5003, GNorm = 0.5060, lr_0 = 3.9173e-04
Loss = 1.5535e-03, PNorm = 64.5419, GNorm = 1.2678, lr_0 = 3.8570e-04
Loss = 2.1500e-03, PNorm = 64.5904, GNorm = 0.3228, lr_0 = 3.7976e-04
Loss = 1.7667e-03, PNorm = 64.6386, GNorm = 0.5569, lr_0 = 3.7392e-04
Validation auc = 0.954988
Epoch 14
Loss = 1.3102e-03, PNorm = 64.6978, GNorm = 0.4401, lr_0 = 3.6816e-04
Loss = 1.7974e-03, PNorm = 64.7475, GNorm = 0.7327, lr_0 = 3.6249e-04
Loss = 1.4917e-03, PNorm = 64.8010, GNorm = 0.5943, lr_0 = 3.5691e-04
Loss = 2.0085e-03, PNorm = 64.8367, GNorm = 0.5391, lr_0 = 3.5142e-04
Loss = 1.4920e-03, PNorm = 64.8780, GNorm = 0.7575, lr_0 = 3.4601e-04
Validation auc = 0.977233
Epoch 15
Loss = 1.3488e-03, PNorm = 64.9096, GNorm = 0.8983, lr_0 = 3.4068e-04
Loss = 1.6697e-03, PNorm = 64.9596, GNorm = 0.5035, lr_0 = 3.3543e-04
Loss = 1.8396e-03, PNorm = 64.9915, GNorm = 0.8994, lr_0 = 3.3027e-04
Loss = 1.6852e-03, PNorm = 65.0467, GNorm = 0.7580, lr_0 = 3.2518e-04
Loss = 1.7161e-03, PNorm = 65.0813, GNorm = 0.8528, lr_0 = 3.2018e-04
Validation auc = 0.977407
Epoch 16
Loss = 1.1681e-03, PNorm = 65.1157, GNorm = 0.5758, lr_0 = 3.1525e-04
Loss = 1.8810e-03, PNorm = 65.1485, GNorm = 0.5795, lr_0 = 3.1039e-04
Loss = 1.7452e-03, PNorm = 65.1951, GNorm = 0.2815, lr_0 = 3.0562e-04
Loss = 1.0659e-03, PNorm = 65.2423, GNorm = 0.7916, lr_0 = 3.0091e-04
Loss = 9.3812e-04, PNorm = 65.2806, GNorm = 0.0943, lr_0 = 2.9628e-04
Loss = 2.5513e-03, PNorm = 65.2925, GNorm = 0.5890, lr_0 = 2.9172e-04
Validation auc = 0.960549
Epoch 17
Loss = 1.3098e-03, PNorm = 65.3403, GNorm = 0.0956, lr_0 = 2.8722e-04
Loss = 1.5114e-03, PNorm = 65.3725, GNorm = 0.3307, lr_0 = 2.8280e-04
Loss = 1.6185e-03, PNorm = 65.3998, GNorm = 0.8578, lr_0 = 2.7845e-04
Loss = 2.0807e-03, PNorm = 65.4328, GNorm = 0.3380, lr_0 = 2.7416e-04
Loss = 1.5354e-03, PNorm = 65.4694, GNorm = 0.5870, lr_0 = 2.6994e-04
Validation auc = 0.970108
Epoch 18
Loss = 1.6280e-03, PNorm = 65.5023, GNorm = 0.7069, lr_0 = 2.6578e-04
Loss = 1.5404e-03, PNorm = 65.5385, GNorm = 0.3806, lr_0 = 2.6169e-04
Loss = 1.1751e-03, PNorm = 65.5712, GNorm = 0.6057, lr_0 = 2.5766e-04
Loss = 1.3626e-03, PNorm = 65.5940, GNorm = 0.4576, lr_0 = 2.5370e-04
Loss = 1.1996e-03, PNorm = 65.6237, GNorm = 0.6756, lr_0 = 2.4979e-04
Validation auc = 0.976886
Epoch 19
Loss = 1.0008e-03, PNorm = 65.6481, GNorm = 0.2193, lr_0 = 2.4594e-04
Loss = 1.1040e-03, PNorm = 65.6803, GNorm = 0.5742, lr_0 = 2.4216e-04
Loss = 1.0338e-03, PNorm = 65.7150, GNorm = 0.7291, lr_0 = 2.3843e-04
Loss = 1.9503e-03, PNorm = 65.7366, GNorm = 0.6269, lr_0 = 2.3476e-04
Loss = 1.1407e-03, PNorm = 65.7640, GNorm = 0.4913, lr_0 = 2.3114e-04
Loss = 1.0107e-03, PNorm = 65.7896, GNorm = 0.9718, lr_0 = 2.2758e-04
Validation auc = 0.970108
Epoch 20
Loss = 1.5554e-03, PNorm = 65.8076, GNorm = 1.1600, lr_0 = 2.2408e-04
Loss = 1.0519e-03, PNorm = 65.8254, GNorm = 0.5633, lr_0 = 2.2063e-04
Loss = 1.1969e-03, PNorm = 65.8545, GNorm = 0.2453, lr_0 = 2.1723e-04
Loss = 1.0945e-03, PNorm = 65.8815, GNorm = 0.7253, lr_0 = 2.1389e-04
Loss = 8.7554e-04, PNorm = 65.9053, GNorm = 0.6945, lr_0 = 2.1060e-04
Validation auc = 0.974626
Epoch 21
Loss = 9.4212e-04, PNorm = 65.9292, GNorm = 0.4863, lr_0 = 2.0735e-04
Loss = 1.1623e-03, PNorm = 65.9505, GNorm = 0.6924, lr_0 = 2.0416e-04
Loss = 1.2502e-03, PNorm = 65.9720, GNorm = 1.0992, lr_0 = 2.0102e-04
Loss = 8.7008e-04, PNorm = 65.9925, GNorm = 0.7489, lr_0 = 1.9792e-04
Loss = 1.5295e-03, PNorm = 66.0183, GNorm = 1.2229, lr_0 = 1.9488e-04
Validation auc = 0.974279
Epoch 22
Loss = 2.0681e-03, PNorm = 66.0296, GNorm = 1.1302, lr_0 = 1.9188e-04
Loss = 7.8373e-04, PNorm = 66.0561, GNorm = 0.4125, lr_0 = 1.8892e-04
Loss = 9.2784e-04, PNorm = 66.0732, GNorm = 0.5188, lr_0 = 1.8601e-04
Loss = 1.2793e-03, PNorm = 66.0941, GNorm = 0.5413, lr_0 = 1.8315e-04
Loss = 9.3217e-04, PNorm = 66.1121, GNorm = 0.6796, lr_0 = 1.8033e-04
Validation auc = 0.976364
Epoch 23
Loss = 1.8214e-04, PNorm = 66.1324, GNorm = 0.0848, lr_0 = 1.7755e-04
Loss = 6.4651e-04, PNorm = 66.1493, GNorm = 0.1882, lr_0 = 1.7482e-04
Loss = 1.0315e-03, PNorm = 66.1624, GNorm = 0.1218, lr_0 = 1.7213e-04
Loss = 1.1239e-03, PNorm = 66.1770, GNorm = 0.2442, lr_0 = 1.6948e-04
Loss = 8.6958e-04, PNorm = 66.1919, GNorm = 0.5558, lr_0 = 1.6687e-04
Loss = 1.4277e-03, PNorm = 66.2059, GNorm = 0.1944, lr_0 = 1.6430e-04
Validation auc = 0.971324
Epoch 24
Loss = 7.0660e-04, PNorm = 66.2232, GNorm = 0.9788, lr_0 = 1.6177e-04
Loss = 9.5073e-04, PNorm = 66.2336, GNorm = 0.4899, lr_0 = 1.5928e-04
Loss = 9.8920e-04, PNorm = 66.2516, GNorm = 0.9440, lr_0 = 1.5683e-04
Loss = 1.0876e-03, PNorm = 66.2624, GNorm = 0.3523, lr_0 = 1.5441e-04
Loss = 9.8500e-04, PNorm = 66.2797, GNorm = 0.3963, lr_0 = 1.5203e-04
Validation auc = 0.965589
Epoch 25
Loss = 1.1250e-03, PNorm = 66.2926, GNorm = 0.6966, lr_0 = 1.4969e-04
Loss = 6.4513e-04, PNorm = 66.3047, GNorm = 0.8282, lr_0 = 1.4739e-04
Loss = 8.3872e-04, PNorm = 66.3223, GNorm = 0.7774, lr_0 = 1.4512e-04
Loss = 9.7982e-04, PNorm = 66.3314, GNorm = 0.2866, lr_0 = 1.4288e-04
Loss = 9.4460e-04, PNorm = 66.3469, GNorm = 0.5226, lr_0 = 1.4069e-04
Validation auc = 0.971846
Epoch 26
Loss = 3.6722e-04, PNorm = 66.3587, GNorm = 0.1685, lr_0 = 1.3852e-04
Loss = 4.8800e-04, PNorm = 66.3681, GNorm = 0.3899, lr_0 = 1.3639e-04
Loss = 8.7207e-04, PNorm = 66.3801, GNorm = 0.5208, lr_0 = 1.3429e-04
Loss = 1.0987e-03, PNorm = 66.3900, GNorm = 0.8007, lr_0 = 1.3222e-04
Loss = 9.5474e-04, PNorm = 66.4061, GNorm = 0.5460, lr_0 = 1.3018e-04
Loss = 6.6987e-04, PNorm = 66.4141, GNorm = 0.2776, lr_0 = 1.2818e-04
Validation auc = 0.969586
Epoch 27
Loss = 7.6443e-04, PNorm = 66.4250, GNorm = 0.7318, lr_0 = 1.2621e-04
Loss = 6.2685e-04, PNorm = 66.4378, GNorm = 0.6465, lr_0 = 1.2426e-04
Loss = 6.1087e-04, PNorm = 66.4479, GNorm = 0.5056, lr_0 = 1.2235e-04
Loss = 1.0054e-03, PNorm = 66.4600, GNorm = 0.6690, lr_0 = 1.2047e-04
Loss = 9.6728e-04, PNorm = 66.4644, GNorm = 0.8989, lr_0 = 1.1861e-04
Validation auc = 0.963851
Epoch 28
Loss = 6.2364e-04, PNorm = 66.4718, GNorm = 1.2251, lr_0 = 1.1678e-04
Loss = 5.9532e-04, PNorm = 66.4829, GNorm = 0.5386, lr_0 = 1.1499e-04
Loss = 5.5420e-04, PNorm = 66.4935, GNorm = 0.2241, lr_0 = 1.1322e-04
Loss = 9.7579e-04, PNorm = 66.5010, GNorm = 0.2061, lr_0 = 1.1147e-04
Loss = 9.5384e-04, PNorm = 66.5096, GNorm = 0.6924, lr_0 = 1.0976e-04
Validation auc = 0.969413
Epoch 29
Loss = 5.2739e-04, PNorm = 66.5165, GNorm = 0.4790, lr_0 = 1.0807e-04
Loss = 5.9034e-04, PNorm = 66.5278, GNorm = 0.0958, lr_0 = 1.0640e-04
Loss = 6.8169e-04, PNorm = 66.5322, GNorm = 0.8592, lr_0 = 1.0476e-04
Loss = 8.8078e-04, PNorm = 66.5406, GNorm = 0.9487, lr_0 = 1.0315e-04
Loss = 1.0250e-03, PNorm = 66.5429, GNorm = 0.9044, lr_0 = 1.0156e-04
Loss = 7.4024e-04, PNorm = 66.5526, GNorm = 1.1219, lr_0 = 1.0000e-04
Validation auc = 0.965415
Model 0 best validation auc = 0.977407 on epoch 15
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test auc = nan
Ensemble test auc = nan
Fold 19
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': '../../../swansonk/chemprop_ckpt/0406_inhibition_hyperopt.json',
 'cuda': True,
 'data_path': '../../broad2/larger_dataset/0405_inhibition_dedup_binary.csv',
 'dataset_type': 'classification',
 'depth': 5,
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_dim': 200,
 'features_generator': None,
 'features_only': False,
 'features_path': ['../../saved_features/0405_broad_inhibition.npz'],
 'features_scaling': False,
 'features_size': 200,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 1600,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'no_cache': False,
 'num_folds': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'output_size': 1,
 'quiet': True,
 'save_dir': '../ckpt/0405_broad_inhibition_20folds/fold_19',
 'save_smiles_splits': False,
 'seed': 19,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'task_names': ['50uM_Inhibition'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 2654,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': ['../../saved_features/0405_broad_inhibition.npz'],
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 19
Class sizes
50uM_Inhibition 0: 91.93%, 1: 8.07%
Total size = 2,949 | train size = 2,654 | val size = 295 | test size = 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1600, bias=False)
      (W_h): Linear(in_features=1600, out_features=1600, bias=False)
      (W_o): Linear(in_features=1733, out_features=1600, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,571,401
Moving model to cuda
Epoch 0
Loss = 5.3592e-03, PNorm = 59.4634, GNorm = 0.8075, lr_0 = 1.8491e-04
Loss = 5.4571e-03, PNorm = 59.4782, GNorm = 0.5827, lr_0 = 2.6981e-04
Loss = 4.9009e-03, PNorm = 59.5015, GNorm = 0.3462, lr_0 = 3.5472e-04
Loss = 6.8580e-03, PNorm = 59.5295, GNorm = 0.6770, lr_0 = 4.3962e-04
Loss = 5.6300e-03, PNorm = 59.5726, GNorm = 0.7717, lr_0 = 5.2453e-04
Validation auc = 0.809811
Epoch 1
Loss = 5.7802e-03, PNorm = 59.6225, GNorm = 0.4142, lr_0 = 6.0943e-04
Loss = 5.4898e-03, PNorm = 59.6783, GNorm = 0.4180, lr_0 = 6.9434e-04
Loss = 4.3264e-03, PNorm = 59.7352, GNorm = 0.2776, lr_0 = 7.7925e-04
Loss = 5.1652e-03, PNorm = 59.7997, GNorm = 0.5262, lr_0 = 8.6415e-04
Loss = 4.4959e-03, PNorm = 59.8862, GNorm = 1.1550, lr_0 = 9.4906e-04
Validation auc = 0.861761
Epoch 2
Loss = 4.8642e-03, PNorm = 59.9893, GNorm = 0.3988, lr_0 = 9.9381e-04
Loss = 4.4865e-03, PNorm = 60.1161, GNorm = 0.4478, lr_0 = 9.7851e-04
Loss = 4.0148e-03, PNorm = 60.2382, GNorm = 0.8424, lr_0 = 9.6345e-04
Loss = 4.2568e-03, PNorm = 60.3456, GNorm = 0.7489, lr_0 = 9.4861e-04
Loss = 4.0081e-03, PNorm = 60.4520, GNorm = 1.4265, lr_0 = 9.3401e-04
Validation auc = 0.911824
Epoch 3
Loss = 5.2544e-03, PNorm = 60.5293, GNorm = 0.8165, lr_0 = 9.1963e-04
Loss = 4.2886e-03, PNorm = 60.6093, GNorm = 0.7499, lr_0 = 9.0547e-04
Loss = 3.4599e-03, PNorm = 60.7019, GNorm = 1.3237, lr_0 = 8.9153e-04
Loss = 3.0836e-03, PNorm = 60.7888, GNorm = 0.3523, lr_0 = 8.7780e-04
Loss = 4.4906e-03, PNorm = 60.8736, GNorm = 0.2987, lr_0 = 8.6429e-04
Loss = 3.9802e-03, PNorm = 60.9848, GNorm = 0.6879, lr_0 = 8.5098e-04
Validation auc = 0.925283
Epoch 4
Loss = 3.4486e-03, PNorm = 61.0740, GNorm = 0.5705, lr_0 = 8.3788e-04
Loss = 3.5244e-03, PNorm = 61.1491, GNorm = 0.2205, lr_0 = 8.2498e-04
Loss = 3.2890e-03, PNorm = 61.2366, GNorm = 0.2665, lr_0 = 8.1228e-04
Loss = 3.2314e-03, PNorm = 61.3360, GNorm = 1.7614, lr_0 = 7.9977e-04
Loss = 3.4422e-03, PNorm = 61.4184, GNorm = 0.3675, lr_0 = 7.8746e-04
Validation auc = 0.968805
Epoch 5
Loss = 2.8083e-03, PNorm = 61.5073, GNorm = 0.3004, lr_0 = 7.7533e-04
Loss = 2.6673e-03, PNorm = 61.6074, GNorm = 0.3290, lr_0 = 7.6340e-04
Loss = 3.1267e-03, PNorm = 61.7055, GNorm = 0.7033, lr_0 = 7.5164e-04
Loss = 3.7088e-03, PNorm = 61.8207, GNorm = 0.4198, lr_0 = 7.4007e-04
Loss = 3.2354e-03, PNorm = 61.9234, GNorm = 0.4047, lr_0 = 7.2867e-04
Validation auc = 0.937358
Epoch 6
Loss = 2.2959e-03, PNorm = 62.0168, GNorm = 0.3021, lr_0 = 7.1746e-04
Loss = 3.7202e-03, PNorm = 62.1149, GNorm = 1.4784, lr_0 = 7.0641e-04
Loss = 4.5186e-03, PNorm = 62.2295, GNorm = 0.6705, lr_0 = 6.9553e-04
Loss = 2.9116e-03, PNorm = 62.3474, GNorm = 0.6848, lr_0 = 6.8482e-04
Loss = 3.3070e-03, PNorm = 62.4308, GNorm = 0.4803, lr_0 = 6.7428e-04
Loss = 1.4942e-03, PNorm = 62.5165, GNorm = 0.2354, lr_0 = 6.6390e-04
Validation auc = 0.975094
Epoch 7
Loss = 2.0744e-03, PNorm = 62.5926, GNorm = 0.6010, lr_0 = 6.5368e-04
Loss = 2.8841e-03, PNorm = 62.6650, GNorm = 1.2403, lr_0 = 6.4361e-04
Loss = 2.7101e-03, PNorm = 62.7505, GNorm = 0.2098, lr_0 = 6.3370e-04
Loss = 3.1722e-03, PNorm = 62.8409, GNorm = 0.5412, lr_0 = 6.2395e-04
Loss = 2.7849e-03, PNorm = 62.9385, GNorm = 0.3235, lr_0 = 6.1434e-04
Validation auc = 0.984780
Epoch 8
Loss = 3.0384e-03, PNorm = 63.0264, GNorm = 0.5205, lr_0 = 6.0488e-04
Loss = 2.0431e-03, PNorm = 63.1016, GNorm = 0.4116, lr_0 = 5.9557e-04
Loss = 2.5602e-03, PNorm = 63.1781, GNorm = 0.8352, lr_0 = 5.8640e-04
Loss = 2.3190e-03, PNorm = 63.2626, GNorm = 0.1884, lr_0 = 5.7737e-04
Loss = 3.0285e-03, PNorm = 63.3476, GNorm = 0.6034, lr_0 = 5.6848e-04
Validation auc = 0.979497
Epoch 9
Loss = 2.8470e-03, PNorm = 63.4244, GNorm = 0.5441, lr_0 = 5.5973e-04
Loss = 3.3263e-03, PNorm = 63.5139, GNorm = 1.6934, lr_0 = 5.5111e-04
Loss = 1.5380e-03, PNorm = 63.6147, GNorm = 0.2579, lr_0 = 5.4263e-04
Loss = 2.3551e-03, PNorm = 63.6804, GNorm = 0.6015, lr_0 = 5.3427e-04
Loss = 2.0391e-03, PNorm = 63.7483, GNorm = 0.3000, lr_0 = 5.2605e-04
Loss = 2.5857e-03, PNorm = 63.8015, GNorm = 0.8912, lr_0 = 5.1795e-04
Validation auc = 0.968931
Epoch 10
Loss = 2.2014e-03, PNorm = 63.8582, GNorm = 0.1167, lr_0 = 5.0997e-04
Loss = 2.5847e-03, PNorm = 63.8992, GNorm = 0.4553, lr_0 = 5.0212e-04
Loss = 1.3918e-03, PNorm = 63.9675, GNorm = 0.3872, lr_0 = 4.9439e-04
Loss = 2.4718e-03, PNorm = 64.0096, GNorm = 0.5444, lr_0 = 4.8678e-04
Loss = 2.4214e-03, PNorm = 64.0766, GNorm = 0.6981, lr_0 = 4.7928e-04
Validation auc = 0.969057
Epoch 11
Loss = 1.7291e-03, PNorm = 64.1439, GNorm = 0.7582, lr_0 = 4.7190e-04
Loss = 2.1141e-03, PNorm = 64.2172, GNorm = 0.7018, lr_0 = 4.6464e-04
Loss = 1.8041e-03, PNorm = 64.2869, GNorm = 0.7176, lr_0 = 4.5749e-04
Loss = 2.2878e-03, PNorm = 64.3529, GNorm = 0.3585, lr_0 = 4.5044e-04
Loss = 2.4335e-03, PNorm = 64.4065, GNorm = 0.9956, lr_0 = 4.4351e-04
Validation auc = 0.968931
Epoch 12
Loss = 9.7146e-04, PNorm = 64.4640, GNorm = 0.2938, lr_0 = 4.3668e-04
Loss = 1.6689e-03, PNorm = 64.5111, GNorm = 0.4027, lr_0 = 4.2996e-04
Loss = 2.4803e-03, PNorm = 64.5562, GNorm = 0.3700, lr_0 = 4.2334e-04
Loss = 2.0916e-03, PNorm = 64.6207, GNorm = 0.8904, lr_0 = 4.1682e-04
Loss = 1.7980e-03, PNorm = 64.6737, GNorm = 0.7813, lr_0 = 4.1040e-04
Validation auc = 0.975849
Epoch 13
Loss = 2.4741e-03, PNorm = 64.7216, GNorm = 0.4497, lr_0 = 4.0408e-04
Loss = 1.6588e-03, PNorm = 64.7744, GNorm = 0.3139, lr_0 = 3.9786e-04
Loss = 1.4946e-03, PNorm = 64.8279, GNorm = 0.9462, lr_0 = 3.9173e-04
Loss = 2.2399e-03, PNorm = 64.8824, GNorm = 0.7426, lr_0 = 3.8570e-04
Loss = 1.8312e-03, PNorm = 64.9497, GNorm = 0.1878, lr_0 = 3.7976e-04
Loss = 1.6108e-03, PNorm = 65.0154, GNorm = 0.4938, lr_0 = 3.7392e-04
Validation auc = 0.967296
Epoch 14
Loss = 2.9213e-03, PNorm = 65.0536, GNorm = 1.3382, lr_0 = 3.6816e-04
Loss = 2.0483e-03, PNorm = 65.1284, GNorm = 0.7820, lr_0 = 3.6249e-04
Loss = 1.6132e-03, PNorm = 65.1890, GNorm = 0.2969, lr_0 = 3.5691e-04
Loss = 1.5477e-03, PNorm = 65.2383, GNorm = 0.3128, lr_0 = 3.5142e-04
Loss = 1.6851e-03, PNorm = 65.2726, GNorm = 0.6099, lr_0 = 3.4601e-04
Validation auc = 0.977610
Epoch 15
Loss = 1.3825e-03, PNorm = 65.3043, GNorm = 0.6876, lr_0 = 3.4068e-04
Loss = 1.3913e-03, PNorm = 65.3432, GNorm = 0.3094, lr_0 = 3.3543e-04
Loss = 1.4768e-03, PNorm = 65.3746, GNorm = 0.3844, lr_0 = 3.3027e-04
Loss = 1.5703e-03, PNorm = 65.4278, GNorm = 0.7566, lr_0 = 3.2518e-04
Loss = 2.3698e-03, PNorm = 65.4492, GNorm = 0.3351, lr_0 = 3.2018e-04
Validation auc = 0.970566
Epoch 16
Loss = 8.2159e-04, PNorm = 65.4975, GNorm = 0.3939, lr_0 = 3.1525e-04
Loss = 1.4531e-03, PNorm = 65.5351, GNorm = 0.2609, lr_0 = 3.1039e-04
Loss = 1.2848e-03, PNorm = 65.5888, GNorm = 0.1472, lr_0 = 3.0562e-04
Loss = 2.2087e-03, PNorm = 65.6162, GNorm = 0.5144, lr_0 = 3.0091e-04
Loss = 1.7912e-03, PNorm = 65.6808, GNorm = 0.9159, lr_0 = 2.9628e-04
Loss = 1.7024e-03, PNorm = 65.7164, GNorm = 0.6877, lr_0 = 2.9172e-04
Validation auc = 0.978239
Epoch 17
Loss = 1.4363e-03, PNorm = 65.7619, GNorm = 0.5686, lr_0 = 2.8722e-04
Loss = 1.4131e-03, PNorm = 65.7914, GNorm = 0.5503, lr_0 = 2.8280e-04
Loss = 1.1508e-03, PNorm = 65.8248, GNorm = 0.2348, lr_0 = 2.7845e-04
Loss = 1.2696e-03, PNorm = 65.8524, GNorm = 1.4819, lr_0 = 2.7416e-04
Loss = 1.9318e-03, PNorm = 65.8733, GNorm = 0.9205, lr_0 = 2.6994e-04
Validation auc = 0.971069
Epoch 18
Loss = 9.0054e-04, PNorm = 65.9011, GNorm = 0.3859, lr_0 = 2.6578e-04
Loss = 1.3077e-03, PNorm = 65.9357, GNorm = 0.4951, lr_0 = 2.6169e-04
Loss = 1.5860e-03, PNorm = 65.9679, GNorm = 0.2822, lr_0 = 2.5766e-04
Loss = 1.6061e-03, PNorm = 65.9971, GNorm = 0.2359, lr_0 = 2.5370e-04
Loss = 1.3938e-03, PNorm = 66.0225, GNorm = 0.6283, lr_0 = 2.4979e-04
Validation auc = 0.967170
Epoch 19
Loss = 1.6601e-03, PNorm = 66.0573, GNorm = 0.1726, lr_0 = 2.4594e-04
Loss = 9.4825e-04, PNorm = 66.0907, GNorm = 0.4167, lr_0 = 2.4216e-04
Loss = 1.0152e-03, PNorm = 66.1163, GNorm = 0.3539, lr_0 = 2.3843e-04
Loss = 1.2249e-03, PNorm = 66.1483, GNorm = 0.3405, lr_0 = 2.3476e-04
Loss = 1.0825e-03, PNorm = 66.1731, GNorm = 0.2534, lr_0 = 2.3114e-04
Loss = 1.2227e-03, PNorm = 66.1957, GNorm = 0.2073, lr_0 = 2.2758e-04
Validation auc = 0.976101
Epoch 20
Loss = 1.2256e-03, PNorm = 66.2171, GNorm = 0.4255, lr_0 = 2.2408e-04
Loss = 1.0317e-03, PNorm = 66.2482, GNorm = 0.7186, lr_0 = 2.2063e-04
Loss = 9.3774e-04, PNorm = 66.2673, GNorm = 0.6836, lr_0 = 2.1723e-04
Loss = 1.0586e-03, PNorm = 66.2929, GNorm = 0.9086, lr_0 = 2.1389e-04
Loss = 1.0857e-03, PNorm = 66.3218, GNorm = 1.0100, lr_0 = 2.1060e-04
Validation auc = 0.970692
Epoch 21
Loss = 6.1680e-04, PNorm = 66.3442, GNorm = 0.4641, lr_0 = 2.0735e-04
Loss = 1.3734e-03, PNorm = 66.3719, GNorm = 1.0196, lr_0 = 2.0416e-04
Loss = 1.3850e-03, PNorm = 66.3941, GNorm = 0.5711, lr_0 = 2.0102e-04
Loss = 1.0688e-03, PNorm = 66.4238, GNorm = 0.8190, lr_0 = 1.9792e-04
Loss = 9.9361e-04, PNorm = 66.4413, GNorm = 0.4469, lr_0 = 1.9488e-04
Validation auc = 0.975220
Epoch 22
Loss = 6.3268e-04, PNorm = 66.4616, GNorm = 0.3895, lr_0 = 1.9188e-04
Loss = 6.4655e-04, PNorm = 66.4796, GNorm = 0.4219, lr_0 = 1.8892e-04
Loss = 1.3413e-03, PNorm = 66.4998, GNorm = 0.2964, lr_0 = 1.8601e-04
Loss = 1.3260e-03, PNorm = 66.5103, GNorm = 0.4966, lr_0 = 1.8315e-04
Loss = 1.1212e-03, PNorm = 66.5341, GNorm = 0.6425, lr_0 = 1.8033e-04
Validation auc = 0.973585
Epoch 23
Loss = 1.7596e-03, PNorm = 66.5537, GNorm = 0.7318, lr_0 = 1.7755e-04
Loss = 7.5346e-04, PNorm = 66.5764, GNorm = 0.1784, lr_0 = 1.7482e-04
Loss = 8.7377e-04, PNorm = 66.5958, GNorm = 0.3789, lr_0 = 1.7213e-04
Loss = 8.2961e-04, PNorm = 66.6124, GNorm = 0.3510, lr_0 = 1.6948e-04
Loss = 8.4733e-04, PNorm = 66.6292, GNorm = 0.9569, lr_0 = 1.6687e-04
Loss = 7.2997e-04, PNorm = 66.6382, GNorm = 0.4869, lr_0 = 1.6430e-04
Validation auc = 0.971698
Epoch 24
Loss = 9.8926e-04, PNorm = 66.6534, GNorm = 0.7502, lr_0 = 1.6177e-04
Loss = 8.1837e-04, PNorm = 66.6738, GNorm = 0.7266, lr_0 = 1.5928e-04
Loss = 1.0414e-03, PNorm = 66.6852, GNorm = 0.6545, lr_0 = 1.5683e-04
Loss = 7.4709e-04, PNorm = 66.7052, GNorm = 0.6248, lr_0 = 1.5441e-04
Loss = 8.7100e-04, PNorm = 66.7143, GNorm = 0.6115, lr_0 = 1.5203e-04
Validation auc = 0.973459
Epoch 25
Loss = 9.2704e-04, PNorm = 66.7272, GNorm = 0.7079, lr_0 = 1.4969e-04
Loss = 1.1013e-03, PNorm = 66.7396, GNorm = 0.5120, lr_0 = 1.4739e-04
Loss = 5.3011e-04, PNorm = 66.7515, GNorm = 0.2511, lr_0 = 1.4512e-04
Loss = 6.1022e-04, PNorm = 66.7669, GNorm = 0.2079, lr_0 = 1.4288e-04
Loss = 7.2316e-04, PNorm = 66.7868, GNorm = 0.8486, lr_0 = 1.4069e-04
Validation auc = 0.971698
Epoch 26
Loss = 1.0159e-03, PNorm = 66.7977, GNorm = 0.7063, lr_0 = 1.3852e-04
Loss = 6.5705e-04, PNorm = 66.8135, GNorm = 1.0169, lr_0 = 1.3639e-04
Loss = 4.2765e-04, PNorm = 66.8245, GNorm = 0.1367, lr_0 = 1.3429e-04
Loss = 1.0085e-03, PNorm = 66.8378, GNorm = 1.3609, lr_0 = 1.3222e-04
Loss = 7.6059e-04, PNorm = 66.8577, GNorm = 0.8076, lr_0 = 1.3018e-04
Loss = 1.0864e-03, PNorm = 66.8672, GNorm = 0.1804, lr_0 = 1.2818e-04
Validation auc = 0.967799
Epoch 27
Loss = 6.0000e-04, PNorm = 66.8738, GNorm = 0.3720, lr_0 = 1.2621e-04
Loss = 3.6260e-04, PNorm = 66.8849, GNorm = 0.1217, lr_0 = 1.2426e-04
Loss = 8.0270e-04, PNorm = 66.8941, GNorm = 0.5805, lr_0 = 1.2235e-04
Loss = 6.6350e-04, PNorm = 66.9021, GNorm = 0.3879, lr_0 = 1.2047e-04
Loss = 7.9757e-04, PNorm = 66.9196, GNorm = 0.6418, lr_0 = 1.1861e-04
Validation auc = 0.965409
Epoch 28
Loss = 5.7649e-04, PNorm = 66.9250, GNorm = 0.2918, lr_0 = 1.1678e-04
Loss = 7.1999e-04, PNorm = 66.9369, GNorm = 0.6517, lr_0 = 1.1499e-04
Loss = 9.0551e-04, PNorm = 66.9424, GNorm = 1.0924, lr_0 = 1.1322e-04
Loss = 4.8320e-04, PNorm = 66.9576, GNorm = 0.1934, lr_0 = 1.1147e-04
Loss = 7.3958e-04, PNorm = 66.9658, GNorm = 0.7878, lr_0 = 1.0976e-04
Validation auc = 0.970189
Epoch 29
Loss = 5.1648e-04, PNorm = 66.9746, GNorm = 0.6028, lr_0 = 1.0807e-04
Loss = 4.6087e-04, PNorm = 66.9822, GNorm = 0.3624, lr_0 = 1.0640e-04
Loss = 6.9999e-04, PNorm = 66.9932, GNorm = 0.2866, lr_0 = 1.0476e-04
Loss = 5.9110e-04, PNorm = 66.9975, GNorm = 0.5441, lr_0 = 1.0315e-04
Loss = 8.0524e-04, PNorm = 67.0049, GNorm = 0.6091, lr_0 = 1.0156e-04
Loss = 6.6808e-04, PNorm = 67.0167, GNorm = 0.0826, lr_0 = 1.0000e-04
Validation auc = 0.969937
Model 0 best validation auc = 0.984780 on epoch 7
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test auc = nan
Ensemble test auc = nan
20-fold cross validation
Seed 0 ==> test auc = nan
Seed 1 ==> test auc = nan
Seed 2 ==> test auc = nan
Seed 3 ==> test auc = nan
Seed 4 ==> test auc = nan
Seed 5 ==> test auc = nan
Seed 6 ==> test auc = nan
Seed 7 ==> test auc = nan
Seed 8 ==> test auc = nan
Seed 9 ==> test auc = nan
Seed 10 ==> test auc = nan
Seed 11 ==> test auc = nan
Seed 12 ==> test auc = nan
Seed 13 ==> test auc = nan
Seed 14 ==> test auc = nan
Seed 15 ==> test auc = nan
Seed 16 ==> test auc = nan
Seed 17 ==> test auc = nan
Seed 18 ==> test auc = nan
Seed 19 ==> test auc = nan
Overall test auc = nan +/- nan
